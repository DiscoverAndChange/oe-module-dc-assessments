{"version":3,"sources":["webpack:///src/app/admin/question-set-core-form/question-set-core-form.component.ts","webpack:///src/app/admin/question-set-core-form/question-set-core-form.component.html","webpack:///src/app/admin/services/message-template.service.ts","webpack:///src/app/admin/question-set-new/question-set-new.component.ts","webpack:///src/app/admin/question-set-new/question-set-new.component.html","webpack:///src/app/admin/admin-routing.module.ts","webpack:///src/app/admin/checkout-thankyou/checkout-thankyou.component.ts","webpack:///src/app/admin/checkout-thankyou/checkout-thankyou.component.html","webpack:///src/app/admin/subscription-dialog/subscription-dialog.component.ts","webpack:///src/app/admin/subscription-dialog/subscription-dialog.component.html","webpack:///src/app/admin/client-list/client-list.component.ts","webpack:///src/app/admin/client-list/client-list.component.html","webpack:///src/app/admin/view-order-page/view-order-page.component.ts","webpack:///src/app/admin/view-order-page/view-order-page.component.html","webpack:///src/app/admin/services/client-search.service.ts","webpack:///src/app/admin/checkout/checkout.component.ts","webpack:///src/app/admin/checkout/checkout.component.html","webpack:///src/app/admin/scale-range-new/scale-range-new.component.ts","webpack:///src/app/admin/scale-range-new/scale-range-new.component.html","webpack:///src/app/users/users-routing.module.ts","webpack:///src/app/companies-admin/company-new/company-new.component.ts","webpack:///src/app/companies-admin/company-new/company-new.component.html","webpack:///src/app/admin/question-set-list-view/question-set-list-view.component.ts","webpack:///src/app/admin/question-set-list-view/question-set-list-view.component.html","webpack:///src/app/admin/assessment-tokens-list/assessment-tokens-list.component.ts","webpack:///src/app/admin/assessment-tokens-list/assessment-tokens-list.component.html","webpack:///src/app/admin/client-edit/client-edit.component.ts","webpack:///src/app/admin/client-edit/client-edit.component.html","webpack:///src/app/admin/question-edit/question-edit.component.ts","webpack:///src/app/admin/question-edit/question-edit.component.html","webpack:///src/app/admin/question-new/question-new.component.ts","webpack:///src/app/admin/question-new/question-new.component.html","webpack:///src/app/admin/label-new/label-new.component.ts","webpack:///src/app/admin/label-new/label-new.component.html","webpack:///src/app/client-send-invitation/client-send-invitation.component.ts","webpack:///src/app/client-send-invitation/client-send-invitation.component.html","webpack:///src/app/admin/shop-items/shop-items.component.ts","webpack:///src/app/admin/shop-items/shop-items.component.html","webpack:///src/app/shared/models/SystemError.ts","webpack:///src/app/admin/scale-edit/scale-edit.component.ts","webpack:///src/app/admin/scale-edit/scale-edit.component.html","webpack:///src/app/admin/order-history/order-history.component.ts","webpack:///src/app/admin/order-history/order-history.component.html","webpack:///src/app/users/user-list/user-list.component.ts","webpack:///src/app/users/user-list/user-list.component.html","webpack:///src/app/admin/client-appointment-assignment-edit/client-appointment-assignment-edit.component.ts","webpack:///src/app/admin/client-appointment-assignment-edit/client-appointment-assignment-edit.component.html","webpack:///src/app/admin/services/assessment-assigner.service.ts","webpack:///src/app/admin/question-labels-edit/question-labels-edit.component.ts","webpack:///src/app/admin/question-labels-edit/question-labels-edit.component.html","webpack:///src/app/companies-admin/companies-list/companies-list.component.ts","webpack:///src/app/companies-admin/companies-list/companies-list.component.html","webpack:///src/app/admin/services/announcement.service.ts","webpack:///src/app/admin/assessment-new/assessment-new.component.ts","webpack:///src/app/admin/assessment-new/assessment-new.component.html","webpack:///src/app/admin/checkout-status-monitor/checkout-status-monitor.component.ts","webpack:///src/app/admin/checkout-status-monitor/checkout-status-monitor.component.html","webpack:///src/app/users/user-delete/user-delete.component.ts","webpack:///src/app/users/user-delete/user-delete.component.html","webpack:///src/app/admin/my-account/my-account.component.ts","webpack:///src/app/admin/my-account/my-account.component.html","webpack:///src/app/admin/scale-range-edit/scale-range-edit.component.ts","webpack:///src/app/admin/scale-range-edit/scale-range-edit.component.html","webpack:///src/app/admin/view-order/view-order.component.ts","webpack:///src/app/admin/view-order/view-order.component.html","webpack:///src/app/admin/label-edit/label-edit.component.ts","webpack:///src/app/admin/label-edit/label-edit.component.html","webpack:///src/app/admin/assessment-details-view/assessment-details-view.component.ts","webpack:///src/app/admin/assessment-details-view/assessment-details-view.component.html","webpack:///src/app/users/user-new/user-new.component.ts","webpack:///src/app/users/user-new/user-new.component.html","webpack:///src/app/admin/scales-list-view/scales-list-view.component.ts","webpack:///src/app/admin/scales-list-view/scales-list-view.component.html","webpack:///src/app/admin/client-new/client-new.component.ts","webpack:///src/app/admin/client-new/client-new.component.html","webpack:///src/app/admin/admin-shop/admin-shop.component.ts","webpack:///src/app/admin/admin-shop/admin-shop.component.html","webpack:///src/app/admin/admin/admin.component.ts","webpack:///src/app/admin/admin/admin.component.html","webpack:///src/app/admin/assessment-edit/assessment-edit.component.ts","webpack:///src/app/admin/assessment-edit/assessment-edit.component.html","webpack:///src/app/admin/assessment-view/assessment-view.component.ts","webpack:///src/app/admin/assessment-view/assessment-view.component.html","webpack:///src/app/admin/admin.module.ts","webpack:///src/app/companies-admin/companies-admin-routing.module.ts","webpack:///src/app/admin/services/subscription.service.ts","webpack:///src/app/companies-admin/company-edit/company-edit.component.ts","webpack:///src/app/companies-admin/company-edit/company-edit.component.html","webpack:///src/app/admin/announcement-bar/announcement-bar.component.ts","webpack:///src/app/admin/announcement-bar/announcement-bar.component.html","webpack:///src/app/admin/client-embedded-view/client-embedded-view.component.ts","webpack:///src/app/admin/client-embedded-view/client-embedded-view.component.html","webpack:///src/app/admin/question-set-edit/question-set-edit.component.ts","webpack:///src/app/admin/question-set-edit/question-set-edit.component.html","webpack:///src/app/users/user-edit/user-edit.component.ts","webpack:///src/app/users/user-edit/user-edit.component.html","webpack:///src/app/companies-admin/companies-admin.module.ts","webpack:///src/app/admin/billing-plans/billing-plans.component.ts","webpack:///src/app/admin/billing-plans/billing-plans.component.html","webpack:///src/app/shared/models/save-messages.ts","webpack:///src/app/admin/scale-new/scale-new.component.ts","webpack:///src/app/admin/scale-new/scale-new.component.html","webpack:///src/app/admin/assessment-admin/assessment-admin.component.ts","webpack:///src/app/admin/assessment-admin/assessment-admin.component.html","webpack:///src/app/admin/client-manage-assignments/client-manage-assignments.component.ts","webpack:///src/app/admin/client-manage-assignments/client-manage-assignments.component.html","webpack:///src/app/admin/user-upgrade-subscription-notice/user-upgrade-subscription-notice.component.ts","webpack:///src/app/admin/user-upgrade-subscription-notice/user-upgrade-subscription-notice.component.html","webpack:///src/app/admin/assessment-group-edit/assessment-group-edit.component.ts","webpack:///src/app/admin/assessment-group-edit/assessment-group-edit.component.html","webpack:///src/app/admin/assessment-list/assessment-list.component.ts","webpack:///src/app/admin/assessment-list/assessment-list.component.html","webpack:///src/app/admin/cart-widget/cart-widget.component.ts","webpack:///src/app/admin/cart-widget/cart-widget.component.html","webpack:///src/app/users/users.module.ts"],"names":["QuestionSetCoreFormComponent","questionSet","v","selector","templateUrl","styleUrls","MessageTemplateService","dac$http","client","get","clientId","id","then","template","QuestionSetNewComponent","_assessmentService","route","router","alertService","title","newId","params","subscribe","assessmentUid","setId","getAssessment","assessment","addQuestionSet","_questionSet","saveAssessment","success","setTimeout","navigate","relativeTo","replaceUrl","error","console","save","ReturnUsersModules","ReturnCompaniesAdminModules","adminRoutes","path","component","canActivate","children","m","UsersModule","loadChildren","CompaniesAdminModule","SystemOverviewModule","ManageReportsModule","redirectTo","pathMatch","AdminRoutingModule","forChild","imports","exports","CheckoutThankyouComponent","orderService","shoppingService","_hasLoadedOrder","_hasFinishedSingleOrderSetup","isSingleCheckoutOrder","endSingleItemCheckout","getLastOrder","order","_order","assignmentCompleteAlerts","setInterval","getAlertCount","clearInterval","returnUrl","getSingleItemCheckoutReturnUrl","navigateByUrl","SubscriptionDialogComponent","subscriptionService","dialogRef","log","closeDialog","pageRoute","getSubscriptionPageRoute","close","goToSubscriptionSignup","ClientListComponent","changeRef","authService","dacConfig","clientSearchService","_clients","tokensEnabled","isSearching","_userSubscription","getLoginState","loginState","_currentUser","user","isFeatureEnabled","hasCapability","CAN_BUY_TOKENS","_userHasActiveServiceSubscription","hasActiveSubscription","role","Admin","ShowAllUsers","unsubscribe","getDefaultClientList","hasMoreResults","canAddClient","notifySubscriptionRequired","resetSearch","ExactMatch","searchByNameInvalid","firstName","searchFirstName","lastName","searchLastName","clientID","searchClientID","email","searchEmail","runSearch","getUserForQuery","search","trim","encodeURIComponent","exactMatch","results","handleSearchError","loadMore","getClientList","detectChanges","SearchValue","doSearch","toggleExactMatch","ViewOrderPageComponent","orderId","getOrder","ClientSearchService","_clientService","_paginationFactory","_showAllUsers","_clientSubscription","getClientObservable","c","hasClientInResults","updateClient","handleNewClient","state","isLoggedIn","clearSearch","restoreSearchSettings","localStorage","clientSearchData","getItem","data","JSON","parse","hasOwnProperty","_exactMatch","setItem","stringify","_resultsLoader","_searchUser","_searchValue","find","index","findIndex","assignedUserId","splice","unshift","queryFunction","searchClientList","bind","getResultsLoader","getResults","clients","Promise","resolve","saveSearchSettings","CheckoutComponent","shopping","billingService","_inCheckoutProcess","useSavedCard","_loadingPaymentInformation","_isAdmin","getBillingDetails","details","_billingDetails","hasCards","_billingCard","cards","setCheckoutSavedCard","item","removeItemFromCart","message","name","cartTotal","canUpdateBillingProfile","checkout","hasItems","cartItems","_useExistingCard","ScaleRangeNewComponent","assessmentService","SAVE_TIME","ERROR_MESSAGE_TIME","range","getNewObject","scaleId","scale","scales","s","obj","addRange","isSaving","saveRange","question","_range","saveAndCreateNew","userRoutes","UsersRoutingModule","CompanyNewComponent","companyService","Company","Owner","errors","push","length","passwordChange","confirmPassword","validateForm","join","password","createCompany","company","msg","status","json","body","_code","QuestionSetListViewComponent","populateQuestionSetFromAssessment","display_type","QUESTION_LIST","listQuestion","CustomLabels","labels","type","Textbox","isSelected","selected","classes","question_sets","AssessmentTokensListComponent","tokenService","assessmentGroupService","buy","_loaded","canShop","CAN_SHOP","all","loadAssessmentTokens","getAssessmentGroups","getAssessmentList","groups","assessments","groupTokenItems","map","g","Name","quantity","getGroupRemainingTokens","tokenItems","a","getRemainingTokens","emit","ClientEditComponent","location","reportService","assessmentAssignerService","assignmentService","_reportsByAssignment","_client","_clientToSave","loadedClient","clientShareLink","window","href","getClient","Object","assign","assignments","getReportsForAssignment","reports","Id","r","IsComplete","hasMetRequirements","hasNoAssignments","staticTabs","toggleActive","tabs","back","assignment","hasReportsForAssignment","_newAssignedUser","isValid","isSavingClient","saveClient","result","QuestionEditComponent","questionFactory","_question","createDefaultEmptyQuestion","_flagDirectionList","questionId","questions","q","setScaleIfSingle","hasFlagCondition","flagValue","flaggedCondition","flagValues","MultipleChoice","flagDirection","f","Checklist","SingleChoice","assessment_scale","b","condition","fv","hasFlagValue","filter","prompt","addFlagValue","foreach","i","updateFlagValues","validateQuestion","saveQuestion","toggleFlagQuestion","QuestionNewComponent","_currentType","getNewQuestion","event","select","target","value","newQuestion","is_reversed","createQuestionForType","addQuestion","types","forEach","t","updateType","LabelNewComponent","label","addLabel","saveLabel","_label","ClientSendInvitationComponent","clientService","messageTemplateService","emailSubject","emailMessage","confirmEmail","failMessageTemplateLoad","Error","toEmailAddress","getMessageForClient","msgTemplate","subject","replyTo","replyToEmailAddress","testEmail","testEmailAddress","to","from","fromEmailAddress","sendEmailToServer","isTest","sendClientEmail","copyTextarea","document","getElementById","successful","execCommand","err","supportEmail","username","companyName","take_test_url","ShopItemsComponent","_hasLoadedShop","getAvailableItems","items","_groupItems","subItems","_items","totalitems","getItemsForCheckout","totalQuantity","reduce","pv","cv","addItems","addItemToCart","groupItems","gi","totalItems","concat","SystemError","code","subErrors","_subErrors","ScaleAvailableDisplay","ScaleEditComponent","_scale","_hasLoaded","_assessment","hasSubScale","removeSubScale","addSubScale","subScale","gradingData","requiredQuestion","requiredScoreThreshold","_messages","saveSuccess","confirm","removeRange","subScaleDisplayList","availableScales","getAvailableSubScales","available","subScaleDisplay","OrderHistoryComponent","_orders","_isLoaded","getOrderHistory","orders","UserListComponent","userService","_users","showArchivedUsers","getUsers","users","adminUserId","u","singleAdmin","restoreUser","archiveUser","SuperUser","enabled","toggleArchivedUsers","ClientAppointmentAssignmentEdit","fhirClient","snapshot","clientPromise","fhirClientPromise","getFhirClient","appt","getFhirContextFromClient","reference","indexOf","parts","split","appointment","AppointmentId","AssessmentAssignerService","assessmentTokenService","group","assignmentId","isTokensEnabled","createClientGroupAssignment","consumeTokens","syncLocalClient","appointmentId","hasTokens","Type","DateAssigned","Date","assignmentItem","Uid","uid","Items","alertId","info","saveClientAssignment","clearAlert","method","consumeToken","applyAssignmentMethod","freeToken","getAssessmentItems","timeout","QuestionLabelsEditComponent","uuid","createNewLabel","updateLabels","changes","newLabel","generate","shiftUpLabel","shiftDownLabel","removeLabel","CompaniesListComponent","getCompanies","companies","Companies","AnnouncementService","announcement","post","read","AssessmentNewComponent","description","validateAssessment","createAssessment","CheckoutStatusMonitorComponent","getCheckoutStatus","orderStatus","UserDeleteComponent","_userToDelete","_userFilterFunction","filterUserToDelete","userId","getUser","_reassignClientsUser","setUserToAssign","MyAccountComponent","tab","routeUrl","ScaleRangeEditComponent","rangeId","ranges","ViewOrderComponent","LabelEditComponent","labelId","l","AssessmentDetailsViewComponent","UserNewComponent","_user","passwordPolicyMsg","match","createUser","savedUser","setUserRole","ScalesListViewComponent","selectedScale","populateScaleFromAssessment","ClientNewComponent","getCurrentUser","generateClientId","_generatingClientId","showPasswordFields","Client","validate","customField1","createClient","handleClientCreateSuccess","AdminShopComponent","AdminComponent","navService","modalService","toggleSidebar","_subscriptionServiceSubscription","subscriptionRequiredEvent","openSubscriptionDialog","openDialog","preventDefault","stopPropagation","AssessmentEditComponent","assessmentCompressor","hydrator","hasLoadedAssessment","version","queryParams","assessmentPromise","getAssessmentVersion","compress","reportContents","nativeElement","jsonData","assessmentJSON","hydrate","shiftScaleUp","shiftScaleDown","shiftQuestionSetUp","shiftQuestionSetDown","removeQuestionSet","isDeleted","removeScale","addScale","updateAssessmentContents","AssessmentViewComponent","AdminModule","declarations","entryComponents","providers","companyRoutes","CompaniesAdminRoutingModule","SubscriptionService","httpService","subHydrator","_subscriptionRequiredSubject","subscription","billingDetails","reason","subIndex","subscriptions","sub","subscriptionToSave","CANCEL_PROCESSING","cancelReason","companyID","updatedSubscription","fromJSONObject","updateUserWithSubscription","errorResponse","_message","SYSTEM_ERROR","ACTIVE","reject","count","interval","updatedSub","isActiveSubscription","next","plan","unitType","providedIn","CompanyEditComponent","getCompany","getUserStatistics","userStats","getOrderStatistics","orderStats","_orderStatistics","_company","AnnouncementBarComponent","announcementService","getAnnouncements","announcements","_announcements","alertClass","markAnnouncementRead","ClientEmbeddedViewComponent","QuestionSetEditComponent","display_conditions","hasConditions","shiftLabelDown","shiftLabelUp","shiftQuestionUp","shiftQuestionDown","removeQuestion","saveDeleteItem","toggleCondition","UserEditComponent","canArchive","editUser","currentUser","saveUser","response","BillingPlansComponent","subService","metrics","METRICS_CATEGORY","cancellationReasons","loading","trackEvent","subscriptionAlertMessage","upgrading","updateDefaultBillingCard","updatedBillingDetails","upgradeSubscription","updatePastDueSubscription","isUnpaidSubscription","cancelConfirm","canceling","cancelOtherReason","chosenReason","cr","cancelSubscription","getPlanDetailsForSubscription","stripe_charge_name","SaveMessages","reset","saveFailed","_deleteSuccess","_deleteFailed","_saveSuccess","_saveFailed","ScaleNewComponent","AssessmentAdminComponent","ClientManageAssignmentsComponent","updateClientAssignments","clientAssignments","getDisplayString","addAssessmentsFromBattery","questionaire","QuestionnaireId","addAssessment","removeClientAssignment","removeAssignment","asset","AssetId","checkoutSubscription","addTokensForGroup","assignerService","addTokens","handleBatteryCheckout","handleAssessmentCheckout","addQuestionnaire","addAssetAssignment","UserUpgradeSubscriptionNoticeComponent","subscriptionSignupRoute","getCurrentUserSubscription","terminationDate","endedAt","trialPeriodEnded","TRIAL_PERIOD_ENDED","AssessmentGroupDisplay","ShowAdd","Show","AssessmentGroupEditComponent","showAdd","showGroups","loadGroups","hasLoaded","showAllGroups","displayGroup","stopImmediatePropagation","updateAssessmentsForGroup","updatedGroup","dup","Assessments","alert","addAssessmentToGroup","charCode","addGroup","createNewGroup","NewGroupName","display","AssessmentListComponent","_assessments","hasLoadedAssessments","_userRole","UnAuthenticated","isPublic","assessmentList","CartWidgetComponent"],"mappings":"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","file":"admin-admin-module-es5.js","sourcesContent":["/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, Input } from '@angular/core';\n\nimport { QuestionSet } from '../../shared/models/question-set';\n\n\n@Component({\n  selector: 'app-question-set-core-form',\n  templateUrl: './question-set-core-form.component.html',\n  styleUrls: ['./question-set-core-form.component.css']\n})\nexport class QuestionSetCoreFormComponent implements OnInit {\n\n  @Input() private questionSet:QuestionSet;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  public get QuestionSet() {\n    return this.questionSet;\n  }\n\n  public set QuestionSet(v:QuestionSet) {\n    this.questionSet = v;\n  }\n}\n","<form>\n  <div class=\"form-group\">\n    <label for=\"title\">Title:</label>\n    <input class=\"form-control\" type=\"text\" id=\"title\" name=\"title\" [(ngModel)]=\"QuestionSet.title\" />\n  </div>\n  <div class=\"form-group\">\n      <label for=\"instructions\">Instructions:</label>\n      <textarea class=\"form-control h-100\" id=\"instructions\" name=\"instructions\" [(ngModel)]=\"QuestionSet.instructions\"></textarea>\n  </div>\n  <div class=\"form-group\">\n      <label for=\"answerStartValue\">Answer Start Value:</label>\n      <input class=\"form-control\" type=\"number\" id=\"answerStartValue\" name=\"answerStartValue\" [(ngModel)]=\"QuestionSet.answer_start_value\" />\n  </div>\n  <!--<div class=\"form-group\">\n      <label for=\"displayOrder\">Display Order:</label>\n      <input class=\"form-control\" type=\"number\" id=\"displayOrder\" name=\"displayOrder\" [(ngModel)]=\"questionSet.display_order\" />\n  </div>-->\n  <div class=\"form-group\">\n      <label for=\"display_type\">Display Type:</label>\n      <select class=\"form-control browser-default\" id=\"display_type\" name=\"display_type\" name=\"display_type\" [(ngModel)]=\"QuestionSet.display_type\">\n        <option value=\"MultipleChoiceGrid\">Multiple Choice Grid</option>\n        <option value=\"SingleSelectDropdown\">Single Choice Dropdown</option>\n        <option value=\"QuestionList\">Question List</option>\n      </select>\n  </div>\n</form>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Injectable } from \"@angular/core\";\nimport { HTTPService } from \"app/shared/services/http.service\";\nimport { ManagedClient } from \"app/shared/models/managed-client\";\n\n@Injectable()\nexport class MessageTemplateService {\n\n    constructor(private dac$http:HTTPService) {\n    }\n\n    /**\n     * Return the message for a given client.\n     * @param client\n     */\n    public getMessageForClient(client:ManagedClient) {\n\n        return this.dac$http.get<{subject:string,message:string,replyTo:string,testEmail:string,to:string,from:string}>(\"message-templates\", {clientId: client.id}).then(template => {\n            return template;\n        });\n    }\n\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport { AssessmentService } from \"../../shared/services/assessment.service\";\nimport { QuestionSet } from \"../../shared/models/question-set\";\nimport { Assessment } from \"../../shared/models/assessment\";\n\n@Component({\n  selector: 'app-question-set-new',\n  templateUrl: './question-set-new.component.html',\n  styleUrls: ['./question-set-new.component.css']\n})\nexport class QuestionSetNewComponent implements OnInit {\n\n  private _questionSet:QuestionSet;\n\tprivate assessment:Assessment;\n\n  constructor(\n     private _assessmentService:AssessmentService\n    ,private route:ActivatedRoute\n    ,private router:Router\n    ,private alertService:AlertService\n  ) {\n    this.questionSet = new QuestionSet();\n    this.questionSet.title = \"Untitled\";\n    this.questionSet.id = this._assessmentService.newId();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      this._assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n        });\n    });\n  }\n\n  get questionSet() : QuestionSet {\n    return this._questionSet;\n  }\n\n  set questionSet(v:QuestionSet) {\n    this._questionSet = v;\n  }\n\n  save() {\n    this.assessment.addQuestionSet(this._questionSet);\n\t\tthis._assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Question Set Saved!\")\n        setTimeout(() => {\n          this.router.navigate([\"../\", this._questionSet.id, \"edit\"], {relativeTo: this.route, replaceUrl: true});\n        },1500);\n    }).catch((error) => {\n      this.alertService.error(\"Error occurred in saving. Please try again\");\n      console.error(error);\n    });\n\t}\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h2 class=\"h2-responsive text-center\">New Question Set</h2>\n    </div>\n</div>\n    <div class=\"row\">\n    <div class=\"col\">\n        <div class=\"card card-cascade narrower\">\n            <div class=\"view gradient-card-header primary-gradient text-light\">\n                <h3 class='h3-responsive text-center'>{{questionSet.title}}</h3>\n            </div>\n            <div class=\"card-body\">\n                <app-question-set-core-form [questionSet]=\"questionSet\"></app-question-set-core-form>\n                <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n            </div>\n        </div>\n    </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routes,RouterModule } from '@angular/router';\n\nimport { AdminComponent } from \"./admin/admin.component\";\nimport { ClientListComponent } from './client-list/client-list.component';\nimport { ClientNewComponent } from './client-new/client-new.component';\nimport { ClientEditComponent } from './client-edit/client-edit.component';\n\nimport { AssessmentAdminComponent } from \"./assessment-admin/assessment-admin.component\";\nimport { AssessmentListComponent } from \"./assessment-list/assessment-list.component\";\nimport { AssessmentNewComponent } from \"./assessment-new/assessment-new.component\";\nimport { AssessmentEditComponent } from \"./assessment-edit/assessment-edit.component\";\nimport { AssessmentResultViewComponent } from \"app/reports/assessment-result-view/assessment-result-view.component\";\n\nimport { QuestionSetEditComponent } from \"./question-set-edit/question-set-edit.component\";\nimport { QuestionSetNewComponent } from \"./question-set-new/question-set-new.component\";\n\nimport { ScaleNewComponent } from \"./scale-new/scale-new.component\";\nimport { ScaleEditComponent } from \"./scale-edit/scale-edit.component\";\n\nimport { QuestionNewComponent } from './question-new/question-new.component';\nimport { QuestionEditComponent } from './question-edit/question-edit.component';\n\nimport { LabelNewComponent } from './label-new/label-new.component';\nimport { LabelEditComponent } from './label-edit/label-edit.component';\n\nimport { ScaleRangeNewComponent } from './scale-range-new/scale-range-new.component';\nimport { ScaleRangeEditComponent } from './scale-range-edit/scale-range-edit.component';\n\nimport {AdminGuard } from \"../login/services/admin-guard.service\"\n\nimport { AdminShopComponent } from './admin-shop/admin-shop.component';\nimport { ShopItemsComponent } from './shop-items/shop-items.component';\nimport { CheckoutComponent } from './checkout/checkout.component';\nimport { CheckoutThankyouComponent } from './checkout-thankyou/checkout-thankyou.component';\n\nimport { MyAccountComponent } from \"./my-account/my-account.component\";\nimport { ViewOrderPageComponent } from \"./view-order-page/view-order-page.component\";\n\nimport {ReportViewerComponent} from \"../reports/report-viewer/report-viewer.component\";\n\nimport {AssessmentGroupEditComponent} from \"./assessment-group-edit/assessment-group-edit.component\";\nimport { UsersModule} from \"../users/users.module\";\nimport { CompaniesAdminModule } from 'app/companies-admin/companies-admin.module';\nimport { AssessmentViewComponent } from 'app/admin/assessment-view/assessment-view.component';\nimport { ScalesListViewComponent } from \"./scales-list-view/scales-list-view.component\";\nimport { QuestionSetListViewComponent } from \"./question-set-list-view/question-set-list-view.component\";\nimport { AssessmentDetailsViewComponent } from 'app/admin/assessment-details-view/assessment-details-view.component';\nimport { OrderHistoryComponent } from './order-history/order-history.component';\nimport { AccountOwnerSettingsComponent } from 'app/account-owner-settings/account-owner-settings.component';\nimport { BillingDetailsComponent } from 'app/shared/billing-details/billing-details.component';\nimport { BillingPlansComponent } from './billing-plans/billing-plans.component';\nimport { AssetResultViewComponent } from 'app/reports/asset-result-view/asset-result-view.component';\nimport { ExerciseListComponent } from 'app/library-assets/exercise-list/exercise-list.component';\nimport { AdminViewAssetComponent } from 'app/library-assets/admin-view-asset/admin-view-asset.component';\nimport { AssetNewComponent } from 'app/library-assets/asset-new/asset-new.component';\nimport { ClientEmbeddedViewComponent } from './client-embedded-view/client-embedded-view.component';\nimport { QuestionnaireResultViewComponent } from 'app/reports/questionnaire-result-view/questionnaire-result-view.component';\nimport { AdminLoginComponent } from 'app/login/admin-login/admin-login.component';\nimport { AdminLoginFinalizeComponent } from 'app/login/admin-login-finalize/admin-login-finalize.component';\nimport { ClientAppointmentAssignmentEdit } from './client-appointment-assignment-edit/client-appointment-assignment-edit.component';\n\n// TODO: stephen not sure why I need this function instead of a lambda\nexport function ReturnUsersModules() {\n  return UsersModule;\n}\n\nexport function ReturnCompaniesAdminModules() {\n  return CompaniesAdminModule;\n}\n\nexport const adminRoutes: Routes = [{\n    path: '',\n    component: AdminComponent,\n    canActivate: [],\n    children: [\n      {\n        path: '',\n        children: [\n          { path: 'client', children: [\n            { path: 'new',  component: ClientNewComponent }\n            ,{ path: ':id',  children: [\n                {path: '', component: ClientEditComponent }\n                ,{path: 'result/:resultId', component: AssessmentResultViewComponent }\n                ,{path: 'asset-result/:resultId', component: AssetResultViewComponent }\n                ,{path: 'questionnaire-result/:resultId', component: QuestionnaireResultViewComponent }\n                ,{path: 'report/:reportId/:assignmentId', component: ReportViewerComponent }\n                ,{path: 'embed', component: ClientEmbeddedViewComponent, children: [\n                  {path: 'result/:resultId', component: AssessmentResultViewComponent }\n                  ,{path: 'asset-result/:resultId', component: AssetResultViewComponent }\n                  ,{path: 'report/:reportId/:assignmentId', component: ReportViewerComponent }\n                  ,{path: 'questionnaire-result/:resultId', component: QuestionnaireResultViewComponent }\n                ]}\n            ]}\n            ,{ path: '', component: ClientListComponent}\n          ]}\n          ,{path: 'client-appointment/:id', component:ClientAppointmentAssignmentEdit }\n          ,{path: 'users', 'loadChildren': () => import('../users/users.module').then(m => m.UsersModule)}\n          ,{path: 'companies', loadChildren: () => import('../companies-admin/companies-admin.module').then(m => m.CompaniesAdminModule) }\n          ,{path: 'system', loadChildren: () => import('./system-overview/system-overview.module').then(m => m.SystemOverviewModule)}\n\n          // TODO: stephen would this be better as a child component of client?\n\n          // ,{ path: 'shop', component: AdminShopComponent }\n          ,{ path: 'shop', children: [\n            { path: '', component: ShopItemsComponent }\n            ,{ path: 'checkout/thankyou', component: CheckoutThankyouComponent }\n            ,{ path: 'checkout', component: CheckoutComponent }\n          ]}\n\n\n          ,{ path: 'assessment', component: AssessmentAdminComponent,\n            children: [\n              {path: 'batteries', component: AssessmentGroupEditComponent}\n              ,{path: 'custom-reports', loadChildren: () => import('../manage-reports/manage-reports.module').then(m => m.ManageReportsModule) }\n              ,{path: 'manage', children: [\n                { path: '',component: AssessmentListComponent}\n                ,{ path: 'new', component: AssessmentNewComponent }\n                ,{ path: ':uid/view', component: AssessmentViewComponent, children: [\n                  { path: '', redirectTo: 'details', pathMatch: 'prefix' }\n                  ,{ path: 'details', component: AssessmentDetailsViewComponent }\n                  ,{ path: 'scales', component: ScalesListViewComponent }\n                  ,{ path: 'sets', component: QuestionSetListViewComponent }\n                ] }\n                ,{ path: ':uid/edit', component: AssessmentEditComponent, children: [] }\n                ,{ path: ':uid/edit/question-set', children: [\n                  { path: ':setId/edit', component: QuestionSetEditComponent }\n                  ,{ path: 'new', component: QuestionSetNewComponent }\n                ] }\n                // even though it seems question is a sub of question-set we have no router outlet\n                // for it... we want it to replace the entire screen... so... we do this.\n                ,{ path: ':uid/edit/question-set/:setId/edit/question', children: [\n                    {path: 'new', component: QuestionNewComponent}\n                    ,{path: ':questionId/edit', component: QuestionEditComponent}\n                  ] }\n                ,{ path: ':uid/edit/question-set/:setId/edit/label', children: [\n                    {path: 'new', component: LabelNewComponent}\n                    ,{path: ':labelId/edit', component: LabelEditComponent}\n                  ] }\n                ,{ path: ':uid/edit/scale', children: [\n                  { path: ':scaleId/edit', component: ScaleEditComponent }\n                  ,{ path: 'new', component: ScaleNewComponent }\n                ] }\n                ,{ path: ':uid/edit/scale/:scaleId/edit/scale-range', children: [\n                    {path: 'new', component: ScaleRangeNewComponent}\n                    ,{path: ':rangeId/edit', component: ScaleRangeEditComponent}\n                  ] }\n              ]}\n            ]\n          }\n\n          // library assets\n          , { path: 'library/:type', component: ExerciseListComponent, children: [] }\n          , { path: 'library/:type/new', component: AssetNewComponent, children: [] }\n          , { path: 'library/:type/:assetId', component: AdminViewAssetComponent, children: [] }\n\n          ,{ path: 'my-account', component: MyAccountComponent, children: [\n            { path: 'order', component: OrderHistoryComponent }\n            , { path: 'order/:id', component: ViewOrderPageComponent}\n            ,{ path: 'billing', component: BillingDetailsComponent }\n            ,{ path: 'plans', component: BillingPlansComponent }\n            ,{ path: 'company', component: AccountOwnerSettingsComponent }\n            , { path: '', pathMatch: 'full', redirectTo: '/admin/my-account/order' }\n          ]}\n          ,{ path: '**', redirectTo: '/std/admin/client', pathMatch: 'full'}\n\n //\n\n  // { path: 'assessments/:uid/edit/scale/new', component: AssessmentScaleNewComponent },\n  // { path: 'assessments/:uid/edit/scale/:scaleId/edit', component: AssessmentScaleEditComponent },\n\n  // { path: 'assessments/:uid/edit/scale/:scaleId/edit/scale-range/new', component: AssessmentScaleRangeNewComponent },\n  // { path: 'assessments/:uid/edit/scale/:scaleId/edit/scale-range/:rangeId/edit', component: AssessmentScaleRangeEditComponent },\n\n  // { path: 'assessments/:uid/edit/questionSet/new', component: QuestionSetNewComponent },\n  // { path: 'assessments/:uid/edit/questionSet/:setId/edit', component: QuestionSetEditComponent },\n\n  // { path: 'assessments/:uid/edit/questionSet/:setId/edit/question/new', QuestionNewComponent  },\n  // { path: 'assessments/:uid/edit/questionSet/:setId/edit/question/:questionId', QuestionEditComponent  },\n\n  // { path: 'assessments/:uid/edit/questionSet/:setId/edit/label/new', QuestionSetLabelNewComponent  },\n  // { path: 'assessments/:uid/edit/questionSet/:setId/edit/label/:labelId', QuestionSetLabelEditComponent  },\n\n        ]\n    }\n  ]\n}];\n@NgModule({\n  imports: [\n    RouterModule.forChild(adminRoutes)\n  ],\n  exports: [\n    RouterModule\n  ]\n})\nexport class AdminRoutingModule {}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport {OrderService} from \"../../shared/services/order.service\";\nimport {Order} from \"../../shared/models/order\"\nimport { ShoppingService } from 'app/shared/services/shopping.service';\nimport { Router } from '@angular/router';\nimport { AlertService } from 'app/shared/services/alert.service';\n\n@Component({\n  selector: 'app-checkout-thankyou',\n  templateUrl: './checkout-thankyou.component.html',\n  styleUrls: ['./checkout-thankyou.component.css']\n})\nexport class CheckoutThankyouComponent implements OnInit, OnDestroy {\n\n  private _order:Order;\n  private _hasLoadedOrder:boolean;\n  private _hasFinishedSingleOrderSetup:boolean;\n\n  constructor(\n    private orderService:OrderService\n    ,private shoppingService:ShoppingService\n    ,private router:Router\n    ,private alertService:AlertService\n  ) {\n    this._hasLoadedOrder = false;\n    this._hasFinishedSingleOrderSetup = false;\n  }\n\n  ngOnDestroy() {\n    if (this.isSingleCheckoutOrder) {\n      this.shoppingService.endSingleItemCheckout();\n    }\n  }\n\n  ngOnInit() {\n    this.orderService.getLastOrder().then((order:Order) => {\n      this._hasLoadedOrder = true;\n      this._order = order;\n    })\n    .catch((error) =>{\n      console.error(error);\n      this._hasLoadedOrder = true;\n    })\n\n      // TODO: stephen this is very hacky... but we will do it for now until we can re-arrange the assessment integration\n    if (this.isSingleCheckoutOrder) {\n      let assignmentCompleteAlerts = setInterval(() => {\n        if (this.alertService.getAlertCount() <= 0) {\n          clearInterval(assignmentCompleteAlerts);\n          this._hasFinishedSingleOrderSetup = true;\n        }\n      }, 250);\n    }\n  }\n\n  public get order() {\n    return this._order;\n  }\n\n  public get isSingleCheckoutOrder() {\n    return this.shoppingService.isSingleCheckoutOrder();\n  }\n\n  public get hasFinishedSingleOrderSetup() {\n    return this._hasFinishedSingleOrderSetup;\n  }\n\n  public returnFromOrder() {\n    let returnUrl = this.shoppingService.getSingleItemCheckoutReturnUrl();\n    this.router.navigateByUrl(returnUrl);\n  }\n\n  public get hasLoadedOrder() {\n    return this._hasLoadedOrder;\n  }\n}\n","<div class=\"row\" *ngIf=\"!hasLoadedOrder\">\n  <div class=\"col\">\n    <p class=\"alert alert-warning\">\n      <app-spin-icon></app-spin-icon>Loading order information...</p>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoadedOrder\">\n  <div class=\"col\">\n    <div class=\"row\">\n      <div class=\"col card card-cascade wider mb-3\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h1 class=\"h1-responsive\">Thank you!</h1>\n        </div>\n        <div class=\"card card-body\">\n          <div class=\"row\">\n            <div class=\"col\">\n              <p>Your purchase is complete. Your order receipt is listed below for your information</p>\n              <p *ngIf=\"isSingleCheckoutOrder && hasFinishedSingleOrderSetup\" class=\"h6\">\n                You can now go back to your client or client list by clicking the Continue button.\n                <input type='button' class=\"btn btn-primary\" value=\"Continue\" (click)=\"returnFromOrder()\" />\n              </p>\n              <p *ngIf=\"isSingleCheckoutOrder && !hasFinishedSingleOrderSetup\" class=\"h6\">\n                  Your assessments are now being setup for your client.  Please wait...\n                  <input type='button' class=\"btn btn-primary\" value=\"Continue\"  disabled=\"disabled\" />\n                </p>\n              <p *ngIf=\"!isSingleCheckoutOrder\">Ready to use your purchased tokens?\n                <input type='button' class=\"btn btn-primary\" value=\"Manage your Clients\" [routerLink]=\"['/admin', 'client']\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col card card-cascade wider\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h3 class=\"h3-responsive\">Payment Receipt</h3>\n        </div>\n        <div class=\"card-body\">\n          <div class=\"row\">\n            <div class=\"col\">\n              <p *ngIf=\"!order\" class=\"alert alert-danger\">We're sorry your last payment could not be retrieved. contact customer support for assistance</p>\n            </div>\n          </div>\n          <div class=\"row\">\n            <view-order class=\"col\" *ngIf=\"order\" [order]=\"order\"></view-order>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, ViewChild, OnDestroy } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { ActivatedRoute,Router } from '@angular/router';\nimport {Modal} from \"ngx-modal\";\nimport { SubscriptionLike as ISubscription } from 'rxjs';\nimport { SubscriptionService } from '../services/subscription.service';\n\n@Component({\n  selector: 'dac-subscription-dialog',\n  templateUrl: './subscription-dialog.component.html',\n  styleUrls: ['./subscription-dialog.component.scss']\n})\nexport class SubscriptionDialogComponent {\n\n  constructor(\n    private subscriptionService:SubscriptionService\n    ,private router:Router\n    ,private dialogRef:MatDialogRef<SubscriptionDialogComponent>\n  ) {\n    console.log(\"got here\");\n  }\n\n  public close() {\n    this.closeDialog();\n  }\n\n  public goToSubscriptionSignup() {\n    let pageRoute = this.subscriptionService.getSubscriptionPageRoute();\n    this.router.navigate(pageRoute).then(() => {\n      this.closeDialog();\n    });\n  }\n\n  private closeDialog() {\n    this.dialogRef.close();\n  }\n}\n","<div></div>\n<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col\">\n      <h4 class=\"h4-responsive modal-title text-center\">\n        Subscription Required\n        <i class=\"fa fa-times float-right\" (click)=\"close()\"></i>\n      </h4>\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col\">\n      <hr />\n    </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col text-center\">\n        <p>The action you have requested requires an active subscription.</p>\n    </div>\n  </div>\n  <div class=\"row\">\n      <div class=\"col text-center\">\n          <input type=\"button\" class=\"btn btn-primary\" value=\"Activate your Subscription Today!\" (click)=\"goToSubscriptionSignup()\" />\n      </div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col\">\n      <hr />\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, ChangeDetectorRef, OnDestroy, HostBinding } from '@angular/core';\nimport { ManagedClient } from \"../../shared/models/managed-client\";\nimport { DacConfig } from \"../../shared/services/dac-config.service\";\nimport { AuthService } from 'app/login/services/auth.service';\nimport { ClientSearchService } from '../services/client-search.service';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { User } from 'app/shared/models/user';\nimport { SubscriptionLike as ISubscription } from 'rxjs';\nimport { Capability } from 'app/shared/models/capability';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { SubscriptionService } from '../services/subscription.service';\nimport { Role } from 'app/shared/models/role';\n\n@Component({\n    selector: 'app-client-list',\n    templateUrl: './client-list.component.html',\n    styleUrls: ['./client-list.component.css']\n})\nexport class ClientListComponent implements OnInit,OnDestroy {\n\n    private _clients: ManagedClient[];\n    private _userSubscription:ISubscription;\n    private _userHasActiveServiceSubscription:boolean;\n    private _currentUser:User;\n    public showTokens: Boolean;\n    public searchFirstName: string;\n    public searchLastName: string;\n    public searchClientID: string;\n    public searchEmail: string;\n    public isSearching:boolean;\n    public tokensEnabled:boolean;\n\n    /**\n     * Used for tracking with the name search is valid or not.\n     */\n    public searchByNameInvalid: boolean;\n\n    constructor(\n        private changeRef: ChangeDetectorRef,\n        private authService: AuthService,\n        private dacConfig: DacConfig,\n        private clientSearchService: ClientSearchService,\n        private alertService:AlertService,\n        private router:Router,\n        private subscriptionService:SubscriptionService,\n        private route:ActivatedRoute\n    ) {\n        this._clients = [];\n        this.tokensEnabled = false;\n        this.isSearching = false;\n        this._userSubscription = this.authService.getLoginState().subscribe(loginState => {\n            this._currentUser = loginState.user;\n            if (this.dacConfig.isFeatureEnabled(\"assessments.tokens.enabled\")) {\n                if (loginState.user && loginState.user.hasCapability(Capability.CAN_BUY_TOKENS)) {\n                    this.tokensEnabled = true;\n                }\n            }\n            if (loginState.user) {\n                this._userHasActiveServiceSubscription = loginState.user.hasActiveSubscription();\n            }\n            // we don't allow show all users to work if they don't have permission to this.\n            if (this._currentUser.role > Role.Admin) {\n                this.clientSearchService.ShowAllUsers = false;\n            }\n        });\n    }\n\n    ngOnDestroy() {\n        this._userSubscription.unsubscribe();\n    }\n\n    ngOnInit() {\n        this.getDefaultClientList();\n    }\n\n    public get Clients(): ManagedClient[] {\n        return this._clients;\n    }\n\n    public hasMoreResults(): boolean {\n        return this.clientSearchService.hasMoreResults();\n    }\n\n    public get lastSearchValue() {\n        return this.clientSearchService.SearchValue;\n    }\n\n    public addClient() {\n        if (this.canAddClient) {\n            this.router.navigate(['new'], {relativeTo: this.route});\n        }\n        else {\n            this.subscriptionService.notifySubscriptionRequired();\n        }\n    }\n\n    public get canAddClient() {\n        return this.dacConfig.isFeatureEnabled(\"client.add\") && this._userHasActiveServiceSubscription;\n    }\n\n    public get showAllUsers() {\n        return this.clientSearchService.ShowAllUsers;\n    }\n\n    public get exactMatch() {\n        return this.clientSearchService.ExactMatch;\n    }\n\n    public toggleAllUsers() {\n        this.clientSearchService.ShowAllUsers = !this.clientSearchService.ShowAllUsers;\n        this.resetSearch(); // clear out the search since we changed the toggle here.\n    }\n\n    public toggleExactMatch() {\n        this.clientSearchService.ExactMatch = !this.clientSearchService.ExactMatch;\n    }\n\n    public doSearch() {\n        this.searchByNameInvalid = false;\n        let firstName = this.searchFirstName || \"\";\n        let lastName = this.searchLastName || \"\";\n        let clientID = this.searchClientID || \"\";\n        let email = this.searchEmail || \"\";\n        if (!(clientID || email)\n            && (firstName == \"\" || lastName == \"\")) {\n            this.searchByNameInvalid = true;\n            this.alertService.error(\"Missing client id, or first and last name to do search\");\n            return;\n        }\n        this.runSearch(firstName, lastName, clientID, email);\n    }\n\n    public resetSearch() {\n        this.searchByNameInvalid = false;\n        this.searchFirstName = \"\";\n        this.searchLastName = \"\";\n        this.searchClientID = \"\";\n        this.searchEmail = \"\";\n        this._clients = [];\n        this.runSearch(this.searchFirstName, this.searchLastName, this.searchClientID, this.searchEmail);\n    }\n\n    private runSearch(firstName, lastName, clientID, email) {\n        this.isSearching = true;\n        let user = this.getUserForQuery();\n        let search = {\n            firstName: firstName.trim()\n            ,lastName: lastName.trim()\n            ,id: clientID.trim()\n            ,email: encodeURIComponent(email.trim())\n            ,exactMatch: this.exactMatch === true\n        };\n        this._clients = []; // clear our client list as we are doing a search.\n        this.clientSearchService.search(search, user).then((results) => {\n            this._clients = results;\n            this.isSearching = false;\n        })\n        .catch((error) => this.handleSearchError(error));\n    }\n\n    public loadMore(): void {\n        this.isSearching = true;\n        this.clientSearchService.loadMore().then((results) => {\n            this.isSearching = false;\n            this._clients = results;\n        })\n        .catch(error => this.handleSearchError(error));\n    }\n\n    private getUserForQuery() {\n        if (this.clientSearchService.ShowAllUsers) {\n            return null;\n        }\n        return this._currentUser;\n    }\n\n    private getDefaultClientList() {\n        let user = this.getUserForQuery();\n        this.isSearching = true;\n\n        this.clientSearchService.getClientList(user).then((results: ManagedClient[]) => {\n            this.isSearching = false;\n            this._clients = results;\n            this.changeRef.detectChanges();\n        })\n        .catch(error => this.handleSearchError(error));\n    }\n\n    private handleSearchError(error) {\n        this.alertService.error(\"There was an error retrieving the results from the server.  Please check your network connection and try again or contact support\");\n        console.error(error);\n        this.isSearching = false;\n    }\n}\n","<div class=\"col-12\">\n    <h1>Patients List\n       <!-- <input (click)=\"addClient()\" type=\"button\" class=\"btn btn-add-client btn-primary\"\n            value=\"Add Client\" />\n            <input *ngIf=\"tokensEnabled && !showTokens\" type=\"button\" class=\"btn btn-secondary\"\n            (click)=\"showTokens = true\"\n            value=\"Show Tokens\" />\n            <input *ngIf=\"tokensEnabled && showTokens\" type=\"button\" class=\"btn btn-secondary\"\n            (click)=\"showTokens = false\"\n            value=\"Hide Tokens\" /> -->\n    </h1>\n    <dac-assessment-tokens-list *ngIf=\"showTokens\" class=\"mb-5\"></dac-assessment-tokens-list>\n    <!-- <search-input (search)=\"doSearch($event)\" (reset)=\"resetSearch()\" [initialSearch]=\"lastSearchValue\" class=\"mb-2\"></search-input> -->\n    <form #searchForm=\"ngForm\" class=\"form-horizontal\">\n        <div class=\"search row\">\n            <div class=\"col-6 col-sm-4 col-xl-5\">\n              <input type=\"text\" class=\"form-control\" [ngClass]=\"{'text-red':searchByNameInvalid}\"\n                  placeholder=\"First name...\" [(ngModel)]=\"searchFirstName\" #firstName name=\"firstName\" (keyup.enter)=\"doSearch()\">\n            </div>\n            <div class=\"col-6 col-sm-4 col-xl-5\">\n              <input type=\"text\" class=\"form-control\" [ngClass]=\"{'text-red':searchByNameInvalid}\"\n                  placeholder=\"Last name...\" (keyup.enter)=\"doSearch()\" [(ngModel)]=\"searchLastName\" #lastName name=\"lastName\">\n            </div>\n            <div class=\"col-6 col-sm-4 col-xl-2\">\n              <span class=\"input-group-btn\">\n                <button class=\"btn btn-primary\" type=\"button\" (click)=\"doSearch()\">Search</button>\n\n                <button type=\"button\" class=\"btn btn-secondary\" (click)=\"resetSearch()\">\n                    <i class=\"fa fa-refresh\" aria-hidden=\"true\" aria-label=\"Reset\" ></i></button>\n              </span>\n            </div>\n\n        </div>\n        <div class=\"row\">\n            <div class=\"col\">\n                    <small [ngClass]=\"{'alert alert-danger text-bold': searchByNameInvalid}\">The first four letters of the last name and the first letter of the first name is required to search.\n                        Last names less than four characters will only return exact matches for the last name.</small>\n            </div>\n        </div>\n        <div class=\"row mb-2 mt-2\">\n            <details class=\"col\">\n                <summary>Advanced Search Options<i class='fa fa-question-circle-o' mdbTooltip=\"Click here to show advanced search filters such as showing the clients for all of the users in your company\" placement=\"top\" mdbWavesEffect></i></summary>\n                <div class=\"row\" *hasPermission=\"'Admin'\">\n                    <div class=\"col\">\n                        <input id=\"showAllUsers\"type=\"checkbox\" (click)=\"toggleAllUsers()\" [checked]=\"showAllUsers\" name=\"showAllUsers\" />\n                        <label for=\"showAllUsers\">Show all clients for all users in your organization</label>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <input id=\"exactMatch\" type=\"checkbox\" (click)=\"toggleExactMatch()\" [checked]=\"exactMatch\" name=\"exactMatch\" />\n                        <label for=\"exactMatch\">Only show results that match fields exactly.</label>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <input type=\"text\" class=\"form-control\"\n                            placeholder=\"Search by Unique ID...\" [(ngModel)]=\"searchClientID\" #clientID=\"ngModel\" name=\"clientID\">\n                    </div>\n                    <div class=\"col\">\n                        <input type=\"text\" class=\"form-control\"\n                            placeholder=\"Search by Exact Email...\" [(ngModel)]=\"searchEmail\" (keyup.enter)=\"doSearch()\" #clientID=\"ngModel\" name=\"searchEmail\">\n                    </div>\n                </div>\n            </details>\n        </div>\n    </form>\n    <p class=\"alert alert-info\" *ngIf=\"!isSearching && Clients.length == 0\">No clients found.  Either adjust your search or add a new client!</p>\n    <div class=\"clientList\" *ngIf=\"Clients.length\">\n        <div class=\"row list-group-item primary-gradient p-3 text-light\">\n            <div class=\"col-12\">\n                <div class=\"row\">\n                    <div [ngClass]=\"{'col-6': !showAllUsers, 'col-4':showAllUsers}\">Client\n                            <i class='fa fa-question-circle-o' mdbTooltip=\"This is your client profile\" placement=\"right\" mdbWavesEffect></i>\n                    </div>\n                    <div *ngIf=\"showAllUsers\" class=\"col-2\">Assigned User</div>\n                    <div class=\"col-2\">Date Assigned <i class='fa fa-question-circle-o' mdbTooltip=\"The date a battery or single assessment was assigned.\" placement=\"right\" mdbWavesEffect></i></div>\n                    <div class=\"col-2\">Completed<i class='fa fa-question-circle-o' mdbTooltip=\"The number of individual assessments a client has completed out of the total number they have assigned\" placement=\"right\" mdbWavesEffect></i></div>\n                    <div class=\"col-2 text-center\">Action</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"row list-group-item\" *ngFor=\"let client of Clients\">\n            <div class=\"col-12\">\n                <div class=\"row\">\n                    <div [ngClass]=\"{'col-6': !showAllUsers, 'col-4':showAllUsers}\">\n                        <h4 class=\"d-inline\"><i class=\"fa fa-user pr-2\"></i></h4><a [routerLink]=\"['../',client.id]\">{{client.getDisplayString()}}</a>\n                        <h6><i class=\"fa fa-key pt-2 pr-2 h4-responsive\"></i>{{client.getDisplayId()}}</h6>\n                        <h6 *ngIf=\"client.email\"><i class=\"fa fa-envelope pr-2 h4-responsive\"></i>{{client.email}}</h6>\n                    </div>\n                    <div *ngIf=\"showAllUsers\" class=\"col-2\">{{client.user?.getDisplayName()}}</div>\n                    <div class=\"col-2\"></div>\n                    <div class=\"col-2\">\n                    </div>\n                    <div class=\"col-2 text-center\">\n                            <button type=\"button\" class=\"btn btn-primary p-2 p-md-3\" [routerLink]=\"['../',client.id]\">\n                                <i class=\"fa fa-eye d-block d-sm-none\"></i>\n                                <span class=\"d-none d-sm-block\">View</span>\n                            </button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-12\" *ngIf=\"client.assignments.length == 0\">\n                    <div class=\"row mb-2\">\n                            <div class=\"col-6 pl-4 pl-sm-5\" >\n                                No assessments assigned.\n                            </div>\n                        </div>\n            </div>\n            <div class=\"col-12\" *ngFor=\"let assignment of client.assignments\">\n                    <div class=\"row mb-2\">\n                        <div class=\"col-6 pl-4 pl-sm-5\" >\n                            <i class=\"fa fa-clipboard\" *ngIf=\"!assignment.isGroup && assignment.type!='LibraryAsset'\"></i>\n                            <i class=\"fa fa-file-text\" *ngIf=\"assignment.type=='LibraryAsset'\"></i>\n                            <i class=\"fa fa-folder\" *ngIf=\"assignment.isGroup\"></i>\n                            {{assignment.Name}}\n                        </div>\n                        <div class=\"col-2\">{{assignment.DateAssigned|date:'mediumDate'}}</div>\n                        <div class=\"col-2\">\n                            <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}} - {{assignment.getAssignmentsCompleted()}}/{{assignment.getTotalAssignments()}}</span>\n                            <span *ngIf=\"!assignment.IsComplete\">Incomplete - {{assignment.getAssignmentsCompleted()}}/{{assignment.getTotalAssignments()}}</span>\n                        </div>\n                        <div class=\"col-2\">\n                        </div>\n                    </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"row\" *ngIf=\"hasMoreResults() || isSearching\">\n        <div class=\"col\">\n            <button class=\"btn btn-primary\" (click)=\"loadMore()\" [disabled]=\"isSearching\">\n                <span *ngIf=\"!isSearching\">Load More</span>\n                <span *ngIf=\"isSearching\">Loading...</span>\n            </button>\n            <app-spin-icon *ngIf=\"isSearching\"></app-spin-icon>\n        </div>\n    </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from \"@angular/router\";\n\nimport { OrderService } from \"../../shared/services/order.service\";\nimport { Order } from \"../../shared/models/order\";\n\n@Component({\n  selector: 'app-view-order-page',\n  templateUrl: './view-order-page.component.html',\n  styleUrls: ['./view-order-page.component.css']\n})\nexport class ViewOrderPageComponent implements OnInit {\n  private _order:Order;\n\n  constructor(\n    private route:ActivatedRoute\n    ,private orderService:OrderService\n  ) {\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let orderId = +params['id'];\n      // TODO: stephen check for Nan\n      this.orderService.getOrder(orderId)\n        .then((order:Order) => {\n          if (order == null) {\n            // TODO: stephen handle not found order.\n            console.error(\"Order not found\");\n          }\n          this._order = order;\n          console.log(\"order found: \", this._order);\n        })\n        .catch((error) => {\n          console.error(error);\n        })\n    });\n  }\n\n  get order() {\n    return this._order;\n  }\n\n}\n","<h3 class=\"h3-responsive\">Payment: {{order?.id}} <a class=\"btn btn-primary\" [routerLink]=\"['/admin', 'my-account']\">Back to Payment History</a></h3>\n<view-order [order]=\"order\"></view-order>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { ClientService } from \"../../shared/services/client.service\";\nimport { ManagedClient } from \"../../shared/models/managed-client\";\nimport { PaginatedResultsLoader } from \"../../shared/models/paginated-results-loader\";\nimport { PaginatedResultsLoaderFactory } from \"../../shared/services/pagination-results-loader-factory.service\";\nimport { User } from \"../../shared/models/user\";\nimport { Injectable } from \"@angular/core\";\nimport { AuthService } from \"../../login/services/auth.service\";\nimport { SubscriptionLike as ISubscription } from \"rxjs\";\n\n@Injectable()\nexport class ClientSearchService {\n\n    private _searchValue:{firstName?:string, lastName?:string, id?:string};\n    private _resultsLoader:PaginatedResultsLoader<ManagedClient>;\n    private _clients:ManagedClient[];\n    private _searchUser:User;\n    private _showAllUsers:boolean;\n    private _exactMatch:boolean;\n    private _userSubscription:ISubscription;\n    private _clientSubscription:ISubscription;\n\n    constructor(private _clientService:ClientService, private _paginationFactory:PaginatedResultsLoaderFactory\n        , private authService:AuthService) {\n        this._showAllUsers = false;\n        this._clients = [];\n        // when we get a new client let's make sure the client always displays when a user is added.\n        this._clientSubscription = this._clientService.getClientObservable().subscribe(c => {\n            if (!c) { // TODO: stephen we are using behaviorsubject which returns the first value on init... not sure I like this and we should\n                // try doing this differently.\n                return; // skip any invalid input\n            }\n\n            if (this.hasClientInResults(c)) {\n                this.updateClient(c);\n            }\n            else {\n                this.handleNewClient(c);\n            }\n        });\n\n        this._userSubscription = this.authService.getLoginState().subscribe(state => {\n            if (!state.isLoggedIn) {\n                this.clearSearch();\n            }\n        });\n\n        this.restoreSearchSettings();\n\n    }\n\n    private restoreSearchSettings() {\n        if (localStorage) {\n            let clientSearchData = localStorage.getItem('ClientSearchService');\n            if (clientSearchData !== null) {\n                try {\n                    let data = JSON.parse(clientSearchData);\n                    if (data.hasOwnProperty('_showAllUsers')) {\n                        this._showAllUsers = data._showAllUsers === true;\n                    }\n\n                    if (data.hasOwnProperty('_exactMatch')) {\n                        this._exactMatch = data._exactMatch === true;\n                    }\n                }\n                catch (error) {\n                    console.error(\"Failed to extract ClientSearchService data\", error);\n                }\n            }\n        }\n    }\n\n    private saveSearchSettings() {\n        if (localStorage) {\n            let clientSearchData = {\n                _showAllUsers: this._showAllUsers\n                ,_exactMatch: this._exactMatch\n            };\n            try {\n                localStorage.setItem(\"ClientSearchService\", JSON.stringify(clientSearchData));\n            } catch (error) {\n                console.error(\"Failed to save ClientSearchService data\", error);\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this._userSubscription.unsubscribe();\n        this._clientSubscription.unsubscribe();\n    }\n\n    get SearchValue() {\n        return this._searchValue;\n    }\n\n    set SearchValue(v:{firstName?:string, lastName?:string, clientID?:string}) {\n        this._searchValue = v;\n    }\n\n    get ShowAllUsers() : boolean {\n        return this._showAllUsers;\n    }\n\n    set ShowAllUsers(v:boolean) {\n        this._showAllUsers = v;\n        this.saveSearchSettings();\n    }\n\n    get ExactMatch() : boolean {\n        return this._exactMatch;\n    }\n\n    set ExactMatch(v:boolean) {\n        this._exactMatch = v;\n        this.saveSearchSettings();\n    }\n\n    public clearSearch() {\n        this._resultsLoader = null;\n        this._searchUser = null;\n        this._searchValue = {};\n        this._clients = [];\n    }\n\n    private hasClientInResults(c:ManagedClient) {\n        let id = c.id || null;\n        return this._clients.find(c => c.id == id) != null;\n    }\n    private updateClient(c:ManagedClient) {\n        let id = c.id || null;\n        let index = this._clients.findIndex(c => c.id == id);\n        let assignedUserId = c.user ? c.user.id : null;\n        // if we updated who the client is assigned to... we need to remove them from the search results\n        if (this._searchUser && assignedUserId != this._searchUser.id) {\n            this._clients.splice(index, 1);\n        }\n        else {\n            this._clients[index] = c;\n        }\n    }\n\n    private handleNewClient(c:ManagedClient) {\n        if (this._searchValue != null) {\n            this.search(this._searchValue, this._searchUser);\n        }\n        else {\n            this._clients.unshift(c);\n        }\n    }\n\n    public search(search:{firstName?:string, lastName?:string, id?:string}, user:User) : Promise<ManagedClient[]> {\n        this.clearSearch();\n\n        this._searchUser = user;\n        this._searchValue = search;\n        let queryFunction = this._clientService.searchClientList.bind(this._clientService, search, user);\n        this._resultsLoader = this._paginationFactory.getResultsLoader<ManagedClient>(queryFunction);\n        return this._resultsLoader.getResults()\n            .then((results:ManagedClient[]) => {\n                this._clients = results;\n                return results;\n        });\n    }\n\n    public hasMoreResults() : boolean {\n        return this._resultsLoader.hasMoreResults();\n    }\n\n    public loadMore() : Promise<ManagedClient[]> {\n        // load more results\n        return this._resultsLoader.loadMore()\n        .then((results:ManagedClient[]) => {\n            console.log(results);\n            this._clients = results;\n            return results;\n        });\n    }\n    public getClientList(user:User) : Promise<ManagedClient[]> {\n        this._searchUser = user;\n        if (!this._resultsLoader) {\n            let queryFunction = this._clientService.getClientList.bind(this._clientService, user);\n            this._resultsLoader = this._paginationFactory.getResultsLoader<ManagedClient>(queryFunction);\n            return this._resultsLoader.getResults().then((clients) => {\n                this._clients = clients;\n                return clients;\n            });\n        }\n        else {\n            return Promise.resolve(this._clients);\n        }\n    }\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport {AssessmentGroup } from '../../shared/models/assessment-group';\nimport {Assessment } from '../../shared/models/assessment';\nimport {ShoppingService} from \"../../shared/services/shopping.service\";\nimport {Item} from '../models/item';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { AuthService } from '../../login/services/auth.service';\nimport { Role } from '../../shared/models/role';\nimport { SubscriptionLike as ISubscription } from 'rxjs';\nimport { BillingService } from 'app/shared/services/billing.service';\nimport { BillingCard } from 'app/shared/models/billing-card';\nimport { BillingDetails } from 'app/shared/models/billing-details';\n\n@Component({\n  selector: 'checkout',\n  templateUrl: './checkout.component.html',\n  styleUrls: ['./checkout.component.css']\n})\nexport class CheckoutComponent implements OnInit, OnDestroy {\n\n  private _inCheckoutProcess:boolean;\n  private _billingCard:BillingCard;\n  private _useExistingCard:boolean;\n  private _billingDetails:BillingDetails;\n  private _loadingPaymentInformation:boolean;\n  private _isAdmin:boolean;\n  private _userSubscription:ISubscription;\n\n  constructor(\n    private shopping:ShoppingService\n    ,private router:Router\n    ,private alertService: AlertService\n    ,private route:ActivatedRoute\n    ,private billingService:BillingService\n    ,private authService:AuthService\n  ) {\n    this._inCheckoutProcess = false;\n    this.useSavedCard = false;\n    this._loadingPaymentInformation = false;\n    this._isAdmin = false;\n    this._userSubscription = this.authService.getLoginState().subscribe(loginState => {\n      if (loginState.user) {\n        this._isAdmin = loginState.user.role <= Role.Admin;\n      }\n      else {\n        this._isAdmin = false;\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this._userSubscription.unsubscribe();\n  }\n  ngOnInit() {\n    this._loadingPaymentInformation = true;\n    this.billingService.getBillingDetails().then((details) => {\n      this._loadingPaymentInformation = false;\n      this._billingDetails = details; // use the first one.\n      if (this._billingDetails.hasCards()) {\n        this._billingCard = this._billingDetails.cards[0];\n        this.setCheckoutSavedCard();\n      }\n    })\n    .catch((error) => {\n      console.error(error);\n      this._loadingPaymentInformation = false;\n      this.alertService.error(\"There was an error loading your payment information from the server.  Use a new card or contact support\");\n    });\n  }\n\n  get isSingleOrder() {\n    return this.shopping.isSingleCheckoutOrder();\n  }\n\n  get loadingPaymentInformation() {\n    return this._loadingPaymentInformation;\n  }\n\n  get inCheckoutProcess() {\n    return this._inCheckoutProcess;\n  }\n\n\n  get hasItems() {\n    return this.shopping.hasItems;\n  }\n\n  get orderTotal() {\n    return this.shopping.cartTotal;\n  }\n\n  get items() {\n    return this.shopping.cartItems;\n  }\n\n  removeItem(item:Item) {\n    this.shopping.removeItemFromCart(item).then(() => {\n      let message = item.name + \" removed from your cart.\";\n      this.alertService.success(message);\n    });\n  }\n\n  shouldShowPaymentInformation() {\n    // we only show if this is a paid item, and if we have a saved billing card.\n    if (this.shopping.cartTotal > 0) {\n      // if we are an admin and haven't setup a billing profile we want to show the payment details.\n      if (this.canUpdateBillingProfile()) {\n        return true;\n      }\n      if (this._billingDetails.hasCards() != null) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  setCheckoutSavedCard() {\n    this.useSavedCard = true;\n  }\n\n  setCheckoutNewCard() {\n    this.useSavedCard = false;\n  }\n\n  get BillingCard() {\n    return this._billingCard;\n  }\n\n  get useSavedCard() {\n    return this._useExistingCard;\n  }\n  set useSavedCard(v:boolean) {\n    this._useExistingCard = v;\n  }\n\n  canUpdateBillingProfile() {\n    return this._isAdmin;\n  }\n\n  openCheckout() {\n    this._inCheckoutProcess = true;\n    this.shopping.checkout(this.useSavedCard).then(() => {\n      this.router.navigate([\"/admin\", \"shop\", \"checkout\", \"thankyou\"]);\n    })\n    .catch((error) => {\n      console.error(error);\n      this.alertService.error(\"An error occurred in processing your checkout.  Check your card information and try again or contact customer support.\");\n      this._inCheckoutProcess = false;\n    });\n  }\n\n  cancelSingleCheckoutOrder() {\n    let returnUrl = this.shopping.getSingleItemCheckoutReturnUrl();\n    this.shopping.endSingleItemCheckout();\n\n    if (!returnUrl) {\n      console.error(\"No return url found to return to for single item checkout\");\n      returnUrl = \"/admin/clients/\"\n    }\n    this.router.navigateByUrl(returnUrl);\n  }\n}\n","<div class=\"row\">\n  <h1 class=\"col h1-responsive\">Checkout Cart\n    <input *ngIf=\"!isSingleOrder\" type=\"button\" class=\"btn btn-secondary\" value=\"Return to Shop\"\n    [disabled]=\"inCheckoutProcess\"  [routerLink]=\"['../']\" />\n    <input *ngIf=\"isSingleOrder\" type=\"button\" class=\"btn btn-secondary\"\n    [disabled]=\"inCheckoutProcess\" value=\"Cancel Order\" (click)=\"cancelSingleCheckoutOrder()\" />\n  </h1>\n</div>\n<div class=\"row\" *ngIf=\"items.length === 0\">\n  <p class=\"col alert alert-info\">Your checkout cart is currently empty</p>\n</div>\n<table class=\"table table-striped\" *ngIf=\"items.length\">\n  <thead class=\"primary-color text-light\">\n    <th class=\"w-50\">Items</th>\n    <th>Price</th>\n    <th>Quantity</th>\n    <th>Total</th>\n  </thead>\n  <tbody>\n    <tr *ngFor=\"let item of items\">\n      <td> {{item.name}}\n        <ul *ngIf=\"item.subItems?.length\">\n          <li *ngFor=\"let subItem of item.subItems\">{{subItem.name}}</li>\n        </ul>\n      </td>\n      <td>${{item.price | number:'1.2-2' }}</td>\n      <td>\n        <input class=\"form-control\" type=\"number\" [(ngModel)]=\"item.quantity\" min=\"1\" />\n      </td>\n      <td> ${{item.totalPrice | number:'1.2-2'}}\n        <button type=\"button\" class=\"btn btn-secondary btn-sm\" aria-label=\"Delete\" (click)=\"removeItem(item)\">\n          <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n        </button>\n      </td>\n    </tr>\n    <tr class=\"secondary-color text-light\">\n      <td colspan=\"3\">\n        <h4 class=\"h4-responsive\">Order Total</h4>\n      </td>\n      <td>\n        <h4 class=\"h4-responsive\">${{orderTotal | number:'1.2-2'}}</h4>\n      </td>\n    </tr>\n    <tr *ngIf=\"inCheckoutProcess\">\n      <td colspan=\"4\">\n        <app-checkout-status-monitor></app-checkout-status-monitor>\n      </td>\n    </tr>\n    <tr *ngIf=\"!inCheckoutProcess\">\n        <td colspan=\"4\" *ngIf=\"loadingPaymentInformation\">\n            <div class=\"alert alert-info\">Loading payment methods</div>\n        </td>\n    </tr>\n    <tr *ngIf=\"!inCheckoutProcess && !loadingPaymentInformation\">\n      <td colspan=\"4\" *ngIf=\"shouldShowPaymentInformation()\">\n        <div *ngIf=\"BillingCard\">\n          <input id=\"savedCard\" type=\"radio\" (click)=\"setCheckoutSavedCard()\" [checked]=\"useSavedCard\" />\n          <label for=\"savedCard\">Use <dac-billing-card [card]=\"BillingCard\"></dac-billing-card></label>\n        </div>\n        <div *ngIf=\"canUpdateBillingProfile()\">\n          <input id=\"newCardAdmin\" type=\"radio\" (click)=\"setCheckoutNewCard()\" [checked]=\"!useSavedCard\" />\n          <label for=\"newCardAdmin\">Use a new card or <a class=\"btn btn-secondary btn-sm\" [routerLink]=\"['/admin/my-account/billing']\">Update your Billing Profile</a></label>\n          <p><small>You will enter your card details at checkout</small></p>\n        </div>\n        <div *ngIf=\"!canUpdateBillingProfile()\">\n          <input id=\"newCard\" type=\"radio\" (click)=\"setCheckoutNewCard()\" [checked]=\"!useSavedCard\" />\n          <label for=\"newCard\" *ngIf=\"!canUpdateBillingProfile()\">Use a new card</label>\n          <p class=\"pl-5\"><small>You will enter your card details at checkout</small></p>\n        </div>\n      </td>\n      <tr *ngIf=\"!inCheckoutProcess\">\n        <td colspan=\"3\">\n          <input *ngIf=\"!isSingleOrder\" type=\"button\" class=\"btn btn-secondary\" value=\"Return to Shop\" [routerLink]=\"['../']\" />\n          <input *ngIf=\"isSingleOrder\" type=\"button\" class=\"btn btn-secondary\" value=\"Cancel Order\" (click)=\"cancelSingleCheckoutOrder()\" />\n        </td>\n        <td>\n          <input type=\"button\" class=\"btn btn-primary\" (click)=\"openCheckout()\" value=\"Checkout\" [disabled]=\"loadingPaymentInformation\" />\n        </td>\n      </tr>\n  </tbody>\n</table>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport { ScaleRange } from '../../shared/models/scale-range';\nimport { Scale } from '../../shared/models/scale';\n\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Router, ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'app-scale-range-new',\n  templateUrl: './scale-range-new.component.html',\n  styleUrls: ['./scale-range-new.component.css']\n})\nexport class ScaleRangeNewComponent implements OnInit {\n\n  private _range:ScaleRange;\n  private scale:Scale;\n  private assessment:Assessment;\n  private readonly SAVE_TIME = 1500;\n  private readonly ERROR_MESSAGE_TIME = 3000;\n  public isSaving:boolean;\n\n  constructor( private assessmentService:AssessmentService\n    ,private alertService:AlertService\n    ,private router: Router\n    ,private route: ActivatedRoute) {\n      this.range = this.getNewObject();\n    }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let scaleId = params['scaleId'];\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.scale = assessment.scales.find((s) => s.id == scaleId);\n          if (!this.scale) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  private getNewObject() {\n    let obj = new ScaleRange();\n    obj.id = this.assessmentService.newId();\n    return obj;\n  }\n\n  get range():ScaleRange {\n    return this._range;\n  }\n\n  set range(v:ScaleRange) {\n    this._range = v;\n  }\n\n  private saveRange(range) {\n    this.scale.addRange(range);\n    this.isSaving = true;\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Range saved\", this.SAVE_TIME);\n      this.isSaving = false;\n      return range;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\", this.ERROR_MESSAGE_TIME);\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveRange(this.range).then((question) => {\n      setTimeout(() => {\n        this.router.navigate([\"../\", this.range.id,\"edit\"], {relativeTo: this.route, replaceUrl: true});\n\t\t\t}, this.SAVE_TIME);\n    });\n\t}\n\n\tsaveAndCreateNew() {\n    this.saveRange(this.range).then((question) => {\n      this.range = this.getNewObject();\n    });\n\t}\n\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">New Range</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n            <h3 class='h3-responsive text-center'>{{range.name}}</h3>\n        </div>\n        <div class=\"card-body\">\n        <form>\n          <div class=\"form-group\">\n            <label for=\"name\">Name:</label>\n            <input class=\"form-control\" type=\"text\" name=\"name\" id=\"name\" [(ngModel)]=\"range.name\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"displayName\">Display Name:</label>\n            <input class=\"form-control\" type=\"text\" name=\"displayName\" id=\"displayName\" [(ngModel)]=\"range.displayName\" />\n          </div>\n          <div class=\"form-group\">\n                <label for=\"rangeStart\">Range Start:</label>\n            <input class=\"form-control\" type=\"number\" name=\"rangeStart\" id=\"rangeStart\" [(ngModel)]=\"range.rangeStart\" />\n          </div>\n          <div class=\"form-group\">\n                <label for=\"rangeEnd\">Range End:</label>\n            <input class=\"form-control\" type=\"number\" name=\"rangeEnd\" id=\"rangeEnd\" [(ngModel)]=\"range.rangeEnd\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"therapistContent\">Therapist Content:</label>\n            <textarea class=\"form-control\" rows=\"5\" name=\"therapistContent\" [(ngModel)]=\"range.therapistContent\" id=\"therapistContent\"></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"clientContent\">Client Content:</label>\n            <textarea class=\"form-control\" rows=\"5\" name=\"clientContent\" [(ngModel)]=\"range.clientContent\" id=\"clientContent\"></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"mediaURL\">Media URL:</label>\n            <input class=\"form-control\" type=\"text\" name=\"mediaURL\" id=\"mediaURL\" [(ngModel)]=\"range.mediaURL\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"assignmentURL\">Assignment URL:</label>\n            <input class=\"form-control\" type=\"text\" name=\"assignmentURL\" id=\"assignmentURL\" [(ngModel)]=\"range.assignmentURL\" />\n          </div>\n        </form>\n        <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n        <!--<pre>\n          {{range|json}}\n        </pre>-->\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routes,RouterModule } from '@angular/router';\nimport { UserListComponent } from \"./user-list/user-list.component\";\nimport { UserEditComponent } from \"./user-edit/user-edit.component\";\nimport { UserNewComponent } from \"./user-new/user-new.component\";\nimport { UserDeleteComponent } from \"./user-delete/user-delete.component\";\n\nconst userRoutes: Routes = [\n    {path: '',component: UserListComponent}\n    ,{path: 'new', component: UserNewComponent }\n    ,{path: ':userId/edit', component: UserEditComponent}\n    ,{path: ':userId/delete', component: UserDeleteComponent}\n  ];\n@NgModule({\n  imports: [\n    RouterModule.forChild(userRoutes)\n  ],\n  exports: [\n    RouterModule\n  ]\n})\nexport class UsersRoutingModule {}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { Company } from 'app/shared/models/company';\nimport { User } from 'app/shared/models/user';\nimport { Role } from 'app/shared/models/role';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { CompanyService } from 'app/shared/services/company.service';\n\n@Component({\n  selector: 'app-company-new',\n  templateUrl: './company-new.component.html',\n  styleUrls: ['./company-new.component.css']\n})\nexport class CompanyNewComponent implements OnInit {\n\n  public Company:Company;\n  public passwordChange:string;\n  public confirmPassword:string;\n  public isSaving:boolean;\n\n  constructor(private companyService:CompanyService, private router:Router\n    , private route:ActivatedRoute, private alertService:AlertService) {\n    this.Company = new Company();\n    this.Company.user = new User();\n    this.Company.user.role = Role.Owner;\n  }\n\n  ngOnInit() {\n  }\n\n  private validateForm() {\n    let errors = [];\n    if (!this.Company.name) {\n      errors.push(\"You must enter a name for this company\");\n    }\n    else if (this.Company.name.length < 3) {\n      errors.push(\"Company must be at least 3 characters long\");\n    }\n\n    if (!this.Company.email) {\n      errors.push(\"You must enter a valid email for this company\");\n    }\n\n\n    if (!this.passwordChange) {\n      errors.push(\"You must enter in a password for the user for this company\");\n    }\n\n    if (this.passwordChange != this.confirmPassword) {\n      errors.push(\"The passwords don't match\");\n    }\n    if (this.passwordChange && this.passwordChange.length < 8) {\n      errors.push(\"Password must be at least 8 characters\");\n    }\n    return errors;\n  }\n\n  save() {\n    let errors = this.validateForm();\n    if (errors.length) {\n      this.alertService.error(errors.join(\".\\n\"), 3000);\n      return;\n    }\n    this.isSaving = true;\n    this.Company.user.password = this.passwordChange;\n    this.companyService.createCompany(this.Company).then((company) => {\n      this.router.navigate(['../', company.id, 'edit'], {replaceUrl: true, relativeTo: this.route});\n    })\n    .catch((error) => {\n      console.error(error);\n      this.isSaving = false;\n      let msg = \"Company failed to create.  Check server logs for details.\";\n      if (error.status == 400) {\n        let json = error.body;\n        if (json && json._code && json._code == 'DUP_ENTRY') {\n          msg = \"That username already exists in the system\";\n        }\n      }\n      this.alertService.error(msg);\n    });\n  }\n\n  public setUserRole(role:Role) {\n    this.Company.user.role = role;\n  }\n\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h1 class=\"h1-responsive text-center\">New Company</h1>\n    </div>\n</div>\n<div class=\"row\">\n    <dac-tabs class=\"col-12\">\n        <dac-tab heading=\"General\">\n\n            <div class=\"form-group\">\n                <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"name\">Name:</label>\n                <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                    <input class=\"form-control\" id=\"name\" type=\"text\" [(ngModel)]=\"Company.name\" />\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"name\">Contact Email:</label>\n                <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                    <input class=\"form-control\" id=\"name\" type=\"text\" [(ngModel)]=\"Company.email\" />\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"username\">Username:</label>\n                <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                    <username-checker [user]=\"Company.user\"></username-checker>\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"password\">Password:</label>\n                <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                    <input class=\"form-control\" id=\"password\" type=\"password\" [(ngModel)]=\"passwordChange\" />\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"confirmPassword\">Confirm Password:</label>\n                <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                    <input id=\"confirmPassword\" type=\"password\" class=\"form-control\" [(ngModel)]=\"confirmPassword\" />\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <div class=\"col-sm-12\">\n                    <input [disabled]=\"isSaving\" class=\"btn btn-primary\" type=\"button\" value=\"Save\" (click)=\"save()\" />\n                </div>\n            </div>\n        </dac-tab>\n    </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {ListQuestion} from '../../shared/models/list-question';\nimport {QuestionSetType} from '../../shared/models/question-set-type';\nimport { Component, OnInit, Input, OnChanges } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AssessmentService } from 'app/shared/services/assessment.service';\nimport { Assessment } from 'app/shared/models/assessment';\nimport { Question } from 'app/shared/models/question';\nimport { QuestionType } from 'app/shared/models/question-type';\nimport { QuestionSet } from 'app/shared/models/question-set';\n\n@Component({\n  selector: 'dac-question-set-list-view',\n  templateUrl: './question-set-list-view.component.html'\n})\nexport class QuestionSetListViewComponent implements OnInit, OnChanges {\n  @Input() assessment:Assessment;\n  public selected:QuestionSet;\n\n  constructor(\n  ) {\n    }\n\n  ngOnInit() {\n    this.populateQuestionSetFromAssessment(this.assessment);\n  }\n\n  ngOnChanges() {\n    this.populateQuestionSetFromAssessment(this.assessment);\n  }\n\n  getLabelsForSelected(questionSet:QuestionSet, question:Question) {\n    if (questionSet.display_type == QuestionSetType.QUESTION_LIST) {\n      let listQuestion = question as ListQuestion;\n      return listQuestion.CustomLabels;\n    }\n    return questionSet.labels;\n  }\n\n  public isTextItem(item:Question) {\n    return item.type == QuestionType.Textbox;\n  }\n\n  getClassesForItem(item:QuestionSet) {\n    let isSelected = item == this.selected;\n    let classes = {\n      'primary-color': isSelected\n      ,'white-text': isSelected\n    };\n    return classes;\n  }\n\n  private populateQuestionSetFromAssessment(assessment:Assessment) {\n    if (!assessment) {\n      return;\n    }\n    if (assessment.question_sets && assessment.question_sets.length) {\n      this.selected = this.assessment.question_sets[0];\n    }\n  }\n}\n","<div class=\"row\">\n  <div class=\"col\">\n      <h2 class=\"h2-responsive\"> Question Sets</h2>\n      <!--TODO: stephen move this to <scales-list></scales-list>-->\n      <p *ngIf=\"assessment.scales.length <= 0\">No Question Sets exist</p>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col-sm-4 col-lg-3\">\n    <ul class=\"list-group flex-column\">\n      <li class=\"list-group-item\" \n        [ngClass]=\"getClassesForItem(questionSet)\"\n        *ngFor=\"let questionSet of assessment.question_sets;\" (click)=\"selected = questionSet\"><a>{{questionSet.title}}</a></li>\n      </ul>\n  </div>\n  <div class=\"col-sm-8 col-lg-9\" *ngIf=\"!selected\">\n    <p class=\"alert alert-info\">Select a question set.</p>\n  </div>\n  <div class=\"col-sm-8 col-lg-9\" *ngIf=\"selected\">\n    <h2>{{selected.title}}</h2>\n    <table class=\"table table-striped\">\n      <thead class=\"secondary-color text-white\">\n        <th scope=\"col\" class=\"w-50\">Question</th>\n        <th scope=\"col\" class=\"w-50\">Answers</th>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let item of selected.questions\">\n          <td>\n              {{item.prompt}}\n          </td>\n          <td *ngIf=\"isTextItem(item)\">\n              <span>Text</span>\n          </td>\n          <td *ngIf=\"!isTextItem(item)\">\n              <span *ngFor=\"let lbl of getLabelsForSelected(selected, item);let first = first; let last = last;\">\n                {{lbl.label}}\n                <span *ngIf=\"!last\">,</span>\n              </span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AssessmentTokenService} from '../../shared/services/assessment-token.service';\nimport { Component, OnInit, EventEmitter, Output, OnDestroy } from '@angular/core';\nimport { AssessmentGroupService } from '../../shared/services/assessment-group.service';\nimport { AssessmentService } from 'app/shared/services/assessment.service';\nimport { AuthService } from 'app/login/services/auth.service';\nimport { User } from 'app/shared/models/user';\nimport { Capability } from 'app/shared/models/capability';\nimport { SubscriptionLike as ISubscription } from 'rxjs';\n\n@Component({\n  selector: 'dac-assessment-tokens-list',\n  templateUrl: './assessment-tokens-list.component.html',\n  styleUrls: ['./assessment-tokens-list.component.css']\n})\nexport class AssessmentTokensListComponent implements OnInit,OnDestroy {\n\n  public tokenItems:{name:string, quantity:number}[];\n  public groupTokenItems:{name:string, quantity:number}[];\n  private canShop:Boolean;\n  private _loaded:boolean;\n  private _userSubscription:ISubscription;\n  @Output() buy = new EventEmitter<{name:string, quantity:number}>();\n\n  constructor(private tokenService:AssessmentTokenService\n  ,private assessmentGroupService:AssessmentGroupService\n  ,private assessmentService:AssessmentService\n  ,private authService:AuthService) {\n    this._loaded = false;\n    this.canShop = false;\n\n    this._userSubscription = this.authService.getLoginState().subscribe(loginState =>{\n      if (loginState.user) {\n        this.canShop = loginState.user.hasCapability(Capability.CAN_SHOP);\n      }\n      else {\n        this.canShop = false;\n      }\n    });\n  }\n\n  ngOnInit() {\n    this._loaded = false;\n    Promise.all([\n      this.tokenService.loadAssessmentTokens()\n      ,this.assessmentGroupService.getAssessmentGroups()\n      ,this.assessmentService.getAssessmentList()\n      ,\n    ])\n    .then((results) => {\n      let [, groups, assessments] = results;\n      this.groupTokenItems = groups.map(g => {return {name: g.Name, quantity: this.tokenService.getGroupRemainingTokens(g)} });\n      this.tokenItems= assessments.map(a => {return {name: a.name, quantity: this.tokenService.getRemainingTokens(a)};});\n      this._loaded = true;\n    })\n    .catch(error => {\n      console.error(error);\n      this._loaded = true;\n    })\n  }\n\n  ngOnDestroy() {\n    this._userSubscription.unsubscribe();\n  }\n\n  public get loaded() {\n    return this._loaded;\n  }\n\n  triggerBuy(item:{name:string, quantity:number}) {\n    this.buy.emit(item);\n  }\n\n  public shouldBuyTokens(item) {\n    return this.canShop && item.quantity <= 0\n  }\n\n}\n","<dac-tabs>\n  <dac-tab heading=\"Batteries\" class=\"col\">\n      <div class=\"row\" *ngIf=\"!loaded\">\n          <div class=\"col-12\">\n            <p class=\"alert alert-info\">Loading...</p>\n          </div>\n      </div>\n\n      <div class=\"row\" *ngIf=\"loaded\">\n        <div class=\"list-group px-3 col-12\">\n          <div class=\"list-group-item d-flex justify-content-between align-items-center\" *ngFor=\"let item of groupTokenItems\">\n            {{item.name}}\n            <span *ngIf=\"!loaded\" class=\"badge badge-primary badge-pill\">Loading...</span>\n            <span *ngIf=\"loaded && !shouldBuyTokens(item)\" class=\"badge badge-primary badge-pill\">{{item.quantity}}</span>\n            <dac-buy-item-button *ngIf=\"loaded && shouldBuyTokens(item)\" (click)=\"triggerBuy($event)\" [item]=\"item\"></dac-buy-item-button>\n          </div>\n        </div>\n      </div>\n  </dac-tab>\n  <dac-tab heading=\"Assessments\" class=\"col\">\n      <div class=\"row\" *ngIf=\"!loaded\">\n        <div class=\"col-12\">\n          <p class=\"alert alert-info\">Loading...</p>\n        </div>\n      </div>\n      <div *ngIf=\"loaded\" class=\"row\">\n        <div class=\"list-group px-3 col-12\">\n          <div class=\"list-group-item d-flex justify-content-between align-items-center\" *ngFor=\"let item of tokenItems\">\n              {{item.name}}\n              <span *ngIf=\"!loaded\" class=\"badge badge-primary badge-pill\">Loading...</span>\n              <span *ngIf=\"loaded && !shouldBuyTokens(item)\" class=\"badge badge-primary badge-pill\">{{item.quantity}}</span>\n              <button *ngIf=\"loaded && shouldBuyTokens(item)\" class=\"badge badge-primary badge-pill btn btn-sm btn-primary\" alt=\"Buy Tokens\"\n                title=\"Buy Tokens\" [routerLink]=\"['/admin/shop/']\">Buy</button>\n          </div>\n        </div>\n      </div>\n  </dac-tab>\n</dac-tabs>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, ChangeDetectorRef, ViewChild } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { ManagedClient } from '../../shared/models/managed-client';\nimport { ClientService } from '../../shared/services/client.service';\nimport { Location } from \"@angular/common\";\nimport { ReportService } from \"../../reports/services/report.service\";\n\nimport { User } from 'app/shared/models/user';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { Assignment } from 'app/shared/models/Assignment';\nimport { ShoppingService } from 'app/shared/services/shopping.service';\nimport { AssessmentAssignerService } from '../services/assessment-assigner.service';\nimport { AuthService } from 'app/login/services/auth.service';\nimport { AssignmentService } from 'app/shared/services/assignment.service';\nimport { TabsComponent } from 'app/tabs/tabs.component';\n\ninterface ReportResult {\n  id: string;\n  name: string;\n  hasMetRequirements: boolean;\n}\ninterface ReportResultContainer {\n  [name: string] : ReportResult[]\n}\n\n@Component({\n  selector: 'app-client-edit',\n  templateUrl: './client-edit.component.html',\n  styleUrls: ['./client-edit.component.css']\n})\nexport class ClientEditComponent implements OnInit {\n\n  @ViewChild('staticTabs') staticTabs: TabsComponent;\n\n  private _client: ManagedClient;\n  private _clientToSave: ManagedClient;\n  private _newAssignedUser: User;\n  private _reportsByAssignment:ReportResultContainer;\n  public loadedClient:boolean;\n  public isSavingClient:boolean;\n  public clientShareLink:string;\n  public hasActiveSubscription:boolean;\n\n  constructor(\n    private _clientService: ClientService,\n    private router: Router,\n    private location: Location,\n    private route: ActivatedRoute,\n    private alertService: AlertService,\n    private reportService:ReportService,\n    private authService:AuthService,\n    private shoppingService:ShoppingService,\n    private assessmentAssignerService:AssessmentAssignerService,\n    private assignmentService:AssignmentService\n  ) {\n    this._reportsByAssignment = {};\n    this._client = new ManagedClient();\n    this._clientToSave = new ManagedClient();\n    this.loadedClient = false;\n    this.clientShareLink = window.location.href;\n    this.hasActiveSubscription = false;\n  }\n\n  ngOnInit() {\n    this.authService.getLoginState().subscribe(loginState => {\n      if (loginState && loginState.user) {\n        this.hasActiveSubscription= loginState.user.hasActiveSubscription();\n      }\n      else {\n        this.hasActiveSubscription = false;\n      }\n    });\n\n    // we are skipping the whole switchMap thingy until we figure out\n    // more on how to use it... for now we are just trying to port the code\n    // from angularjs (1.X)\n    // TODO: stephen figure out how to do the switchMap to cut down on multiple http requests.\n    this.route.params.subscribe(params => {\n      let clientId = params['id'];\n      if (!clientId || typeof clientId !== \"string\") {\n        this.router.navigate(['../']);\n        return;\n      }\n\n      this._clientService.getClient(clientId)\n        .then((client: ManagedClient) => {\n          console.log(\"loaded client is \", client);\n          this._client = client;\n          this._clientToSave = Object.assign(new ManagedClient(), client); // copy over relevant data\n          this.loadedClient = true;\n          // if we have no assignments we need to make sure we go to the tab for setting assignments.\n\n          this._reportsByAssignment = {};\n          // TODO: stephen I'm not sure I like the way this is implemented.\n          return Promise.all(client.assignments.map(a => this.reportService.getReportsForAssignment(a).then(reports => {\n            this._reportsByAssignment[a.Id] = reports.map(r => Object.assign(r, {IsComplete: a.IsComplete, hasMetRequirements: true}));\n          })))\n          .then((results) => {\n            return client;\n          })\n        })\n        .then((client) => {\n          // since the tabs haven't rendered yet... we need to wait for them to render now that the\n          // client has loaded.\n          if (client.hasNoAssignments()) {\n            setTimeout(() => {\n             if (this.staticTabs) {\n                this.staticTabs.toggleActive(this.staticTabs.tabs[1]);\n              }\n            }, 250);\n          }\n        })\n        .catch((error) => {\n          this.alertService.error(\"Failed to load client from server. Please check your internet connection and reload the page\");\n          console.error(error);\n          // TODO: stephen handle when client is not\n          // found\n        });\n\n    });\n\n  }\n\n\n  goBack() {\n    this.location.back();\n  }\n  public get assignments(): Assignment[] {\n    return this._client.assignments;\n  }\n\n  public hasReportsForAssignment(assignment:Assignment) {\n    return this._reportsByAssignment[assignment.Id] && this._reportsByAssignment[assignment.Id].length;\n  }\n\n  public getReportsForAssignment(assignment:Assignment) {\n    if (this.hasReportsForAssignment(assignment)) {\n      return this._reportsByAssignment[assignment.Id];\n    }\n    return [];\n  }\n\n  public setNewUser(user:User) {\n    this._newAssignedUser = user;\n  }\n\n  public updateClientUser(isValid:boolean) {\n\n    if (!isValid) {\n      this.alertService.error(\"You must fill in all required fields\");\n      return;\n    }\n\n    // need to go through and validate the client\n    if (this._newAssignedUser) {\n      this._clientToSave.user = this._newAssignedUser;\n    }\n    // let errors = this._clientService.validateClient(this._clientToSave);\n\n    this.isSavingClient = true;\n    this._clientService.saveClient(this._clientToSave).then((result) => {\n      this.isSavingClient = false;\n      this._client.lastName = this._clientToSave.lastName;\n      this._client.firstName = this._clientToSave.firstName;\n      this._client.email = this._clientToSave.email;\n      this._client.user = this._clientToSave.user;\n      this.alertService.success(\"Client information was updated\");\n    })\n    .catch((error) => {\n      this.isSavingClient = false;\n      this.alertService.error(\"Failed to update client information.  Try again or contact support\");\n      console.error(error);\n    })\n  }\n\n  public get client(): ManagedClient {\n    return this._client;\n  }\n\n  public set client(v: ManagedClient) {\n    this._client = v;\n  }\n\n  public get clientToSave() : ManagedClient {\n    return this._clientToSave;\n  }\n  public set clientToSave(v:ManagedClient) {\n    this._clientToSave = v;\n  }\n}\n","<div class=\"row\">\n    <div class=\"col\">\n        <h1 class=\"h1-responsive\" *ngIf=\"loadedClient\"><i class=\"fa fa-user p-2\"></i>{{client.getDisplayString()}} <span class=\"pl-2 h3\"><dac-copy-clipboard [iconClass]=\"'fa-share-alt-square'\" [content]=\"clientShareLink\"></dac-copy-clipboard></span></h1>\n    </div>\n    <div class=\"x-float-right\">\n        <p><a class=\"btn btn-primary\" [routerLink]=\"['../client']\">Back</a></p>\n    </div>\n</div>\n<div class=\"row\" *ngIf=\"!loadedClient\">\n    <div class=\"col\">\n        <p class=\"alert alert-warning\">\n            <app-spin-icon></app-spin-icon>Loading Client...\n        </p>\n    </div>\n</div>\n<div class=\"row\" *ngIf=\"loadedClient\">\n    <dac-tabs class=\"col-12\" #staticTabs>\n        <dac-tab heading=\"Assignment Reports\" class=\"reportsTab\">\n            <div class=\"alert alert-warning\" *ngIf=\"assignments.length <= 0\">No assessments currently assigned.</div>\n            <div class=\"row list-item-group view view-cascade secondary-gradient p-3 text-light\" *ngIf=\"assignments.length > 0\">\n                <div class=\"col-12\">\n                    <div class=\"row\">\n                        <div class=\"col-6\">Name</div>\n                        <div class=\"col-2\">Assigned</div>\n                        <div class=\"col-2\">Completed</div>\n                        <div class=\"col-2 text-center\">Action</div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"row list-group-item\" *ngFor=\"let assignment of assignments\">\n                <div class=\"col-12\" *ngIf=\"assignment.type == 'Assessment'\">\n                    <div class=\"row\">\n                        <div class=\"col-6\">\n                            <i class=\"fa fa-clipboard\"></i>\n                            {{assignment.Name}}\n                        </div>\n                        <div class=\"col-2\">{{assignment.DateAssigned|date:'mediumDate'}}</div>\n                        <div class=\"col-2\">\n                            <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}}</span>\n                            <span *ngIf=\"!assignment.IsComplete\">Incomplete</span>\n                        </div>\n                        <div class=\"col-2 text-center\">\n                            <button class='btn btn-primary btn-sm' *ngIf=\"assignment.IsComplete\" [routerLink]=\"['result', assignment.ResultId]\">\n                                View Report\n                            </button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-12\" *ngIf=\"assignment.type == 'Questionnaire' || assignment.type == 'ExternalQuestionnaire'\">\n                  <div class=\"row\">\n                      <div class=\"col-6\">\n                          <i class=\"fa fa-clipboard\"></i>\n                          {{assignment.Name}}\n                      </div>\n                      <div class=\"col-2\">{{assignment.DateAssigned|date:'mediumDate'}}</div>\n                      <div class=\"col-2\">\n                          <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}}</span>\n                          <span *ngIf=\"!assignment.IsComplete\">Incomplete</span>\n                      </div>\n                      <div class=\"col-2 text-center\">\n                        <button class='btn btn-primary btn-sm' *ngIf=\"assignment.IsComplete\" [routerLink]=\"['questionnaire-result', assignment.ResultId]\">\n                          View Report\n                      </button>\n                      </div>\n                  </div>\n              </div>\n                <div class=\"col-12\" *ngIf=\"assignment.type == 'LibraryAsset'\">\n                    <div class=\"row\">\n                        <div class=\"col-6\">\n                            <i class=\"fa fa-file-text\"></i>\n                            {{assignment.Name}}\n                        </div>\n                        <div class=\"col-2\">{{assignment.DateAssigned|date:'mediumDate'}}</div>\n                        <div class=\"col-2\">\n                            <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}}</span>\n                            <span *ngIf=\"!assignment.IsComplete\">Incomplete</span>\n                        </div>\n                        <div class=\"col-2 text-center\">\n                            <button class='btn btn-primary btn-sm' *ngIf=\"assignment.IsComplete\" [routerLink]=\"['asset-result', assignment.ResultId]\">\n                                View Report\n                            </button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-12\" *ngIf=\"assignment.isGroup\">\n                    <div class=\"row mb-2\">\n                        <div class=\"col-6\">\n                            <i class=\"fa fa-folder\"></i>\n                            {{assignment.Name}}\n                        </div>\n                        <div class=\"col-2\">{{assignment.DateAssigned|date:'mediumDate'}}</div>\n                        <div class=\"col-2\">\n                            <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}}</span>\n                            <span *ngIf=\"!assignment.IsComplete\">Incomplete - {{assignment.getAssignmentsCompleted()}}/{{assignment.getTotalAssignments()}}</span>\n                        </div>\n                        <div class=\"col-2\">\n                        </div>\n                    </div>\n                    <div class=\"row\" *ngIf=\"hasReportsForAssignment(assignment)\">\n                            <div class=\"col-6 pl-5\">\n                                <h6>Battery Reports</h6>\n                                <hr />\n                            </div>\n                        </div>\n                    <!--Need to display the battery reports underneath here...-->\n                    <div class=\"row\" *ngFor=\"let report of getReportsForAssignment(assignment)\">\n                            <div class=\"col-6 pl-5\">\n                                <i class=\"fa fa-bar-chart\"></i>\n                                {{report.name}}\n                            </div>\n                            <div class=\"col-2 text-center\"></div>\n                            <div class=\"col-2\">\n                                <span *ngIf=\"assignment.IsComplete\">{{assignment.DateCompleted|date:'mediumDate'}}</span>\n                                <span *ngIf=\"!assignment.IsComplete\">Incomplete</span>\n                            </div>\n                            <div class=\"col-2  text-center\">\n                                <button class='btn btn-primary btn-sm' *ngIf=\"assignment.IsComplete\" [routerLink]=\"['report', report.id, assignment.id]\">\n                                    View Report\n                                </button>\n                            </div>\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-6 pl-5 mt-3\">\n                            <h6>Individual Assessment Reports</h6>\n                            <hr />\n                        </div>\n                    </div>\n                    <div class=\"row\" *ngFor=\"let item of assignment.Items\">\n                            <div class=\"col-6 pl-5\">\n                                <i class=\"fa fa-bar-chart\"></i>\n                                {{item.Name}}\n                            </div>\n                            <div class=\"col-2\"></div>\n                            <div class=\"col-2\">\n                                <span *ngIf=\"item.IsComplete\">{{item.DateCompleted|date:'mediumDate'}}</span>\n                                <span *ngIf=\"!item.IsComplete\">Incomplete</span>\n                            </div>\n                            <div class=\"col-2 text-center\" *ngIf=\"item.type == 'Assessment'\">\n                                <button class='btn btn-primary btn-sm' *ngIf=\"item.IsComplete\" [routerLink]=\"['result', item.ResultId]\">\n                                    View Report\n                                </button>\n                            </div>\n                            <div class=\"col-2 text-center\" *ngIf=\"item.type == 'Questionnaire' || item.type == 'ExternalQuestionnaire'\">\n                              <button class='btn btn-primary btn-sm' *ngIf=\"assignment.IsComplete\" [routerLink]=\"['questionnaire-result', item.ResultId]\">\n                                View Report\n                              </button>\n                            </div>\n                    </div>\n                </div>\n            </div>\n        </dac-tab>\n        <dac-tab heading=\"Manage Assignments\">\n            <dac-client-manage-assignments class=\"col\" [client]=\"client\" *ngIf=\"hasActiveSubscription\"></dac-client-manage-assignments>\n            <dac-user-upgrade-subscription-notice *ngIf=\"!hasActiveSubscription\"></dac-user-upgrade-subscription-notice>\n        </dac-tab>\n        <dac-tab heading=\"Send Invitation\">\n            <dac-client-send-invitation class=\"col\" [client]=\"client\" *ngIf=\"hasActiveSubscription\"></dac-client-send-invitation>\n            <dac-user-upgrade-subscription-notice *ngIf=\"!hasActiveSubscription\"></dac-user-upgrade-subscription-notice>\n        </dac-tab>\n        <!-- TODO: @adunsulag when we figure out how to feature enable this we can add it back -->\n        <!-- Client edit of information happens in the EMR now-->\n        <!-- <dac-tab heading=\"Admin\">\n            <div class=\"col\">\n                <h2>Client Information</h2>\n                <hr class=\"mb-3\" />\n                <div class=\"row\">\n                    <label class=\"col-md-4 col-lg-3\" for=\"uniqueToken\">\n                        <h6><i class=\"fa fa-key pt-2 pr-2 h4-responsive\"></i>Client Login Identifier:</h6>\n                    </label>\n                    <div class=\"col-6 col-md-8 col-lg-9\">\n                        {{client.customField1}}\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col-md-4 col-lg-3\">\n                        <h6><i class=\"fa fa-user red-text pt-2 pr-2 h4-responsive\"></i>Assigned User:</h6>\n                    </div>\n                    <div class=\"col-6 col-md-8 col-lg-9\">\n                        {{client.user?.getDisplayName()}}\n                    </div>\n                </div>\n\n                <h2 class=\"mt-5\">Update Client Information</h2>\n                <hr class=\"mb-3\" />\n                <form #clientForm=\"ngForm\" class=\"form-horizontal\">\n                    <div class=\"form-group\">\n                        <label class=\"col-12\" for=\"firstName\">\n                            <h6><i class=\"fa fa-user pt-2 pr-2 h4-responsive\"></i>First Name*:</h6>\n\n                        </label>\n                        <div class=\"col-12\">\n                            <input class=\"form-control\" name=\"firstName\" type=\"text\" [(ngModel)]=\"clientToSave.firstName\"\n                            required #firstName=\"ngModel\" />\n                        </div>\n                        <div *ngIf=\"firstName.invalid && (firstName.dirty || firstName.touched || clientForm.submitted)\"\n                            class=\"alert alert-danger\">\n                            <div *ngIf=\"firstName.errors.required\">\n                                First Name is required.\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"form-group\">\n                        <label class=\"col-12\" for=\"lastName\">\n                            <h6><i class=\"fa fa-user pt-2 pr-2 h4-responsive\"></i>Last Name*:</h6>\n\n                        </label>\n                        <div class=\"col-12\">\n                            <input class=\"form-control\" name=\"lastName\" type=\"text\" [(ngModel)]=\"clientToSave.lastName\" required #lastName=\"ngModel\" />\n                        </div>\n                        <div *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched || clientForm.submitted)\"\n                            class=\"alert alert-danger\">\n                            <div *ngIf=\"lastName.errors.required\">\n                                Last Name is required.\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"form-group\">\n                        <label class=\"col-12\" for=\"emailAddress\">\n                            <h6><i class=\"fa fa-envelope pt-2 pr-2 h4-responsive\"></i>Email*:</h6>\n                        </label>\n                        <div class=\"col-12\">\n                            <input class=\"form-control\" name=\"emailAddress\" type=\"text\" email [(ngModel)]=\"clientToSave.email\" #emailAddress=\"ngModel\" />\n                        </div>\n                        <div *ngIf=\"emailAddress.invalid && (emailAddress.dirty || emailAddress.touched || clientForm.submitted)\"\n                            class=\"alert alert-danger\">\n                            <div *ngIf=\"emailAddress.errors.required\">\n                                Email is required.\n                            </div>\n                            <div *ngIf=\"emailAddress.errors.email\">\n                                    Email must be a valid email address with the local address being shorter than 64 characters and the whole email\n                                    address less than 254 characters.\n                                </div>\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\" *hasPermission=\"'Admin'\">\n                        <label class=\"col-12\" for=\"assignedUser\"><h6><i class=\"fa fa-user red-text pt-2 pr-2 h4-responsive\"></i>Assigned User</h6></label>\n                        <div class=\"col-12\">\n                            <user-selector [user]=\"clientToSave.user\" [allowEmpty]=\"true\" (selected)=\"setNewUser($event)\"></user-selector>\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <div class=\"col\">\n                            <input [disabled]=\"isSaving || !hasActiveSubscription\" class=\"btn btn-primary\" type=\"button\" value=\"Save\" (click)=\"clientForm.submitted=true;updateClientUser(clientForm.valid)\" />\n                            <dac-user-upgrade-subscription-notice *ngIf=\"!hasActiveSubscription\"></dac-user-upgrade-subscription-notice>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </dac-tab> -->\n    </dac-tabs>\n</div>\n\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {ListQuestion} from '../../shared/models/list-question';\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport { Question } from '../../shared/models/question';\nimport { QuestionSet } from '../../shared/models/question-set';\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { QuestionFactoryService } from '../../shared/services/question-factory.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Scale } from '../../shared/models/scale';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { QuestionSetLabel } from 'app/shared/models/question-set-label';\nimport { QuestionType } from 'app/shared/models/question-type';\nimport { FlaggedCondition } from 'app/shared/models/flagged-condition';\nimport { QuestionSetType } from \"app/shared/models/question-set-type\";\n\n@Component({\n  selector: 'app-question-edit',\n  templateUrl: './question-edit.component.html',\n  styleUrls: ['./question-edit.component.css']\n})\nexport class QuestionEditComponent implements OnInit {\n\n    private _question:Question;\n  private questionSet:QuestionSet;\n  private assessment:Assessment;\n  private readonly SAVE_TIME = 1500;\n  private readonly ERROR_MESSAGE_TIME = 3000;\n  public isSaving:boolean;\n  public flagValue:any;\n  public flagDirection:any;\n  private _flagDirectionList:{id:string, name:string}[];\n\n  constructor(\n    private assessmentService:AssessmentService\n    ,private questionFactory: QuestionFactoryService\n    ,private alertService: AlertService\n    ,private router: Router\n    ,private route: ActivatedRoute\n  ) {\n    this._question = this.questionFactory.createDefaultEmptyQuestion();\n    this._flagDirectionList = [\n      {id: 'greaterOrEqual', 'name':\"Greater than or equal to\"}\n      ,{id: 'lessOrEqual', 'name':\"Less than or equal to\"}\n    ];\n\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      let questionId = params['questionId'];\n\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.questionSet = assessment.question_sets.find((s) => s.id == setId);\n          this._question = (this.questionSet) ? this.questionSet.questions.find((q) => q.id == questionId) : null;\n          if (!(this.questionSet && this._question)) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n\n          // if only one scale remains on the edit, make sure it's always the most current.\n          this.setScaleIfSingle(this.question, this.assessment);\n\n          if (this._question.hasFlagCondition) {\n            this.flagValue = this._question.flaggedCondition.flagValues;\n\n            // multiple choice only has a single flag so we go off that.\n            if (this.question.type == QuestionType.MultipleChoice) {\n              this.flagDirection = this._flagDirectionList.find(f => f.id == this._question.flaggedCondition.flagDirection);\n              this.flagValue = this.flagValue[0];\n            }\n          }\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  public getQuestionType(question:Question) {\n    let type = \"UNKNOWN\";\n    switch (question.type) {\n      case QuestionType.Checklist: {\n        type = \"Checklist\";\n      }\n      break;\n      case QuestionType.MultipleChoice: {\n        type = \"Multiple Choice\";\n      }\n      break;\n      case QuestionType.SingleChoice: {\n        type = \"Single Choice\";\n      }\n      break;\n      case QuestionType.Textbox: {\n        type = \"Textbox\";\n      }\n      break;\n    }\n    return type;\n  }\n\n  private setScaleIfSingle(question:Question, assessment:Assessment) {\n    if (assessment && assessment.scales && assessment.scales.length == 1) {\n      question.assessment_scale = this.assessment.scales[0];\n    }\n  }\n\n  get scales() : Scale[] {\n    if (this.assessment) {\n      return this.assessment.scales;\n    }\n    return null;\n  }\n\n  get question() : Question {\n    return this._question;\n  }\n\n  get labels() : QuestionSetLabel[] {\n    return (this.questionSet ? this.questionSet.labels : []);\n  }\n\n  get FlagDirections() : {id: string, name:string}[] {\n    return this._flagDirectionList;\n  }\n\n  public isChecklistQuestion() : boolean {\n    return this.question.type == QuestionType.Checklist;\n  }\n\n  public isMultipleChoiceQuestion() : boolean {\n    return this.question.type == QuestionType.MultipleChoice;\n  }\n\n  public compareIds(a:any, b:any) {\n    if (!a || !b) {\n      return false;\n    }\n    return a.id === b.id;\n  }\n\n  public toggleFlagQuestion(question:Question) {\n    let condition = null;\n    if (!question.hasFlagCondition) {\n      condition = new FlaggedCondition();\n    }\n    question.flaggedCondition = condition;\n  }\n\n  public hasFlagValue(flagValue:QuestionSetLabel) {\n    if (!this.flagValue) {\n      return false;\n    }\n\n    return this.flagValue.find(fv => fv.id == flagValue.id) != null;\n  }\n\n  public toggleChecklistFlagValue(flagValue:QuestionSetLabel) {\n    if (this.hasFlagValue(flagValue)) {\n      this.flagValue = this.flagValue.filter(fv => fv.id != flagValue.id);\n    }\n    else {\n      if (!this.flagValue) {\n        this.flagValue = [];\n      }\n      this.flagValue.push(flagValue);\n    }\n  }\n\n  private validateQuestion(question:Question) {\n    let errors = [];\n    if (!question.prompt || question.prompt.trim() == \"\") {\n      errors.push(\"question prompt cannot be empty\");\n    }\n    if (question.type != QuestionType.Textbox\n        && question.type != QuestionType.SingleChoice) {\n      if (question.hasFlagCondition) {\n        if (!question.flaggedCondition.flagValues.length) {\n          errors.push(\"Flag criteria must be set, or turn off the flag checkbox\");\n        }\n        if (question.type == QuestionType.MultipleChoice\n          && question.flaggedCondition.flagDirection == \"\") {\n            errors.push(\"Flag direction must be set\");\n          }\n      }\n    }\n    if (!question.assessment_scale) {\n      errors.push(\"This question must have a scale assigned to it before saving\");\n    }\n    return errors;\n\n  }\n\n  private updateFlagValues(question:Question) {\n    if (!question.hasFlagCondition) {\n      return;\n    }\n    if (question.type == QuestionType.MultipleChoice) {\n      question.flaggedCondition.addFlagValue(this.flagValue);\n      question.flaggedCondition.flagDirection = this.flagDirection.id;\n    }\n    else if (question.type == QuestionType.Checklist) {\n      this.flagValue.foreach(i => question.flaggedCondition.addFlagValue(i));\n    }\n  }\n\n  getAnswerLabels() : QuestionSetLabel[] {\n    let labels = this.questionSet.labels;\n    if (this.question.type == QuestionType.MultipleChoice\n    || this.question.type == QuestionType.Checklist) {\n      let listQuestion = this.question as ListQuestion;\n      labels = listQuestion.CustomLabels;\n    }\n    return labels;\n  }\n\n  allowCustomLabels() {\n    if (this.questionSet\n      && this.questionSet.display_type == QuestionSetType.QUESTION_LIST\n      && this.question.type != QuestionType.SingleChoice\n      && this.question.type != QuestionType.Textbox) {\n        return true;\n    }\n    return false;\n  }\n\n  private saveQuestion(question) {\n    this.isSaving = true;\n    this.updateFlagValues(question);\n    let errors = this.validateQuestion(question);\n    if (errors.length) {\n      this.alertService.error(errors.join(\".\\n\"), 3000);\n      this.isSaving = false;\n      return;\n    }\n\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Question saved\", this.SAVE_TIME);\n      this.isSaving = false;\n      return question;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\", this.ERROR_MESSAGE_TIME);\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveQuestion(this.question);\n\t}\n\n\tsaveAndCreateNew() {\n    this.saveQuestion(this.question).then((question) => {\n      this.router.navigate([\"../../\", \"new\"], {relativeTo: this.route, replaceUrl: true});\n    });\n\t}\n\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">Edit Question</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n      <div class=\"view gradient-card-header primary-gradient text-light\">\n        <h3 class='h3-responsive text-center text-truncate'>{{question.prompt || \"Untitled\"}}</h3>\n      </div>\n      <div class=\"card-body\">\n        <form>\n          <div class=\"form-group\">\n            <label for=\"type\">Type:</label>\n            <input class=\"form-control\" type=\"text\" id=\"type\" name=\"type\" [value]=\"getQuestionType(question)\" readonly />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"prompt\">Prompt:</label>\n            <input class=\"form-control\" type=\"text\" id=\"prompt\" name=\"prompt\" [(ngModel)]=\"question.prompt\" />\n          </div>\n          <!--<div class=\"form-group\">\n          <label for=\"displayOrder\">Display Order:</label>\n\t\t  <input class=\"form-control\" type=\"number\" id=\"displayOrder\" name=\"displayOrder\" [(ngModel)]=\"ctrl.question.display_order\" />\n    </div>-->\n        <div class=\"form-group\" *ngIf=\"allowCustomLabels()\" >\n          <label for=\"prompt\">Question Labels:</label>\n          <dac-question-labels-edit [question]=\"question\"></dac-question-labels-edit>\n        </div>\n\n        <div class=\"form-group\">\n            <input class=\"form-control\" [checked]=\"question.skip_scoring\"\n              type=\"checkbox\" id=\"skipScoring\" name=\"skipScoring\" [(ngModel)]=\"question.skip_scoring\" />\n            <label for=\"skipScoring\">Do not score:</label>\n          </div>\n          <div class=\"form-group\">\n            <input class=\"form-control\" [checked]=\"question.is_reversed\"\n              type=\"checkbox\" id=\"isReversed\" name=\"isReversed\" [(ngModel)]=\"question.is_reversed\" />\n            <label for=\"isReversed\">Is Reversed:</label>\n          </div>\n          <div class=\"form-group\">\n              <input class=\"form-control\" (click)=\"toggleFlagQuestion(question)\" [checked]=\"question.hasFlagCondition\" type=\"checkbox\"\n              id=\"hasFlagCondition\" name=\"hasFlagCondition\" />\n            <label for=\"hasFlagCondition\">Flag Question?:</label>\n          </div>\n          <div *ngIf=\"question.hasFlagCondition && isMultipleChoiceQuestion()\" class=\"form-group\">\n            <label for=\"flag\">Flag if answer is:</label>\n            <select id=\"flagDirection\"  class=\"browser-default form-control\"\n            name=\"flagDirection\" name=\"flagDirection\" [(ngModel)]=\"flagDirection\" [compareWith]=\"compareIds\">\n              <option *ngFor=\"let dir of FlagDirections;\" [ngValue]=\"dir\">{{dir.name}}</option>\n            </select>\n            <select class=\"form-control browser-default\" id=\"flagValue\" name=\"flagValue\" name=\"flagValue\" [(ngModel)]=\"flagValue\" [compareWith]=\"compareIds\">\n              <option *ngFor=\"let label of  getAnswerLabels();\" [ngValue]=\"label\">{{label.label}}</option>\n            </select>\n          </div>\n          <div *ngIf=\"question.hasFlagCondition && isChecklistQuestion()\" class=\"form-group\">\n            <label for=\"flag\">Flag if answer is:</label>\n            <ul>\n              <li *ngFor=\"let label of getAnswerLabels();\">\n                <label for=\"condition-{{label.id}}\">{{label.label}}</label>\n                <input id=\"condition-{{label.id}}\" type=\"checkbox\" class=\"form-control\" (click)=\"toggleChecklistFlagValue(label)\" [checked]=\"hasFlagValue(label)\" /></li>\n            </ul>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"scale\">Scale</label>\n            <select id=\"scale\" class=\"browser-default form-control\" name=\"scale\" *ngIf=\"scales?.length > 1\" [(ngModel)]=\"question.assessment_scale\">\n              <option *ngFor=\"let scale of scales\" [ngValue]=\"scale\">{{scale.name}}</option>\n            </select>\n            <input class=\"form-control\" readonly *ngIf=\"scales?.length == 1\" [value]=\"scales[0].name\">\n          </div>\n        </form>\n        <input type=\"button\" [disabled]=\"isSaving\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        <input type=\"button\" [disabled]=\"isSaving\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\"\n        />\n        <!--<pre>\n      {{ctrl.question|json}}\n    </pre>-->\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { Question } from '../../shared/models/question';\nimport { QuestionSet } from '../../shared/models/question-set';\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Scale } from '../../shared/models/scale';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { QuestionType } from \"../../shared/models/question-type\";\nimport { QuestionFactoryService } from\"../../shared/services/question-factory.service\";\nimport { QuestionSetLabel } from 'app/shared/models/question-set-label';\n\n@Component({\n  selector: 'app-question-new',\n  templateUrl: './question-new.component.html',\n  styleUrls: ['./question-new.component.css']\n})\nexport class QuestionNewComponent implements OnInit {\n\n  private _question:Question;\n  private _currentType:QuestionType;\n  private questionSet:QuestionSet;\n  private assessment:Assessment;\n  private readonly SAVE_TIME = 1500;\n  private readonly ERROR_MESSAGE_TIME = 3000;\n  public isSaving:boolean;\n\n  constructor(\n    private assessmentService:AssessmentService\n    ,private questionFactory:QuestionFactoryService\n    ,private alertService: AlertService\n    ,private location:Location\n    ,private router: Router\n    ,private route: ActivatedRoute\n  ) {\n    // make the default to be multiple choice.\n    this._currentType = QuestionType.MultipleChoice;\n    this._question = this.getNewQuestion();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.questionSet = assessment.question_sets.find((s) => s.id == setId);\n          if (!this.questionSet) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n          this.setScaleIfSingle(this.question, this.assessment);\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  private setScaleIfSingle(question:Question, assessment:Assessment) {\n    if (assessment && assessment.scales && assessment.scales.length == 1) {\n      question.assessment_scale = this.assessment.scales[0];\n    }\n  }\n\n  public updateType(event:Event) {\n    let select = event.target as HTMLInputElement;\n    this._currentType = +select                 .value;\n    let newQuestion = this.getNewQuestion();\n    newQuestion.prompt = this.question.prompt;\n    newQuestion.is_reversed = this.question.is_reversed;\n    this._question = newQuestion;\n  }\n\n  public get DisplayTypes() {\n    let types = [\n      {value: QuestionType.MultipleChoice, name: \"Multiple Choice\", isSelected: false}\n      ,{value: QuestionType.Checklist, name: QuestionType[QuestionType.Checklist], isSelected: false}\n      ,{value: QuestionType.Textbox, name: QuestionType[QuestionType.Textbox], isSelected: false}\n      ,{value: QuestionType.SingleChoice, name: \"Single Choice\", isSelected: false}\n    ]\n    types.forEach(t => t.isSelected = t.value == this._currentType);\n    return types;\n  }\n\n  private getNewQuestion() {\n    let question = this.questionFactory.createQuestionForType(this._currentType);\n    question.id = this.assessmentService.newId();\n    this.setScaleIfSingle(question, this.assessment);\n    return question;\n  }\n\n  get scales() : Scale[] {\n    if (this.assessment) {\n      return this.assessment.scales;\n    }\n    return null;\n  }\n\n  get question() : Question {\n    return this._question;\n  }\n\n  get labels() : QuestionSetLabel[] {\n    return (this.questionSet ? this.questionSet.labels : []);\n  }\n\n  public isMultipleChoiceQuestion() : boolean {\n    return this._currentType == QuestionType.MultipleChoice;\n  }\n\n  private saveQuestion(question) {\n    this.questionSet.addQuestion(question);\n    this.isSaving = true;\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Question saved\", this.SAVE_TIME);\n      this.isSaving = false;\n      return question;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\", this.ERROR_MESSAGE_TIME);\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveQuestion(this.question).then((question) => {\n      setTimeout(() => {\n        this.router.navigate([\"../\", this.question.id, \"edit\"], {relativeTo: this.route, replaceUrl:true});\n\t\t\t}, this.SAVE_TIME);\n    });\n\t}\n\n\tsaveAndCreateNew() {\n    this.saveQuestion(this.question).then((question) => {\n      this._question = this.getNewQuestion();\n    });\n\t}\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">New Question</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n      <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h3 class='h3-responsive text-center text-truncate'>{{question.prompt || \"Untitled\"}}</h3>\n      </div>\n      <div class=\"card-body\">\n        <form>\n          <div class=\"form-group\">\n              <label for=\"prompt\">Type:</label>\n              <select class=\"form-control browser-default\" id=\"display_type\" name=\"display_type\" name=\"display_type\"\n                [(ngModel)]=\"question.type\" (change)=\"updateType($event)\">\n                <option *ngFor=\"let type of DisplayTypes; let first=first;\" [value]=\"type.value\" [selected]=\"type.isSelected\">{{type.name}}</option>\n              </select>\n            </div>\n          <div class=\"form-group\">\n              <label for=\"prompt\">Prompt:</label>\n              <input class=\"form-control\" type=\"text\" id=\"prompt\" name=\"prompt\" [(ngModel)]=\"question.prompt\" />\n            </div>\n          <!--<div class=\"form-group\">\n                <label for=\"displayOrder\">Display Order:</label>\n            <input class=\"form-control\" type=\"number\" id=\"displayOrder\" name=\"displayOrder\" [(ngModel)]=\"ctrl.question.display_order\" />\n          </div>-->\n          <div class=\"form-group\">\n            <input class=\"form-control\" [checked]=\"question.skip_scoring\"\n              type=\"checkbox\" id=\"skipScoring\" name=\"skipScoring\" [(ngModel)]=\"question.skip_scoring\" />\n            <label for=\"skipScoring\">Do not score:</label>\n          </div>\n          <div class=\"form-group\">\n            <input class=\"form-control\" [checked]=\"question.is_reversed\"\n              type=\"checkbox\" id=\"isReversed\" name=\"isReversed\" [(ngModel)]=\"question.is_reversed\" />\n            <label for=\"isReversed\">Is Reversed:</label>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"scale\">Scale</label>\n            <select class=\"form-control browser-default\" id=\"scale\" name=\"scale\" *ngIf=\"scales?.length > 1\"\n              [(ngModel)]=\"question.assessment_scale\">\n              <option *ngFor=\"let scale of scales\" [ngValue] = \"scale\">{{scale.name}}</option>\n            </select>\n            <input class=\"form-control\" readonly *ngIf=\"scales?.length == 1\" [value]=\"scales[0].name\">\n          </div>\n          </form>\n          <input type=\"button\" [disabled]=\"isSaving\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n          <input type=\"button\" [disabled]=\"isSaving\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n          <!--<pre>\n            {{ctrl.question|json}}\n          </pre>-->\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { QuestionSetLabel } from '../../shared/models/question-set-label';\nimport { QuestionSet } from '../../shared/models/question-set';\n\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Router, ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'app-label-new',\n  templateUrl: './label-new.component.html',\n  styleUrls: ['./label-new.component.css']\n})\nexport class LabelNewComponent implements OnInit {\n\n  private _label:QuestionSetLabel;\n  private questionSet:QuestionSet;\n  private assessment:Assessment;\n  private readonly SAVE_TIME = 1500;\n  private readonly ERROR_MESSAGE_TIME = 3000;\n  public isSaving:boolean;\n\n  constructor( private assessmentService:AssessmentService\n    ,private alertService: AlertService\n    ,private location:Location\n    ,private router: Router\n    ,private route: ActivatedRoute) {\n      this.label = this.getNewObject();\n    }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.questionSet = assessment.question_sets.find((s) => s.id == setId);\n          if (!this.questionSet) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  private getNewObject() {\n    let label = new QuestionSetLabel();\n    label.id = this.assessmentService.newId();\n    return label;\n  }\n\n  get label():QuestionSetLabel {\n    return this._label;\n  }\n\n  set label(v:QuestionSetLabel) {\n    this._label = v;\n  }\n\n  goBack() {\n    this.location.back();\n  }\n\n  private saveLabel(label) {\n    this.questionSet.addLabel(label);\n    this.isSaving = true;\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Label saved\", this.SAVE_TIME);\n      this.isSaving = false;\n      return label;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\", this.ERROR_MESSAGE_TIME);\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveLabel(this.label).then((question) => {\n      setTimeout(() => {\n        this.router.navigate([\"../\", this.label.id, \"edit\"], {relativeTo: this.route, replaceUrl: true});\n\t\t\t}, this.SAVE_TIME);\n    });\n\t}\n\n\tsaveAndCreateNew() {\n    this.saveLabel(this.label).then((question) => {\n      this.label = this.getNewObject();\n    });\n\t}\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n      <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n      <h2 class=\"h2-responsive text-center\">New Label</h2>\n    </div>\n  </div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n      <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h3 class='h3-responsive text-center text-truncate'>{{label.label || \"Untitled\"}}</h3>\n      </div>\n      <form class=\"card-body\">\n        <div class=\"form-group\">\n            <label for=\"label\">Label:</label>\n            <input class=\"form-control\" type=\"text\" id=\"label\" name=\"label\" [(ngModel)]=\"label.label\" />\n          </div>\n        <!--<div class=\"form-group\">\n              <label for=\"displayOrder\">Display Order:</label>\n          <input class=\"form-control\" type=\"number\" id=\"displayOrder\" name=\"displayOrder\" [(ngModel)]=\"ctrl.label.display_order\" />\n        </div>-->\n        <div class=\"form-group\">\n          <input class=\"form-control\" type=\"checkbox\" id=\"skip-scoring\" name=\"skip-scoring\" [checked]=\"label.skipScoring\" [(ngModel)]=\"label.skipScoring\" />\n          <label for=\"skip-scoring\">Skip Scoring: (N/A questions)</label>\n        </div>\n      </form>\n      <div class=\"row\">\n        <div class=\"col\">\n          <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n          <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n        </div>\n      </div>\n\n      <!--<pre>\n        {{label|json}}\n      </pre>-->\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, Input } from '@angular/core';\nimport { ManagedClient } from 'app/shared/models/managed-client';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { AuthService } from 'app/login/services/auth.service';\nimport { User } from 'app/shared/models/user';\nimport { DacConfig } from 'app/shared/services/dac-config.service';\nimport { ClientService } from 'app/shared/services/client.service';\nimport { MessageTemplateService } from 'app/admin/services/message-template.service';\n\n@Component({\n  selector: 'dac-client-send-invitation',\n  templateUrl: './client-send-invitation.component.html',\n  styleUrls: ['./client-send-invitation.component.scss']\n})\nexport class ClientSendInvitationComponent implements OnInit {\n\n  @Input() client:ManagedClient;\n  private user:User;\n  public confirmEmail:boolean;\n  public toEmailAddress:string;\n  public emailSubject:string;\n  public emailMessage:string;\n  public fromEmailAddress:string;\n  public replyToEmailAddress:string;\n  public testEmailAddress:string;\n\n  constructor(private alertService:AlertService, private authService:AuthService,\n    private dacConfig:DacConfig, private clientService:ClientService, private messageTemplateService:MessageTemplateService) {\n\n      this.emailSubject = \"Loading...\";\n      this.emailMessage = \"Loading...\";\n\n\n    // let originalSubject =  \"Discover and Change - Assessment Portal Information\";\n    // this.emailSubject = originalSubject;\n    // this.authService.getCurrentUser().then(user => {\n    //   this.user = user;\n    //   if (this.emailSubject == originalSubject && this.user.companyName) {\n    //     this.emailSubject = \"Assessment Portal Information - \" + this.user.companyName;\n    //   }\n\n    //   this.setupEmailMessage();\n    // });\n    this.confirmEmail = false;\n  }\n\n  ngOnInit() {\n    if (!this.client) {\n      this.failMessageTemplateLoad(new Error(\"No client set for this invitation\"));\n    }\n    this.toEmailAddress = this.client.email;\n\n    this.messageTemplateService.getMessageForClient(this.client).then(msgTemplate => {\n      if (msgTemplate.subject) {\n        this.emailSubject = msgTemplate.subject;\n      } else {\n        this.emailSubject = \"\";\n      }\n\n      if (msgTemplate.message) {\n        this.emailMessage = msgTemplate.message;\n      } else {\n        this.emailMessage = \"\";\n      }\n\n      if (msgTemplate.replyTo) {\n        this.replyToEmailAddress = msgTemplate.replyTo;\n      }\n\n      if (msgTemplate.testEmail) {\n        this.testEmailAddress = msgTemplate.testEmail;\n      }\n      if (msgTemplate.to) {\n        this.toEmailAddress = msgTemplate.to;\n      }\n      if (msgTemplate.from) {\n        this.fromEmailAddress = msgTemplate.from;\n      }\n    })\n    .catch(error => {\n      this.failMessageTemplateLoad(error);\n    });\n  }\n\n  private failMessageTemplateLoad(error) {\n    console.error(error);\n      this.alertService.error(\"We failed to retrieve the email template from the server.  Check your internet connection and try to refresh the page.\");\n      this.emailMessage = \"Server Error - Failed to load\";\n      this.emailSubject = \"Server Error - Failed to load\";\n  }\n\n  public get supportEmail() {\n    return this.dacConfig.supportEmail;\n  }\n\n  public get sender() {\n    return this.user ? this.user.username : this.dacConfig.supportEmail;\n  }\n\n//   private setupEmailMessage() {\n//     let message = `Hi ${this.client.getDisplayString()},\n\n// I've created a unique code for you to use to take your assessments.\n// The identifier you'll use to login is: ${this.client.customField1}\n\n// You can take your assessments here: ${this.siteURL}`;\n//     this.emailMessage = message;\n//   }\n\n  get companyName() {\n    if (this.user) {\n      return this.user.companyName;\n    }\n    return \"\";\n  }\n\n  get userEmail() {\n    if (this.user) {\n      return this.user.username;\n    }\n    return \"\";\n  }\n\n  get siteURL() {\n    return this.dacConfig.take_test_url;\n  }\n\n  sendEmail() : void {\n    this.confirmEmail = true;\n  }\n\n  confirmEmailSend() : void {\n    this.sendEmailToServer(false);\n  }\n\n  sendTestEmail() : void {\n    this.sendEmailToServer(true);\n  }\n\n  private sendEmailToServer(isTest:boolean) {\n    // if (!this.emailSubject || !this.emailSubject.trim()) {\n    //   this.alertService.error(\"Email subject must not be empty\");\n    // }\n    if (!this.emailMessage || !this.emailMessage.trim()) {\n      this.alertService.error(\"Email message must not be empty\");\n    }\n\n    this.clientService.sendClientEmail(this.client.id, this.emailSubject, this.emailMessage, isTest)\n    .then(() => {\n      this.alertService.success(\"Email sent!\");\n      this.confirmEmail = false;\n    })\n    .catch(() => {\n      this.alertService.error(\"The email failed to send. Check your connection and try again.  Or contact support\");\n    })\n  }\n\n  copyText() : void {\n    try {\n      var copyTextarea = document.getElementById('clientEmailTemplate') as HTMLInputElement;\n      copyTextarea.select();\n      var successful = document.execCommand('copy');\n      var msg = successful ? 'successful' : 'unsuccessful';\n      this.alertService.success(\"Message Copied To Clipboard!\");\n    } catch (err) {\n      this.alertService.error(\"Uh Oh! Looks like your browser doesn't support this feature.  Highlight the text and press Ctrl+C or CMD+C\", 5000);\n    }\n  }\n\n}\n","<div class=\"row m-0\">\n  <label class=\"col-md-1 col-6\">\n    To:\n  </label>\n  <div class=\"col-md-11 col-6\">\n    <b>{{toEmailAddress}}</b>\n  </div>\n</div>\n<div class=\"row m-0\">\n  <label class=\"col-md-1 col-6\">\n    From:\n  </label>\n  <div class=\"col-md-11 col-6\">\n    <b>{{fromEmailAddress}}</b>\n  </div>\n</div>\n<div class=\"row m-0\">\n  <label class=\"col-md-1 col-6\">\n    Reply-To:\n  </label>\n  <div class=\"col-md-11 col-6\">\n    <b>{{replyToEmailAddress}}</b>\n  </div>\n</div>\n<!-- <div class=\"row m-0\">\n  <label class=\"col-md-1 col-6\">\n    Subject\n  </label>\n  <div class=\"col-md-11 col-6\">\n    <input type=\"text\" value=\"Subject...\" [(ngModel)]=\"emailSubject\" class=\"form-control\" />\n  </div>\n</div> -->\n<div class=\"row ml-0 mr-0 mt-2\">\n  <div class=\"col-md-1 col-6\">\n    <label>\n      Message\n    </label>\n\n  </div>\n  <div class=\"col-md-11 col-6\">\n    <textarea id=\"clientEmailTemplate\" contenteditable=\"true\" [(ngModel)]=\"emailMessage\" class=\"form-control h-100\" rows=\"10\"></textarea>\n  </div>\n</div>\n<div class=\"row ml-0 mr-0 mt-2\" *ngIf=\"!confirmEmail\">\n  <div class=\"offset-md-1 offset-6 col-md-11 col-6\">\n    <input class=\"btn btn-secondary btn-sm\" type=\"button\" value=\"Copy To Clipboard\" (click)=\"copyText()\" />\n  </div>\n</div>\n<div class=\"row ml-0 mr-0 mt-2\" *ngIf=\"!confirmEmail && testEmailAddress\">\n  <div class=\"offset-md-1 offset-6 col-md-11 col-6\">\n    <input class=\"btn btn-secondary btn\" type=\"button\" value=\"Send Test Email\" (click)=\"sendTestEmail()\" />\n    <span class=\"alert alert-info\">\n      A test email will be sent to your email account at <b>{{testEmailAddress}}</b>\n    </span>\n  </div>\n</div>\n\n<div class=\"row m-0\" *ngIf=\"!confirmEmail\">\n  <div class=\"col text-right\">\n    <input class=\"btn btn-primary\" type=\"button\" value=\"Send Email\" (click)=\"sendEmail()\" [disabled]=\"!client.email\" />\n  </div>\n</div>\n<div class=\"row ml-0 mr-0 mt-2 text-center\" *ngIf=\"confirmEmail\">\n  <div class=\"col-12\">\n    <p >\n      <i>I confirm that I have reviewed the email message and taken appropriate safeguards to limit the amount and type of information I am disclosing\n      through unencrypted e-email.  I confirm that I have verified the email address of my patient that it is correct and valid and that my patient\n      has agreed to receive this communication via unencrypted e-mail.</i>\n    </p >\n  </div>\n  <div class=\"col-12 justify-content-center\">\n    <input type=\"button\" value=\"Cancel\" class=\"btn btn-secondary\" (click)=\"confirmEmail = false\" />\n    <input type=\"button\" value=\"Confirm and Send Email\" class=\"btn btn-primary\" (click)=\"confirmEmailSend()\" />\n  </div>\n</div>\n<div class=\"row m-0\" *ngIf=\"!client.email\">\n  <p class=\"col alert alert-danger\">\n    You must assign an email address to this client in order to send an email.\n  </p>\n</div>\n<div class=\"row m-0\">\n  <div class=\"alert alert-warning\">\n    <p>Note that the HIPAA Privacy Rule does not prohibit the use of unecrypted e-mail for treatment-related communications\n    between health care providers and patients.  However, <b>other safeguards should be applied to reasonably protect privacy,\n    such as limiting the amount or type of information disclosed through the unencrypted e-mail.</b></p>\n    <p>\n    You can read more here about this from HHS <i><a href=\"https://www.hhs.gov/hipaa/for-professionals/faq/570/does-hipaa-permit-health-care-providers-to-use-email-to-discuss-health-issues-with-patients/index.html\">Does the HIPAA Privacy Rule permit health care providers to use e-mail to discuss health issues and treatment with their patients?</a></i>\n    </p>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport {ShoppingService} from \"../../shared/services/shopping.service\";\nimport {Item} from '../models/item';\nimport { AlertService } from 'app/shared/services/alert.service';\n\n@Component({\n  selector: 'shop-items',\n  templateUrl: './shop-items.component.html',\n  styleUrls: ['./shop-items.component.css']\n})\nexport class ShopItemsComponent implements OnInit {\n\n  private _items:Item[];\n  private _groupItems:Item[];\n  private _hasLoadedShop:boolean;\n\n  constructor(\n    private shopping:ShoppingService\n    ,private alertService: AlertService\n    ,private router:Router\n    ,private route:ActivatedRoute\n  ) {\n    this._hasLoadedShop = false;\n  }\n\n  ngOnInit() {\n    this.shopping.getAvailableItems().then((items) => {\n      this._groupItems = items.filter((i) => i.subItems && i.subItems.length);\n      this._items = items.filter((i) => !(i.subItems && i.subItems.length));\n      this._hasLoadedShop = true;\n    });\n  }\n\n  get hasLoadedShop() {\n    return this._hasLoadedShop;\n  }\n\n  addItemsToCart() {\n    let totalitems = this.getItemsForCheckout();\n    // return a resolved promise since there's nothing to do here.\n    if (!totalitems.length) {\n      return Promise.resolve();\n    }\n\n    let totalQuantity = totalitems.map(i => i.quantity).reduce((pv, cv) => pv+cv, 0);\n    this.addItems(totalitems)\n    .then(() => {\n      let message = totalQuantity + \" items were added to your cart\";\n      this.alertService.success(message);\n    })\n    .catch((error) => {\n      console.error(error);\n      this.alertService.error(\"There was a problem in adding the items you selected to the cart.  Please try again.\");\n    });\n  }\n\n  checkout() {\n    let items = this.getItemsForCheckout();\n    if (!(items.length || this.hasItems)) {\n      this.alertService.error(\"Please select the number of items you wish to purchase before checking out.\");\n      return;\n    }\n\n    this.addItems(items)\n    .then(() => {\n      return this.router.navigate([\"checkout\"], {relativeTo: this.route});\n    })\n    .catch((error) => {\n      console.error(error);\n      this.alertService.error(\"There was a problem in checking out your items, please try again or contact customer support.\");\n    });\n  }\n\n  private addItems(items:Item[]) {\n    return Promise.all(items.map(i => this.shopping.addItemToCart(i)))\n    .then((results) => {\n      items.forEach(i => i.quantity = 0);\n    });\n  }\n\n\n  private getItemsForCheckout() {\n    let groupItems = this._groupItems.filter(gi => gi.quantity > 0);\n    let items = this._items.filter(i => i.quantity > 0);\n    let totalItems = groupItems.concat(items);\n    return totalItems;\n  }\n\n  get hasItems() {\n    return this.shopping.hasItems;\n  }\n\n  get groupItems() {\n    return this._groupItems;\n  }\n\n  get items() {\n    return this._items;\n  }\n\n}\n","<div class=\"row\" *ngIf=\"!hasLoadedShop\">\n  <div class=\"col-12\">\n    <p class=\"alert alert-warning\">\n      <app-spin-icon></app-spin-icon> Loading Shop...</p>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoadedShop\">\n  <div class=\"col-12\">\n    <div class=\"row mb-3\">\n      <h1 class=\"col-8 h1-responsive m-0\">Shop</h1>\n      <hr />\n    </div>\n    <div class=\"row\">\n      <div class=\"card card-cascade wider col mb-5\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h3 class='h3-responsive text-center text-truncate'>Package Deals</h3>\n        </div>\n        <div class=\"card-body\">\n          <table class=\"table table-striped\">\n            <thead class=\"secondary-color text-light\">\n              <tr>\n                <th w=\"50\">Package</th>\n                <th>Price</th>\n                <th w=\"25\">Quantity</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"items-list\" *ngFor=\"let item of groupItems\">\n                <td>\n                  {{item.name}}\n                  <ul *ngIf=\"item.subItems?.length\">\n                    <li *ngFor=\"let subItem of item.subItems\">{{subItem.name}}</li>\n                  </ul>\n                </td>\n                <td>${{item.price}}</td>\n                <td>\n                  <select class=\"form-control browser-default\" [(ngModel)]=\"item.quantity\">\n                    <option *ngFor=\"let item of [0, 1,2,3,4,5,10,15,20,25,50]\">{{item}}</option>\n                  </select>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"card card-cascade wider col\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n          <h3 class='h3-responsive text-center text-truncate'>Individual Assessments</h3>\n        </div>\n        <div class=\"card-body\">\n          <table class=\"table table-striped\">\n            <thead class=\"secondary-color text-light\">\n              <tr>\n                <th w=\"50\">Assessment</th>\n                <th>Price</th>\n                <th w=\"25\">Quantity</th>\n              </tr>\n            </thead>\n            <tbody>\n                <tr *ngFor=\"let item of items\">\n                    <td>{{item.name}}\n                      <ul *ngIf=\"item.subItems?.length\">\n                        <li *ngFor=\"let subItem of item.subItems\">{{subItem.name}}</li>\n                      </ul>\n                    </td>\n                    <td>${{item.price}}</td>\n                    <td><select class=\"form-control browser-default\" [(ngModel)]=\"item.quantity\">\n                        <option *ngFor=\"let item of [0, 1,2,3,4,5,10,15,20,25,50]\">{{item}}</option>\n                      </select>\n                    </td>\n                  </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n    <div class=\"row w-100 shoppingActionBar border bg-light\">\n      <cart-widget class=\"col-sm-5 col-md-6\"></cart-widget>\n      <div class=\"col-sm-7 col-md-6\">\n        <input type=\"button\" class=\"btn btn-secondary\" value=\"Add to Cart\" (click)=\"addItemsToCart()\" />\n        <input type=\"button\" class=\"btn btn-primary\" value=\"Checkout\" (click)=\"checkout()\" />\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { ErrorCode } from \"./ErrorCodes\";\n\nexport class SystemError extends Error {\n    private _code:ErrorCode;\n    private _subErrors:SystemError[];\n\n    constructor(code:ErrorCode, message:string, subErrors?:SystemError[]) {\n\t\tsuper(message)\n        this.code = code;\n        this.message = message;\n        this.subErrors = subErrors;\n    }\n\n\n\tpublic get code(): ErrorCode {\n\t\treturn this._code;\n\t}\n\n\tpublic set code(value: ErrorCode) {\n\t\tthis._code = value;\n\t}\n\n\tpublic get subErrors(): SystemError[] {\n\t\treturn this._subErrors;\n\t}\n\n\tpublic set subErrors(value: SystemError[]) {\n\t\tthis._subErrors = value;\n\t}\n\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport {Assessment} from \"../../shared/models/assessment\";\nimport {Scale} from \"../../shared/models/scale\";\nimport {ScaleRange} from \"../../shared/models/scale-range\";\nimport {SaveMessages} from \"../../shared/models/save-messages\";\nimport {AssessmentService} from \"../../shared/services/assessment.service\";\n\nclass ScaleAvailableDisplay extends Scale {\n  public available: boolean;\n}\n\n@Component({\n  selector: 'app-scale-edit',\n  templateUrl: './scale-edit.component.html',\n  styleUrls: ['./scale-edit.component.css']\n})\nexport class ScaleEditComponent implements OnInit {\n\n  private _scale:Scale;\n  private _messages:SaveMessages;\n  private _assessment:Assessment;\n  private _hasLoaded:boolean;\n\n  constructor(private _assessmentService:AssessmentService\n   ,private route:ActivatedRoute\n   ,private alertService:AlertService\n    ,private router:Router) {\n    this._scale = new Scale();\n    this._scale.id = this._assessmentService.newId();\n    this._hasLoaded = false;\n  }\n\n\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let scaleId = params['scaleId'];\n      this._assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this._assessment = assessment;\n          this._scale = assessment.scales.find((s) => s.id == scaleId);\n          this._hasLoaded = true;\n          if (!this._scale) {\n            this.router.navigate(['/not-found']);\n          }\n        })\n        .catch((error) => {\n          this.alertService.error(\"There was an error loading the scale data. Check your internet connection and refresh the page.\");\n          console.error(error);\n        })\n    });\n  }\n\n  get hasLoaded() {\n    return this._hasLoaded;\n  }\n\n  get scale() {\n    return this._scale;\n  }\n\n  set scale(v:Scale) {\n    this._scale = v;\n  }\n\n  get AvailableSubScales() :ScaleAvailableDisplay[] {\n\n      let subScaleDisplayList = [];\n      let availableScales = this._scale.getAvailableSubScales(this._assessment.scales);\n      availableScales.forEach((available, scale) => {\n        let subScaleDisplay = Object.assign(new ScaleAvailableDisplay(), scale);\n        subScaleDisplay.available = available;\n        subScaleDisplayList.push(subScaleDisplay);\n      });\n      return subScaleDisplayList;\n  }\n\n  get ScaleTypes() {\n    return [\"Sum\",\"CriteriaThreshold\", \"Mean\"]\n  }\n\n  toggleSubScale(scale:Scale) {\n    if (this._scale.hasSubScale(scale)) {\n      this._scale.removeSubScale(scale);\n    }\n    else {\n      this._scale.addSubScale(scale);\n    }\n  }\n\n  isSelected(subScale:Scale) {\n    return this._scale.hasSubScale(subScale);\n  }\n\n  updateType(type:\"Sum\"|\"CriteriaThreshold\") {\n    this._scale.type = type;\n    if (type == \"Sum\") {\n      this.scale.gradingData = {requiredQuestion:0,requiredScoreThreshold:0};\n    }\n  }\n\n  save() {\n\n\t\tthis._assessmentService.saveAssessment(this._assessment).then(() => {\n      this.alertService.success(\"Scale Saved!\");\n    }).catch((error) => {\n      this.alertService.error(\"Error occurred in saving. Please try again.\");\n      console.error(error);\n\t\t});\n\t}\n\n\tsaveAndCreateNew() {\n\t\tthis._assessmentService.saveAssessment(this._assessment).then((assessment) => {\n\t\t\t\tthis._messages.saveSuccess = true;\n        setTimeout(() => {\n          // we replace the url so we our back button can handle saving properly.\n          this.router.navigate([\"../../\", \"new\"], {relativeTo: this.route, replaceUrl: true});\n        })\n    })\n    .catch((error) => {\n      console.log(error);\n      this.alertService.error(\"Error occurred in saving. Please try again.\");\n\t\t});\n\t}\n\n  deleteRange(range:ScaleRange) {\n\t\tif (!confirm(\"Are you sure you want to delete this range?\")) {\n\t\t\treturn;\n\t\t}\n\t\tthis.scale.removeRange(range);\n\t\tthis._assessmentService.saveAssessment(this._assessment).then(() => {\n      this.alertService.success(\"Range Deleted!\");\n    })\n\t\t.catch((error) => {\n      console.log(error);\n      this.alertService.success(\"Error occurred in deleting. Please try again.!\");\n\t\t})\n\t}\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">{{scale.name}}</h2>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoaded\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"General\">\n      <form *ngIf=\"scale\">\n        <div class=\"form-group\">\n          <label for=\"name\">Name:</label>\n          <input class=\"form-control\" type=\"text\" id=\"name\" name=\"name\" [(ngModel)]=\"scale.name\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"name\">Client Description:</label>\n          <input class=\"form-control\" type=\"text\" id=\"descriptionClient\" name=\"descriptionClient\" [(ngModel)]=\"scale.descriptionClient\"\n          />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"name\">Therapist Description:</label>\n          <input class=\"form-control\" type=\"text\" id=\"descriptionTherapist\" name=\"descriptionTherapist\" [(ngModel)]=\"scale.descriptionTherapist\"\n          />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"multiplier\">Multiplier:</label>\n          <input class=\"form-control\" type=\"number\" id=\"multiplier\" name=\"multiplier\" [(ngModel)]=\"scale.multiplier\" />\n        </div>\n        <div class=\"form-group\">\n          <input class=\"form-control\" type=\"checkbox\" id=\"negToPositive\" name=\"negToPositive\" [(ngModel)]=\"scale.negativeToPositiveRanges\"\n          />\n          <label for=\"negToPositive\">Negative to Positive Ranges:</label>\n        </div>\n        <div class=\"form-group\">\n            <input class=\"form-control\" type=\"checkbox\" id=\"includeInReports\" name=\"includeInReports\" [(ngModel)]=\"scale.includeInReports\"\n            />\n            <label for=\"includeInReports\">Include in reports:</label>\n        </div>\n        <div class=\"form-group\" *ngIf=\"scale.hasSubScales()\">\n            <input class=\"form-control\" type=\"checkbox\" id=\"rollUpSubScales\" name=\"rollUpSubScales\" [(ngModel)]=\"scale.rollUpSubScales\" />\n            <label for=\"rollUpSubScales\">Rollup subscale questions into this scale:</label>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"type\">Type</label>\n          <select id=\"scale\" class=\"browser-default form-control\" name=\"type\" [ngModel]=\"scale.type\" (ngModelChange)=\"updateType($event)\">\n            <option *ngFor=\"let type of ScaleTypes\" [ngValue]=\"type\">{{type}}</option>\n          </select>\n          {{scale.type}}\n        </div>\n        <div class=\"form-group\" *ngIf=\"scale.type == 'CriteriaThreshold'\">\n            <label for=\"type\">Threshold Required Number of Questions</label>\n            <input class=\"form-control\" type=\"number\" id=\"requiredQuestions\" name=\"requiredQuestions\" [(ngModel)]=\"scale.gradingData.requiredQuestions\" />\n        </div>\n        <div class=\"form-group\" *ngIf=\"scale.type == 'CriteriaThreshold'\">\n            <label for=\"type\">Threshold Criteria Score of Questions</label>\n            <input class=\"form-control\" type=\"number\" id=\"requiredScoreThreshold\" name=\"requiredScoreThreshold\" [(ngModel)]=\"scale.gradingData.requiredScoreThreshold\" />\n        </div>\n        <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n      </form>\n    </dac-tab>\n    <dac-tab heading=\"Ranges\">\n      <h2>Scale Ranges</h2>\n      <a [routerLink]=\"['scale-range','new']\" type=\"button\" class=\"btn btn-primary\">New Range</a>\n      <p class=\"alert alert-info\" *ngIf=\"!scale.ranges.length\">No Ranges exist.</p>\n      <table class=\"table table-striped\" *ngIf=\"scale.ranges.length\">\n        <thead>\n          <tr>\n            <th *ngFor=\"let name of ['Display Name', 'Range', 'Therapist Content', 'Client Content', 'Actions']\">{{name}}</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let range of scale.ranges\">\n            <td>{{range.displayName}}</td>\n            <td>{{range.rangeStart}} - {{range.rangeEnd}}</td>\n            <td class=\"w-25\">\n              <div [innerHTML]=\"range.therapistContent\"></div>\n            </td>\n            <td class=\"w-25\">\n              <div [innerHTML]=\"range.clientContent\"></div>\n            </td>\n            <td class=\"w-25\">\n              <button [routerLink]=\"['scale-range',range.id, 'edit']\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Edit\">\n                <span class=\"fa fa-edit\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"deleteRange(range)\" type=\"button\" class=\"btn btn-secondary btn-sm\" aria-label=\"Delete\">\n                <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </dac-tab>\n    <dac-tab heading=\"Sub Scales\">\n      <h2>Sub Scales</h2>\n      <form>\n        <div class=\"form-group\">\n          <h2 class=\"h2-responsive\">Possible Subscales</h2>\n          <div *ngFor=\"let subscale of AvailableSubScales\">\n            <input [id]=\"subscale.id\" class=\"form-control\" type=\"checkbox\" (click)=\"toggleSubScale(subscale)\" [checked]=\"isSelected(subscale)\"\n              [disabled]=\"!subscale.available\" />\n            <label [for]=\"subscale.id\" (click)=\"toggleSubScale(subscale)\">{{subscale.name}}</label>\n          </div>\n        </div>\n        <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n      </form>\n    </dac-tab>\n  </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { OrderService } from '../../shared/services/order.service';\nimport { Order } from '../../shared/models/order';\n\n@Component({\n  selector: 'dac-order-history',\n  templateUrl: './order-history.component.html',\n  styleUrls: ['./order-history.component.css']\n})\nexport class OrderHistoryComponent implements OnInit {\n\n  private _orders:Order[];\n  private _isLoaded:boolean;\n\n  constructor(\n    private orderService:OrderService\n  ) {\n    this._orders = [];\n    this._isLoaded = false;\n  }\n\n  ngOnInit() {\n    this.orderService.getOrderHistory().then(orders => {\n      this._orders = orders;\n      this._isLoaded = true;\n    })\n    .catch(error => {\n      console.error(error);\n    })\n  }\n\n  hasMoreResults() {\n    return this.orderService.hasMoreResults();\n  }\n\n  loadMore() {\n    this.orderService.loadMore().then(orders => this._orders = orders);\n  }\n\n  get isLoaded() {\n    return this._isLoaded;\n  }\n\n  get hasOrders() {\n    return this._orders && this._orders.length;\n  }\n\n  get orders() {\n    return this._orders;\n  }\n\n}\n","<div *ngIf=\"isLoaded && !hasOrders\" class=\"row\">\n    <div class=\"col\">\n        <p class=\"alert alert-info\">No payments currently exist. When you make a payment your payment history will show up here</p>\n    </div>\n</div>\n\n<table *ngIf=\"hasOrders\" class=\"table-striped table\">\n    <thead class=\"secondary-color text-light\">\n        <tr>\n            <td>Id</td>\n            <td>Amount</td>\n            <td>Status</td>\n            <td>Date</td>\n            <td>Last Update Date</td>\n            <td># Items</td>\n            <td>View</td>\n        </tr>\n    </thead>\n    <tbody>\n        <tr *ngFor=\"let order of orders\">\n            <td>{{order.id}}</td>\n            <td>${{order.total| number:'1.2-2'}}</td>\n            <td>{{order.status}}</td>\n            <td>{{order?.creation_date| date:'short'}}</td>\n            <td>{{order?.last_update_date| date:'short'}}</td>\n            <td>{{order.orderItems?.length}}</td>\n            <td>\n                <a class=\"btn btn-primary btn-sm\" [routerLink]=\"['/admin','my-account','order',order.id]\">\n                    <i class=\"fa fa-eye\"></i>\n                </a>\n            </td>\n        </tr>\n    </tbody>\n</table>\n<input class=\"btn btn-primary\" type=\"button\" (click)=\"loadMore()\"\n*ngIf=\"hasMoreResults()\"\nvalue=\"Load More\" />\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport {UserService } from \"../../shared/services/user.service\";\nimport { User } from \"../../shared/models/user\";\nimport { Role } from 'app/shared/models/role';\n\n@Component({\n  selector: 'app-user-list',\n  templateUrl: './user-list.component.html',\n  styleUrls: ['./user-list.component.css']\n})\nexport class UserListComponent implements OnInit {\n\n  private _users:User[];\n  private singleAdmin:boolean;\n  public showArchivedUsers:boolean;\n\n  constructor(private userService:UserService) {\n    this._users = [];\n    this.showArchivedUsers = false;\n  }\n\n  ngOnInit() {\n\n    this.userService.getUsers().then((users) => {\n      let adminUserId = 0;\n\n      users.forEach(u => {\n        if (u.role == Role.Admin) {\n          if (adminUserId === 0) {\n            adminUserId = u.id;\n            this.singleAdmin = true;\n          }\n          else {\n            this.singleAdmin = false;\n          }\n        }\n      });\n      this._users = users\n    });\n  }\n\n  public restoreUser(user:User) {\n    this.userService.restoreUser(user);\n  }\n\n  public archiveUser(user:User) {\n    if (confirm(\"Are you sure you want to archive this user?\")) {\n      this.userService.archiveUser(user);\n    }\n  }\n\n  public get Users() {\n    return this._users.filter(u => {\n      if (this.showArchivedUsers) {\n        return !u.enabled;\n      } else {\n        return u.enabled;\n      }\n    });\n  }\n\n  toggleArchivedUsers() {\n    this.showArchivedUsers = !this.showArchivedUsers;\n  }\n\n  doSearch(search:string) {\n\n  }\n\n  resetSearch() {\n\n  }\n\n  canDeleteUser(user:User) {\n    if (this.singleAdmin && user.role == Role.Admin) {\n      return false;\n    }\n    else if (user.role == Role.SuperUser) {\n      return false;\n    } else if (user.role == Role.Owner) {\n      return false;\n    }\n    return true;\n  }\n}\n","<div class=\"col-12\">\n    <h1 class=\"h1-responsive\">Users List  <input type=\"button\" class=\"btn btn-primary\"\n            [routerLink]=\"['new']\"\n            value=\"Add User\" /></h1>\n            <input class=\"form-control\" id=\"showArchivedUsers\" type=\"checkbox\"\n            (click)=\"toggleArchivedUsers()\" [checked]=\"showArchivedUsers\"/> <label for=\"showArchivedUsers\">Show Archived Users</label>\n    <!-- <search-input (search)=\"doSearch($event)\" (reset)=\"resetSearch()\" class=\"mb-3\"></search-input> -->\n    <table class=\"table table-striped\">\n        <thead class=\"primary-color text-white\">\n            <tr>\n                <th>Username</th>\n                <th>First Name</th>\n                <th>Last Name</th>\n                <th *ngIf=\"showArchivedUsers\">Archived</th>\n                <th>Role</th>\n                <th>Actions</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let user of Users\">\n                <td>{{user.username}}</td>\n                <td>{{user.firstName}}</td>\n                <td>{{user.lastName}}</td>\n                <td *ngIf=\"showArchivedUsers\"><span *ngIf=\"!user.enabled\">Archived</span></td>\n                <td>{{user.roleName}}</td>\n                <td>\n                    <button aria-label=\"Edit\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" [routerLink]=\"[user.id, 'edit']\">\n                        <span aria-hidden=\"true\" class=\"fa fa-edit\"></span>\n                    </button>\n                    <button *ngIf=\"user.enabled\" aria-label=\"Archive User\" title=\"Archive User\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" (click)=\"archiveUser(user)\" [disabled]=\"!canDeleteUser(user)\">\n                        <span aria-hidden=\"true\" class=\"fa fa-archive\"></span>\n                    </button>\n                    <button *ngIf=\"!user.enabled\" aria-label=\"Restore User\" title=\"Restore User\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" (click)=\"restoreUser(user)\">\n                        <span aria-hidden=\"true\" class=\"fa fa-undo\"></span>\n                    </button>\n                </td>\n\n            </tr>\n        </tbody>\n    </table>\n</div>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { FhirClientComponent } from \"app/debug/fhir-client/fhir-client.component\";\nimport { Assignment } from \"app/shared/models/Assignment\";\nimport { ManagedClient } from \"app/shared/models/managed-client\";\nimport { ClientService } from \"app/shared/services/client.service\";\nimport { FhirService } from \"app/shared/services/fhir-service\";\n\n/*\n *   Copyright (c) 2023 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\n@Component(\n  {\n    templateUrl: './client-appointment-assignment-edit.component.html',\n    selector: 'dac-client-appointment-assignment-edit'\n  }\n)\nexport class ClientAppointmentAssignmentEdit implements OnInit {\n  public client:ManagedClient;\n  public appointment:any;\n  public assignments:Assignment[];\n\n  constructor(private fhirClient:FhirService, private clientService:ClientService\n    , private route:ActivatedRoute) {\n\n  }\n  ngOnInit(): void {\n    let clientId = this.route.snapshot.params['id'];\n    let clientPromise = this.clientService.getClient(clientId)\n    let fhirClientPromise = this.fhirClient.getFhirClient();\n    Promise.all([clientPromise, fhirClientPromise])\n    .then(results => {\n      this.client = results[0];\n      let fhirClient = results[1];\n      let appt = this.fhirClient.getFhirContextFromClient(fhirClient, 'Appointment');\n      if (appt && appt.reference && appt.reference.indexOf(\"/\") !== false) {\n        let parts = appt.reference.split(\"/\");\n        let id = parts[1];\n        this.appointment = id;\n        this.assignments = this.client.assignments.filter(a => a.AppointmentId == id);\n      }\n    });\n  }\n\n}\n","<!-- <ul>\n  <li *ngFor=\"let item in assignments\">{{item.Name}}</li>\n</ul> -->\n<p class=\"alert alert-info\" *ngIf=\"!client\">Loading...</p>\n<dac-client-manage-assignments *ngIf=\"client\" [client]=\"client\" [appointment]=\"appointment\"></dac-client-manage-assignments>\n<!-- Add Homework\n\nAdd Profile\n\nAdd AssessmentGroup -->\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { AssessmentGroup } from \"app/shared/models/assessment-group\";\nimport { AssessmentTokenService } from \"app/shared/services/assessment-token.service\";\nimport { AlertService } from \"app/shared/services/alert.service\";\nimport { ClientService } from \"app/shared/services/client.service\";\nimport { ManagedClient } from \"app/shared/models/managed-client\";\nimport { Assignment } from \"app/shared/models/Assignment\";\nimport { Assessment } from \"app/shared/models/assessment\";\nimport { AssignedAssessment } from \"app/shared/models/AssignedAssessment\";\nimport { Injectable } from \"@angular/core\";\nimport { AssignmentService } from \"app/shared/services/assignment.service\";\nimport { AssignedAssessmentGroup } from \"app/shared/models/AssignedAssessmentGroup\";\nimport { AssignmentSingle } from \"app/shared/models/AssignmentSingle\";\n\n/**\n * The responsibility of this class is to take assessment batteries &\n * individual assessments and assign them to clients.\n */\n@Injectable()\nexport class AssessmentAssignerService {\n\n    constructor(private assessmentTokenService:AssessmentTokenService\n      , private alertService:AlertService, private clientService:ClientService\n      , private assignmentService:AssignmentService)\n    {\n\n    }\n    public async addAssessmentsFromBattery(client:ManagedClient, group:AssessmentGroup, assignmentId?:string) : Promise<Assignment> {\n        if (!group) {\n          console.error(\"group was null.  Cannot add\");\n          throw new Error(\"There was an error in adding this item to the client.  Please try again or contact customer support\");\n        }\n\n        // add each of the group assignments.\n        // TODO: should we do a promise.All here?? so we can trigger a message\n        // when all of the assessments have been added?\n        if (this.assessmentTokenService.isTokensEnabled()\n            && this.assessmentTokenService.getGroupRemainingTokens(group) <= 0) {\n          throw new Error(\"You have no available tokens for this battery. Purchase more to assign this battery\");\n          return;\n        }\n        try {\n          let assignment:Assignment = await this.assignmentService.createClientGroupAssignment(client, group, assignmentId);\n          this.consumeTokens(assignment);\n          client.assignments.push(assignment);\n          this.clientService.syncLocalClient(client);\n          return assignment;\n        }\n        catch(error) {\n          console.error(error);\n          throw new Error(\"There was an error in adding this item to the client.  Please try again or contact customer support\");\n        }\n    }\n\n    public addAssessment(client:ManagedClient, assessment: Assessment, appointmentId?:string) {\n        console.log(\"adding \", assessment);\n        if (!assessment) {\n          console.error(\"assessment was null.  Cannot add\");\n          return;\n        }\n\n        if (this.assessmentTokenService.isTokensEnabled()\n            && !this.assessmentTokenService.hasTokens(assessment)) {\n          this.alertService.error( \"You have no available tokens for this assessment.  Purchase more to assign this test\", 3000);\n          return;\n        }\n        // TODO: stephen this needs to be switched to be the\n        // assessments.\n        let assignment = new AssignmentSingle();\n        assignment.Type = \"Assessment\";\n        assignment.DateAssigned = new Date();\n        assignment.AppointmentId = appointmentId || null;\n        let assignmentItem = new AssignedAssessment();\n        assignmentItem.Name = assessment.name;\n        assignmentItem.Type = \"Assessment\";\n        assignmentItem.Uid = assessment.uid;\n        assignment.Items.push(assignmentItem);\n\n        let alertId = this.alertService.info(\"Adding \" + assessment.name + \" to \" + client.id, 120000);\n        return this.assignmentService.saveClientAssignment(client, assignment)\n          .then((assignment:Assignment) => {\n            this.consumeTokens(assignment);\n            client.assignments.push(assignment);\n            this.clientService.syncLocalClient(client);\n            this.clearAlert(alertId, 750);\n            this.alertService.success(\"Added \" + assessment.name + \" to \" + client.id);\n          })\n          .catch((error) => {\n            this.clearAlert(alertId);\n            this.alertService.error(\"There was an error in adding this item to the client.  Please try again or contact customer support\");\n            console.error(error);\n          });\n    }\n\n    private consumeTokens(assignment:Assignment) {\n      let method = this.assessmentTokenService.consumeToken.bind(this.assessmentTokenService);\n      return this.applyAssignmentMethod(assignment, method);\n    }\n\n    private freeTokens(assignment:Assignment) {\n      let method = this.assessmentTokenService.freeToken.bind(this.assessmentTokenService);\n      return this.applyAssignmentMethod(assignment, method);\n    }\n    private applyAssignmentMethod(assignment:Assignment, method:(uid:string) => void) {\n      if (this.assessmentTokenService.isTokensEnabled()) {\n        if (assignment.Type == \"Assessment\" && assignment.Items.length) {\n          let item = assignment.Items[0] as AssignedAssessment;\n          method(item.Uid);\n        } else if (assignment.Type == \"AssessmentGroup\") {\n          let item = assignment as AssignedAssessmentGroup;\n          item.getAssessmentItems().map(i => method(i.Uid));\n        }\n      }\n    }\n\n    private clearAlert(alertId, timeout?:number) {\n    timeout = timeout || 0;\n\n    // we set a slight delay so people can see we were adding the assessment.\n    setTimeout(() => {\n        this.alertService.clearAlert(alertId);\n    }, timeout);\n    }\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, SimpleChanges, Input, OnChanges } from '@angular/core';\nimport { Question } from 'app/shared/models/question';\nimport { ListQuestion } from 'app/shared/models/list-question';\nimport { QuestionSetLabel } from 'app/shared/models/question-set-label';\nimport { UniqueIdService } from 'app/shared/services/unique-id.service';\n\n@Component({\n  selector: 'dac-question-labels-edit',\n  templateUrl: './question-labels-edit.component.html',\n  styleUrls: ['./question-labels-edit.component.scss']\n})\nexport class QuestionLabelsEditComponent implements OnInit, OnChanges {\n\n  @Input() question:ListQuestion;\n\n  public labels:QuestionSetLabel[];\n  public newLabel:QuestionSetLabel;\n\n  constructor(private uuid:UniqueIdService) {\n    this.labels = [];\n    this.createNewLabel();\n  }\n\n  ngOnInit() {\n    this.updateLabels();\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    this.updateLabels();\n  }\n\n  private createNewLabel() {\n    this.newLabel = new QuestionSetLabel();\n    this.newLabel.id = this.uuid.generate();\n  }\n\n  public addLabel() {\n    this.question.addLabel(this.newLabel);\n    this.updateLabels();\n    this.createNewLabel();\n  }\n\n  public shiftUpLabel(label:QuestionSetLabel) {\n    this.question.shiftUpLabel(label);\n  }\n\n  public shiftDownLabel(label:QuestionSetLabel) {\n    this.question.shiftDownLabel(label);\n  }\n\n  public deleteLabel(label:QuestionSetLabel) {\n    this.question.removeLabel(label);\n  }\n\n  private updateLabels() {\n    if (!this.question) {\n      this.labels = [];\n    }\n    this.labels = this.question.CustomLabels;\n  }\n}\n","<p class=\"alert alert-info\" *ngIf=\"labels.length <= 0\">No labels exist for this question yet.</p>\n<table class=\"table table-striped\" *ngIf=\"labels.length\">\n    <thead class=\"secondary-color text-white\">\n        <tr>\n            <th>Label</th>\n            <th>Actions</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr *ngFor=\"let label of labels; let first = first; let last=last;\">\n            <td>\n                <input class=\"form-control\" type=\"text\" [(ngModel)]=\"label.label\" />\n            </td>\n            <td>\n                <button (click)=\"shiftUpLabel(label)\" [disabled]=\"first\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Up\">\n                    <span class=\"fa fa-arrow-up\" aria-hidden=\"true\"></span>\n                </button>\n                <button (click)=\"shiftDownLabel(label)\" [disabled]=\"last\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Down\">\n                    <span class=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>\n                </button>\n                <button (click)=\"deleteLabel(label)\" type=\"button\" class=\"btn btn-secondary btn-sm\" aria-label=\"Delete\">\n                    <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n                </button>\n            </td>\n        </tr>\n    </tbody>\n</table>\n<div class=\"row\">\n        <input type=\"text\" [(ngModel)]=\"newLabel.label\" class=\"form-control col\" placeholder=\"Label Name...\" />\n        <div class=\"col\">\n            <input type=\"button\" class=\"btn btn-primary\" value=\"Add\" (click)=\"addLabel()\" />\n        </div>\n</div>\n\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { CompanyService } from 'app/shared/services/company.service';\nimport { Company } from 'app/shared/models/company';\n\n@Component({\n  selector: 'app-companies-list',\n  templateUrl: './companies-list.component.html',\n  styleUrls: ['./companies-list.component.css']\n})\nexport class CompaniesListComponent implements OnInit {\n\n  public Companies:Company[];\n  constructor(private companyService:CompanyService) { }\n\n  ngOnInit() {\n    this.companyService.getCompanies().then((companies) => {\n      this.Companies = companies;\n    })\n  }\n\n}\n","<div class=\"col-12\">\n    <h1 class=\"h1-responsive\">Companies List\n        <input type=\"button\" class=\"btn btn-primary\" [routerLink]=\"['new']\" value=\"Add Company\" />\n    </h1>\n    <!-- <search-input (search)=\"doSearch()\" reset=\"resetSearch()\"></search-input> -->\n    <table class=\"table table-striped\">\n        <thead class=\"primary-color text-white\">\n            <tr>\n\n                <th>Company</th>\n                <th>Contact Email</th>\n                <th>Host Site</th>\n\n                <th>Client Count</th>\n                <th>Token Count</th>\n                <th>Actions</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let company of Companies\">\n\n                <td>{{company.name}}</td>\n                <td>{{company.email}}</td>\n                <td>{{company.hostSiteName}}</td>\n                <td>{{company.clientCount}}</td>\n                <td>{{company.tokenCount}}</td>\n\n                <td>\n                    <button aria-label=\"Edit\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" [routerLink]=\"[company.id, 'edit']\">\n                        <span aria-hidden=\"true\" class=\"fa fa-edit\"></span>\n                    </button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Injectable } from \"@angular/core\";\nimport { HTTPService } from \"app/shared/services/http.service\";\nimport { AuthService } from \"app/login/services/auth.service\";\nimport { first } from \"rxjs/operators\";\nimport { SubscriptionService } from \"./subscription.service\";\n\n@Injectable()\nexport class AnnouncementService {\n\n    constructor(private dac$http:HTTPService, private authService:AuthService, private subscriptionService:SubscriptionService) {\n    }\n\n    public getAnnouncements() {\n      return Promise.resolve([]); // just return nothing for now as we will add announcements back later.\n\n        // let announcementRequest = this.dac$http.get<{id:number,content:string, link:string, linkTitle:string}[]>(\"announcements\");\n        // let loginStateRequest = this.authService.getLoginState().pipe(first()).toPromise();\n        // return Promise.all([announcementRequest, loginStateRequest]).then((results) => {\n        //     let [announcement, loginState] = results;\n        //     let announcementResults = [];\n        //     if (announcement.length) {\n        //         announcementResults = announcement.map(i => {\n        //             return {\n        //                 id: i.id\n        //                 ,content: i.content\n        //                 ,link: i.link\n        //                 ,linkTitle: i.linkTitle\n        //                 ,linkType: 'external'\n        //                 ,type: 'info'\n        //             };\n        //         });\n        //     }\n\n        //     if (loginState && !loginState.user.hasActiveSubscription()) {\n        //         announcementResults.push({\n        //             id: '0-expiredsubscription'\n        //             ,content: \"Your current subscription has ended and some functionality has been disabled.  Avoid termination of services by activating your subscription!\"\n        //             ,link: this.subscriptionService.getSubscriptionPageRoute()\n        //             ,linkTitle: 'Learn More'\n        //             ,linkType: 'internal'\n        //             ,type: 'warning'\n        //         });\n        //     }\n\n        //     return announcementResults;\n        // });\n    }\n\n    public markAnnouncementRead(announcement:any) {\n        if (announcement.id == '0-expiredsubscription') {\n            return Promise.resolve(true); // mark it as read since it's internal\n        }\n        return this.dac$http.post(\"announcements/\" + announcement.id, {read: true})\n        .then(() => {\n            return true;\n        })\n        .catch((error) => {\n            console.error(error);\n            return false;\n        });\n    }\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\n\nimport { Assessment } from \"../../shared/models/assessment\";\nimport { AssessmentService } from \"../../shared/services/assessment.service\";\n\n@Component({\n  selector: 'app-assessment-new',\n  templateUrl: './assessment-new.component.html',\n  styleUrls: ['./assessment-new.component.css']\n})\nexport class AssessmentNewComponent implements OnInit {\n\n  private _assessment:Assessment;\n\n  constructor(\n    private _assessmentService:AssessmentService\n    ,private router: Router\n    ,private alertService: AlertService\n    ,private route: ActivatedRoute\n  ) {\n    this._assessment = new Assessment();\n    this._assessment.name = \"Untitled\";\n  }\n\n  ngOnInit() {\n  }\n\n  get assessment() {\n    return this._assessment;\n  }\n  set assessment(v:Assessment) {\n    this._assessment = v;\n  }\n\n  private validateAssessment(assessment:Assessment) {\n    let errors = [];\n    if (typeof assessment.uid != 'string'\n      || assessment.uid.trim() == \"\") {\n        errors.push(\"Unique id is missing\");\n    }\n    if (typeof assessment.name != 'string'\n      || assessment.name.trim() == \"\") {\n      errors.push(\"Name is missing\");\n    }\n    if (typeof assessment.description != 'string'\n      || assessment.description.trim() == \"\") {\n      errors.push(\"Description is missing\");\n    }\n    return errors;\n  }\n\n  save() {\n    let errors = this.validateAssessment(this._assessment);\n    if (errors.length) {\n      this.alertService.error(\"Please correct the following errors: \" + errors.join(\".\\n\"), 3000);\n      return;\n    }\n\n\t\tconsole.log(this._assessment);\n\n\t\tthis._assessmentService.createAssessment(this._assessment)\n\t\t.then(() => {\n      this.alertService.success(\"Assessment Saved!\");\n      // TODO: stephen figure out how to use the angular2 version of this instead of the raw setTimeout\n\t\t\t\tsetTimeout(() => {\n          this.router.navigate([\"../\", this._assessment.uid, \"edit\"], {relativeTo: this.route, replaceUrl: true});\n\t\t\t\t}, 1500);\n      })\n      .catch((error) => {\n        if (error && error.code) {\n          if (error.code === 'DUP_ENTRY') {\n            this.alertService.error(\"An assessment already exists with that unique id.  Please try a different one\");\n            return;\n          }\n        }\n\n        this.alertService.error(\"Error occurred in saving your assessment. Please try again.\");\n\t\t});\n\t}\n\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">New Assessment</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n            <h3 class='h3-responsive text-center'>{{assessment.name}}</h3>\n        </div>\n        <div class=\"card-body\">\n          <form >\n            <div class=\"form-group\">\n              <label for=\"name\">Unique Identifier:</label>\n              <input class=\"form-control\" type=\"text\" id=\"uid\" name=\"uid\" [(ngModel)]=\"assessment.uid\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"name\">Name:</label>\n              <input class=\"form-control\" type=\"text\" id=\"name\" name=\"name\" [(ngModel)]=\"assessment.name\" />\n            </div>\n            <div class=\"form-group\">\n                <label for=\"instructions\">Instructions:</label>\n                <textarea class=\"form-control\" id=\"instructions\" name=\"instructions\" [(ngModel)]=\"assessment.instructions\"></textarea>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"description\">Description:</label>\n                <textarea class=\"form-control\" id=\"description\" name=\"description\" [(ngModel)]=\"assessment.description\"></textarea>\n            </div>\n\n            <div class=\"form-group\">\n                <label for=\"creator\">Creator:</label>\n                <input class=\"form-control\" type=\"text\" id=\"creator\" name=\"creator\" [(ngModel)]=\"assessment.creator\" />\n            </div>\n            <div class=\"form-group\">\n                <label for=\"creator\">Creator Url:</label>\n                <input class=\"form-control\" type=\"text\" id=\"creatorUrl\" name=\"creatorUrl\" [(ngModel)]=\"assessment.creatorUrl\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"resourcesURL\">Resources URL:</label>\n              <input class=\"form-control\" type=\"text\" id=\"resourcesURL\" name=\"resourcesURL\" [(ngModel)]=\"assessment.resourcesURL\" />\n            </div>\n            <input class=\"btn btn-primary\" type=\"submit\" (click)=\"save()\" value=\"Save\" />\n        </form>\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { ShoppingService } from \"../../shared/services/shopping.service\";\n\n@Component({\n  selector: 'app-checkout-status-monitor',\n  templateUrl: './checkout-status-monitor.component.html',\n  styleUrls: ['./checkout-status-monitor.component.css']\n})\nexport class CheckoutStatusMonitorComponent implements OnInit {\n\n    private orderStatus:string\n  constructor(\n    private shopping:ShoppingService\n  ) { }\n\n  ngOnInit() {\n    this.shopping.getCheckoutStatus().subscribe((status:string) => {\n      this.orderStatus = status;\n    });\n  }\n\n  get orderStart() {\n    return this.orderStatus === \"ORDER_START\";\n  }\n\n  get paymentPrepare() {\n    return this.orderStatus === \"PAYMENT_PREPARE\";\n  }\n\n  get orderFinalize() {\n    return this.orderStatus === \"ORDER_FINALIZE\";\n  }\n\n  get orderComplete() {\n    return this.orderStatus === \"ORDER_COMPLETE\";\n  }\n}\n","<p class=\"alert alert-warning\">\n    <app-spin-icon></app-spin-icon>\n    <span *ngIf=\"orderStart\">Preparing for purchase</span>\n    <span *ngIf=\"paymentPrepare\">Handling payment</span>\n    <span *ngIf=\"orderFinalize\">Finalizing order and setting up tokens</span>\n        <span *ngIf=\"orderComplete\">Order complete! Navigating to complete page</span>\n    <span class=\"ellipses\">...</span>\n</p>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport {User} from \"../../shared/models/user\";\nimport {UserService} from \"../../shared/services/user.service\";\nimport {ActivatedRoute, Router} from '@angular/router';\nimport { AlertService } from 'app/shared/services/alert.service';\n\n@Component({\n  selector: 'app-user-delete',\n  templateUrl: './user-delete.component.html',\n  styleUrls: ['./user-delete.component.css']\n})\nexport class UserDeleteComponent implements OnInit {\n\n  private _reassignClientsUser:User;\n  private _userToDelete:User;\n  private _userFilterFunction:(user:User) => boolean;\n  private _users:User[];\n\n  constructor(private userService:UserService,\n    private route:ActivatedRoute, private alertService:AlertService, private router:Router) {\n    this._userToDelete = new User();\n    this._userFilterFunction = this.filterUserToDelete.bind(this);\n    this._users = [];\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      let userId = params['userId'];\n      this.userService.getUser(userId).then(user => {\n        this._userToDelete = user;\n      });\n    });\n  }\n\n  public get Users() {\n    return this._users;\n  }\n\n  private filterUserToDelete(user:User) {\n    return user.id != this._userToDelete.id;\n  }\n  public get filterUser() {\n    return this._userFilterFunction\n  }\n\n  public get User() {\n    return this._userToDelete;\n  }\n  public set UserToAssign(v:User) {\n    this._reassignClientsUser = v;\n  }\n  public get UserToAssign() {\n    return this._reassignClientsUser;\n  }\n  public setUserToAssign(user:User) {\n    this._reassignClientsUser = user;\n  }\n  public delete() {\n    // this.userService.deleteUser(this._userToDelete, this._reassignClientsUser).then((result) => {\n    //   this.alertService.success(\"User Deleted\");\n    //   this.router.navigate([\"../../\"], {replaceUrl: true, relativeTo: this.route});\n    // })\n    // .catch(error => {\n    //   console.error(error);\n    //   this.alertService.error(\"The user failed to delete.  Try again or contact support\");\n    // });\n  }\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h1 class=\"h1-responsive text-center\">Delete User {{User.username}}</h1>\n    </div>\n</div>\n<div class=\"row\">\n    <div class=\"col card card-body\">\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                <label class=\"col\" for=\"username\">Reassign clients for this user to?</label>\n                <div class=\"col\">\n                    <!-- TODO: stephen figure out a way to use our username picker -->\n                    <user-selector [user]=\"UserToAssign\" [filter]=\"filterUser\" [allowEmpty]=\"true\" (selected)=\"setUserToAssign($event)\"></user-selector>\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <div class=\"col-sm-12\">\n                    <button class=\"btn btn-primary\" (click)=\"delete()\">\n                        <span class=\"fa fa-trash mr-2\"></span>Delete User\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\n@Component({\n  selector: 'app-my-account',\n  templateUrl: './my-account.component.html',\n  styleUrls: ['./my-account.component.scss']\n})\nexport class MyAccountComponent implements OnInit {\n\n  public tabs = [\n    { tab: \"Payments\" ,route: \"order\" }\n    ,{ tab: \"Billing Card\" ,route: \"billing\" }\n    ,{ tab: \"Plans\" ,route: \"plans\" }\n    ,{ tab: \"Company\" ,route: \"company\" }\n  ];\n  constructor(private router:Router, private route:ActivatedRoute) { }\n\n  ngOnInit() {\n  }\n\n  goTo(routeUrl:string) {\n    this.router.navigate([routeUrl], {relativeTo: this.route});\n  }\n\n}\n","<h1 class=\"h1-responsive\">My Account</h1>\n\n<dac-tabs router=\"true\">\n  <dac-tab *ngFor=\"let tab of tabs\"\n    [heading]=\"tab.tab\" [routerLink]=\"tab.route\"></dac-tab>\n</dac-tabs>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport { ScaleRange } from '../../shared/models/scale-range';\nimport { Scale } from '../../shared/models/scale';\n\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Router, ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'app-scale-range-edit',\n  templateUrl: './scale-range-edit.component.html',\n  styleUrls: ['./scale-range-edit.component.css']\n})\nexport class ScaleRangeEditComponent implements OnInit {\n\n    private _range:ScaleRange;\n  private scale:Scale;\n  private assessment:Assessment;\n  private readonly SAVE_TIME = 1500;\n  private readonly ERROR_MESSAGE_TIME = 3000;\n  public isSaving:boolean;\n\n  constructor( private assessmentService:AssessmentService\n    ,private alertService: AlertService\n    ,private router: Router\n    ,private route: ActivatedRoute) {\n      this.range = this.getNewObject();\n    }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let scaleId = params['scaleId'];\n      let rangeId = params['rangeId'];\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.scale = assessment.scales.find((s) => s.id == scaleId);\n          this.range = (this.scale) ? this.scale.ranges.find((r) => r.id == rangeId) : null;\n          if (!(this.scale && this.range)) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  private getNewObject() {\n    let obj = new ScaleRange();\n    obj.id = this.assessmentService.newId();\n    return obj;\n  }\n\n  get range():ScaleRange {\n    return this._range;\n  }\n\n  set range(v:ScaleRange) {\n    this._range = v;\n  }\n\n  private saveRange(range) {\n    this.isSaving = true;\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Range saved\", this.SAVE_TIME);\n      this.isSaving = false;\n      return range;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\", this.ERROR_MESSAGE_TIME);\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveRange(this.range);\n\t}\n\n\tsaveAndCreateNew() {\n      this.saveRange(this.range).then((question) => {\n        // TODO: stephen for whatever reason this isn't working very well here...\n      this.router.navigate([\"../../\", \"new\"], {relativeTo: this.route, replaceUrl: true});\n      // this.router.navigate([\"admin\",\"assessment\",this.assessment.uid, \"edit\"\n      //     ,\"scale\", this.scale.id, \"edit\"\n      //     , \"scale-range\", \"new\"], {replaceUrl: true});\n    });\n\t}\n\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n      <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n      <h2 class=\"h2-responsive text-center\">{{range.name}}</h2>\n    </div>\n  </div>\n<div class=\"row\">\n  <div class=\"col\">\n    <dac-tabs class=\"col-12\">\n        <dac-tab heading=\"General\">\n          <form>\n            <div class=\"form-group\">\n              <label for=\"name\">Name:</label>\n              <input class=\"form-control\" type=\"text\" name=\"name\" id=\"name\" [(ngModel)]=\"range.name\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"displayName\">Display Name:</label>\n              <input class=\"form-control\" type=\"text\" name=\"displayName\" id=\"displayName\" [(ngModel)]=\"range.displayName\" />\n            </div>\n            <div class=\"form-group\">\n                  <label for=\"rangeStart\">Range Start:</label>\n              <input class=\"form-control\" type=\"number\" name=\"rangeStart\" id=\"rangeStart\" [(ngModel)]=\"range.rangeStart\" />\n            </div>\n            <div class=\"form-group\">\n                  <label for=\"rangeEnd\">Range End:</label>\n              <input class=\"form-control\" type=\"number\" name=\"rangeEnd\" id=\"rangeEnd\" [(ngModel)]=\"range.rangeEnd\" />\n            </div>\n          </form>\n          <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n          <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n      </dac-tab>\n      <dac-tab heading=\"Therapist\">\n          <form>\n              <div class=\"form-group\">\n                  <label for=\"therapistContent\">Therapist Content:</label>\n                  <textarea class=\"form-control h-100\" rows=\"5\" name=\"therapistContent\" [(ngModel)]=\"range.therapistContent\" id=\"therapistContent\"></textarea>\n            </div>\n          </form>\n          <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n      </dac-tab>\n      <dac-tab heading=\"Client\">\n          <form>\n            <div class=\"form-group\">\n              <label for=\"clientContent\">Client Content:</label>\n              <textarea class=\"form-control h-100\" rows=\"5\" name=\"clientContent\" [(ngModel)]=\"range.clientContent\" id=\"clientContent\"></textarea>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"mediaURL\">Media URL:</label>\n              <input class=\"form-control\" type=\"text\" name=\"mediaURL\" id=\"mediaURL\" [(ngModel)]=\"range.mediaURL\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"assignmentURL\">Assignment URL:</label>\n              <input class=\"form-control\" type=\"text\" name=\"assignmentURL\" id=\"assignmentURL\" [(ngModel)]=\"range.assignmentURL\" />\n            </div>\n          </form>\n          <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        </dac-tab>\n    </dac-tabs>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, Input } from '@angular/core';\nimport { Order } from '../../shared/models/order';\n\n@Component({\n  selector: 'view-order',\n  templateUrl: './view-order.component.html',\n  styleUrls: ['./view-order.component.css']\n})\nexport class ViewOrderComponent implements OnInit {\n\n  @Input(\"order\") private _order:Order;\n\n  constructor() {\n    this._order = new Order();\n  }\n\n  ngOnInit() {\n  }\n\n  get order() {\n    return this._order;\n  }\n\n}\n","<div class=\"row details\">\n  <div class=\"col-12\">\n    <div class=\"row\">\n      <h4 class=\"col h4-responsive\">Summary</h4>\n    </div>\n    <div class=\"row mb-3\">\n      <div class=\"col\">\n        <div class=\"card card-body\">\n          <div class=\"row\">\n            <div class=\"col-3\">\n              <label>Purchaser</label>\n            </div>\n            <div class=\"col-9\">{{order?.customer}}</div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-3\">\n              <label>Status</label>\n            </div>\n            <div class=\"col-9\">{{order?.status}}</div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-3\">\n              <label *ngIf=\"order?.status == 'paid'\">Purchased</label>\n              <label *ngIf=\"order?.status != 'paid'\">Created</label>\n            </div>\n            <div class=\"col-9\">{{order?.creation_date| date:'medium'}}</div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-3\">\n              <label>Date Updated</label>\n            </div>\n            <div class=\"col-9\">{{order?.last_update_date| date:'medium'}}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<div class=\"row items\">\n  <div class=\"col\">\n    <div class=\"row\">\n      <h4 class=\"col h4-responsive\">Item Details</h4>\n    </div>\n    <div class=\"card card-body\">\n      <table class=\"table table-striped\">\n        <thead class=\"secondary-color text-white\">\n          <th class=\"w-25\">Items</th>\n          <th>Price</th>\n          <th>Quantity</th>\n          <th>Discount</th>\n          <th>Total</th>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let orderItem of order?.orderItems\">\n            <td *ngIf=\"orderItem.type == 'subscription'\">\n              <label>{{orderItem.item.plan.name}}</label>\n            </td>\n            <td *ngIf=\"orderItem.type == 'shop-item'\">\n              <label>{{orderItem.item.name}}</label>\n              <ul *ngIf=\"orderItem.item.subItems?.length\">\n                <li *ngFor=\"let subItem of orderItem.item.subItems\">{{subItem.name}}</li>\n              </ul>\n            </td>\n            <td>${{orderItem.price | number:'1.2-2'}}</td>\n            <td>x {{orderItem.quantity}}</td>\n            <td>\n              <span *ngIf=\"orderItem.discount\">-</span>${{orderItem.discount | number:'1.2-2'}}</td>\n            <td>${{orderItem.total | number:'1.2-2'}}</td>\n          </tr>\n        </tbody>\n        <tfoot>\n          <tr>\n            <td colspan=\"4\">\n              <label>Discount Total</label>\n            </td>\n            <td>\n              <span *ngIf=\"order?.discount\">-</span>${{order?.discount | number:'1.2-2'}}</td>\n          </tr>\n          <tr class=\"items-total items-total-footer\">\n            <td colspan=\"4\">\n              <label>Payment Total</label>\n            </td>\n            <td> ${{order?.total | number:'1.2-2'}}</td>\n          </tr>\n        </tfoot>\n      </table>\n    </div>\n  </div>\n</div>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { QuestionSetLabel } from '../../shared/models/question-set-label';\nimport { QuestionSet } from '../../shared/models/question-set';\n\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport { Assessment } from '../../shared/models/assessment';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { AlertService } from 'app/shared/services/alert.service';\n\n@Component({\n  selector: 'app-label-edit',\n  templateUrl: './label-edit.component.html',\n  styleUrls: ['./label-edit.component.css']\n})\nexport class LabelEditComponent implements OnInit {\n\n  private _label:QuestionSetLabel;\n  private questionSet:QuestionSet;\n  private assessment:Assessment;\n  public isSaving:boolean;\n\nconstructor( private assessmentService:AssessmentService\n    ,private alertService: AlertService\n    ,private location:Location\n    ,private router: Router\n    ,private route: ActivatedRoute) {\n      this.label = this.getNewObject();\n    }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      let labelId = params['labelId'];\n      this.assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.questionSet = assessment.question_sets.find((s) => s.id == setId);\n        this.label = (this.questionSet) ? this.questionSet.labels.find((l) => l.id == labelId) : null;\n        console.log(this.label);\n          if (!(this.questionSet && this.label)) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n        })\n        .catch((error) => {\n          console.error(error);\n          this.router.navigate([\"not-found\"]);\n        })\n    });\n  }\n\n  private getNewObject() {\n    let label = new QuestionSetLabel();\n    return label;\n  }\n\n  get label():QuestionSetLabel {\n    return this._label;\n  }\n\n  set label(v:QuestionSetLabel) {\n    this._label = v;\n  }\n\n  goBack() {\n    this.location.back();\n  }\n\n  private saveLabel(label) {\n    this.isSaving = true;\n\t\treturn this.assessmentService.saveAssessment(this.assessment).then((assessment) => {\n      this.alertService.success(\"Label saved\");\n      this.isSaving = false;\n      return label;\n    }).catch((error) => {\n      this.isSaving = false;\n      this.alertService.error(\"An error occurred in saving. Please try again or contact support.\");\n\t\t\tconsole.error(error);\n\t\t});\n  }\n\n  save() {\n    this.saveLabel(this.label);\n\t}\n\n\tsaveAndCreateNew() {\n    this.saveLabel(this.label).then((question) => {\n      this.router.navigate([\"../../\", \"new\"], {replaceUrl: true, relativeTo: this.route});\n    });\n\t}\n\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n      <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n      <h2 class=\"h2-responsive text-center\">{{label.label}}</h2>\n    </div>\n  </div>\n<div class=\"row\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"General Settings\">\n      <form>\n        <div class=\"form-group\">\n            <label for=\"label\">Label:</label>\n            <input class=\"form-control\" type=\"text\" id=\"label\" name=\"label\" [(ngModel)]=\"label.label\" />\n          </div>\n        <!--<div class=\"form-group\">\n              <label for=\"displayOrder\">Display Order:</label>\n          <input class=\"form-control\" type=\"number\" id=\"displayOrder\" name=\"displayOrder\" [(ngModel)]=\"ctrl.label.display_order\" />\n        </div>-->\n        <div class=\"form-group\">\n          <input class=\"form-control\" type=\"checkbox\" id=\"skip-scoring\" name=\"skip-scoring\" [checked]=\"label.skipScoring\" [(ngModel)]=\"label.skipScoring\" />\n          <label for=\"skip-scoring\">Skip Scoring: (N/A questions)</label>\n        </div>\n      </form>\n      <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n      <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n    </dac-tab>\n  </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {ActivatedRoute} from '@angular/router';\nimport { Component, OnInit, Input } from '@angular/core';\nimport { Assessment } from 'app/shared/models/assessment';\nimport { AssessmentService } from 'app/shared/services/assessment.service';\n\n@Component({\n  selector: 'dac-assessment-details-view',\n  templateUrl: './assessment-details-view.component.html',\n  styleUrls: ['./assessment-details-view.component.css']\n})\nexport class AssessmentDetailsViewComponent implements OnInit {\n\n  @Input() assessment:Assessment;\n\n  constructor() {\n    }\n\n  ngOnInit() {\n  }\n\n}\n","<form>\n    <div class=\"form-group\">\n      <label for=\"name\">Unique Identifier:</label>\n      <input class=\"form-control\" type=\"text\" id=\"uid\" name=\"uid\" disabled=\"true\" [(ngModel)]=\"assessment.uid\" />\n    </div>\n    <div class=\"form-group\">\n      <label for=\"name\">Name:</label>\n      <input class=\"form-control\" type=\"text\" id=\"name\" name=\"name\" disabled=\"true\" [(ngModel)]=\"assessment.name\" />\n    </div>\n    <div class=\"form-group\">\n        <label for=\"instructions\">Instructions:</label>\n        <textarea class=\"form-control\" id=\"instructions\" name=\"instructions\" disabled=\"true\" [(ngModel)]=\"assessment.instructions\"></textarea>\n    </div> \n    <div class=\"form-group\">\n      <label for=\"therapistDescription\">Therapist Description:</label>\n      <textarea class=\"form-control\" id=\"therapistDescription\" disabled=\"true\" name=\"therapistDescription\" [(ngModel)]=\"assessment.therapistDescription\"></textarea>\n  </div>\n    \n    <div class=\"form-group\">\n        <label for=\"creator\">Creator:</label>\n        <input class=\"form-control\" type=\"text\" id=\"creator\" name=\"creator\" disabled=\"true\" [(ngModel)]=\"assessment.creator\" />\n    </div>\n    <div class=\"form-group\">\n        <label for=\"creator\">Creator Url:</label>\n        <input class=\"form-control\" type=\"text\" id=\"creatorUrl\" disabled=\"true\" name=\"creatorUrl\" [(ngModel)]=\"assessment.creatorUrl\" />\n    </div>\n    <div class=\"form-group\">\n      <label for=\"resourcesURL\">Resources URL:</label>\n      <input class=\"form-control\" type=\"text\" id=\"resourcesURL\" disabled=\"true\" name=\"resourcesURL\" [(ngModel)]=\"assessment.resourcesURL\" />\n    </div>\n</form>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { User } from \"../../shared/models/user\";\nimport { UserService } from \"../../shared/services/user.service\";\nimport { Role } from \"../../shared/models/role\";\nimport { Router, ActivatedRoute } from \"@angular/router\";\nimport { AlertService } from '../../shared/services/alert.service';\n\n@Component({\n  selector: 'app-user-new',\n  templateUrl: './user-new.component.html',\n  styleUrls: ['./user-new.component.css']\n})\nexport class UserNewComponent implements OnInit {\n  private _user:User;\n  public password:string;\n  public isSaving:boolean;\n\n  public get User() {\n    return this._user;\n  }\n  public set User(v:User) {\n    this._user = v;\n  }\n\n  constructor(private userService:UserService, private router:Router\n    , private route:ActivatedRoute, private alertService:AlertService) {\n    this._user = new User();\n  }\n\n  ngOnInit() {\n  }\n\n  private validateForm() {\n    let errors = [];\n    if (!this._user.username) {\n      errors.push(\"You must enter an email address for this user\");\n    }\n    else if (this._user.username.length < 3) {\n      errors.push(\"The email address must be at least 3 characters long\");\n    }\n    // the server will catch anything else that's not valid... we just check for '@' for a simple typo.\n    else if (this._user.username.indexOf(\"@\") < 0) {\n      errors.push(\"The email address must be a valid email\");\n    }\n\n    let passwordPolicyMsg = \"Password must be 8 characters or more, contain at least one number(0-9), one uppercase letter(a-z), and one lowercase letter(A-Z)\";\n    let password = this.password;\n    if (!password || password.length < 8) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[0-9]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[A-Z]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[a-z]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    return errors;\n  }\n\n  save() {\n    let errors = this.validateForm();\n    if (errors.length) {\n      this.alertService.error(errors.join(\".\\n\"), 3000);\n      return;\n    }\n\n    // TODO: stephen need a confirm password piece here.\n    this.isSaving = true;\n    this._user.password = this.password;\n    this.userService.createUser(this._user).then((savedUser:User) => {\n      this.password = \"\"; // clear out the password now that we are done with it.\n      this.alertService.success(\"User created!\");\n      this.isSaving = false;\n      this.router.navigate(['../', savedUser.id, 'edit'], {replaceUrl: true, relativeTo: this.route});\n    })\n    .catch((error) => {\n      this.isSaving = false;\n      // TODO: stephen update this to be the more specific messages when we can...\n      this.alertService.error(\"Failed to save new user.  Please try again\");\n    })\n  }\n\n  public setUserRole(role:Role) {\n    this._user.role = role;\n  }\n\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h1 class=\"h1-responsive text-center\">New User</h1>\n    </div>\n</div>\n<div class=\"row\">\n    <dac-tabs>\n        <dac-tab heading=\"General\">\n            <div class=\"form-horizontal\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"username\">Email:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <username-checker [user]=\"User\"></username-checker>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"username\">First Name:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <input class=\"form-control\" id=\"firstName\" type=\"text\" [(ngModel)]=\"User.firstName\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"lastName\">Last Name:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <input class=\"form-control\" id=\"lastName\" type=\"text\" [(ngModel)]=\"User.lastName\" />\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"password\">Password:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                        <input class=\"form-control\" id=\"password\" type=\"password\" [(ngModel)]=\"password\" />\n                        <p class=\"alert alert-info\">Password must be at least 8 characters, have at least one uppercase letter, at least one lowercase letter, and at least one number</p>\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"roleSelector\">Role:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                        <app-role-selector id=\"roleSelector\" [role]=\"User.role\" (selected)=\"setUserRole($event)\"></app-role-selector>\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <div class=\"col\">\n                        <input [disabled]=\"isSaving\" class=\"btn btn-primary\" type=\"button\" value=\"Save\" (click)=\"save()\" />\n                    </div>\n                </div>\n            </div>\n        </dac-tab>\n    </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, Input, OnChanges } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AssessmentService } from 'app/shared/services/assessment.service';\nimport { Assessment } from 'app/shared/models/assessment';\nimport { Scale } from 'app/shared/models/scale';\n\n@Component({\n  selector: 'dac-scales-list-view',\n  templateUrl: './scales-list-view.component.html',\n  styleUrls: ['./scales-list-view.component.css']\n})\nexport class ScalesListViewComponent implements OnInit, OnChanges {\n\n  @Input() assessment:Assessment;\n  public selectedScale:Scale;\n\n  constructor() {\n  }\n\n  getClassesForScale(scale:Scale) {\n    let isSelected = scale == this.selectedScale;\n    let classes = {\n      'primary-color': isSelected\n      ,'white-text': isSelected\n    };\n    return classes;\n  }\n\n  ngOnChanges() {\n    this.populateScaleFromAssessment(this.assessment);\n  }\n  ngOnInit() {\n    this.populateScaleFromAssessment(this.assessment);\n  }\n\n  private populateScaleFromAssessment(assessment:Assessment) {\n    if (!assessment) {\n      return;\n    }\n\n    if (assessment.scales.length) {\n      this.selectedScale = assessment.scales[0];\n    }\n  }\n}\n","<div class=\"row\">\n  <div class=\"col\">\n      <h2 class=\"h2-responsive\">Scales</h2>\n      <!--TODO: stephen move this to <scales-list></scales-list>-->\n      <p *ngIf=\"assessment.scales.length <= 0\">No scales exist</p>\n  </div>\n</div>\n<div class=\"row\">\n    <div class=\"col-sm-4 col-lg-3\">\n        <ul class=\"list-group flex-column\">\n          <li class=\"list-group-item\"\n            [ngClass]=\"getClassesForScale(scale)\"\n            *ngFor=\"let scale of assessment.scales\" (click)=\"selectedScale = scale\"><a>{{scale.name}}</a></li>\n        </ul>\n      </div>\n      <div class=\"col-sm-8 col-lg-9\" *ngIf=\"!selectedScale\">\n        <p class=\"alert alert-info\">Select a scale</p>\n      </div>\n      <div class=\"col-sm-8 col-lg-9\" *ngIf=\"selectedScale\">\n        <div *ngFor=\"let range of selectedScale.ranges\" class=\"card card-cascade mb-3\">\n          <div class=\"view gradient-card-header secondary-gradient text-light\">\n            <h2 class=\"h2-responsive\">{{range.displayName}} ({{range.rangeStart}} - {{range.rangeEnd}})</h2>\n          </div>\n          <div class=\"card-body\">\n            <h3 class=\"h3-responsive p-0\">Therapist Content</h3>\n            <hr class=\"mb-2\" />\n            <div [innerHTML]=\"range.therapistContent\"></div>\n            <h3 class=\"h3-responsive p-0\">Client Content</h3>\n            <hr class=\"mb-2\" />\n            <div *ngIf=\"range.clientContent\" [innerHTML]=\"range.clientContent\"></div>\n            <div *ngIf=\"!range.clientContent\" [innerHTML]=\"range.therapistContent\"></div>\n          </div>\n        </div>\n      </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { ClientService } from '../../shared/services/client.service';\nimport { ManagedClient } from '../../shared/models/managed-client';\nimport { Router } from \"@angular/router\";\nimport { Location } from \"@angular/common\";\nimport {DacConfig} from \"../../shared/services/dac-config.service\";\nimport { User } from 'app/shared/models/user';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { AuthService } from 'app/login/services/auth.service';\n\n// Todo: Stephen I'm not sure how much the wordpress stuff works and may just need to be removed.\n@Component({\n  selector: 'app-client-new',\n  templateUrl: './client-new.component.html',\n  styleUrls: ['./client-new.component.css']\n})\nexport class ClientNewComponent implements OnInit {\n\n  private _client: ManagedClient;\n  public password:string;\n  public confirmPassword:string;\n  public isSaving:boolean;\n  public clientName:string;\n  private _generatingClientId:boolean;\n\n  constructor(\n    private _clientService: ClientService,\n    private router: Router,\n    private location: Location,\n    private alertService: AlertService,\n    private authService:AuthService,\n    private dacConfig:DacConfig\n  ) {\n    this._client = new ManagedClient();\n    this.authService.getCurrentUser().then(user => {\n      this._client.user = user;\n    });\n    this.isSaving = false;\n  }\n\n  ngOnInit() {\n    this.generateClientId();\n  }\n\n  get isGeneratingClientId() {\n    return this._generatingClientId;\n  }\n  generateClientId() {\n    this._generatingClientId = true;\n    this._clientService.generateClientId().then(id => {\n      this._client.id = id;\n      this._generatingClientId = false;\n    })\n    .catch(error => {\n      this.alertService.error(\"There was an error generating the client id for this client.  Please press the generate button again or contact support\");\n      console.error(error);\n    });\n  }\n\n  goBack() {\n    this.location.back();\n  }\n\n  get shouldShowEmailTemplate() {\n    return this.dacConfig.isFeatureEnabled(\"assessments.manage.emailtemplate\");\n  }\n\n\n\n  get Client(): ManagedClient {\n    return this._client;\n  }\n\n  set Client(v: ManagedClient) {\n    this._client = v;\n  }\n\n  get showPasswordFields() {\n    return false;\n  }\n\n  private validate() : string[] {\n    let errors = [];\n    if (this.showPasswordFields) {\n      if (this.password.trim() === \"\") {\n        errors.push(\"Password cannot be empty\");\n      }\n      else if (this.password !== this.confirmPassword) {\n        errors.push(\"Passwords do not match\");\n      }\n      else if (this.password.length < 8) {\n        errors.push(\"Password must be at least 8 characters long\");\n      }\n    }\n    if (this._client.id === null\n        || this._client.id.trim() === \"\") {\n      errors.push(\"Unique Client Login ID cannot be empty\");\n    }\n    return errors;\n  }\n\n  setUser(user:User) {\n    this.Client.user = user;\n  }\n\n  save(isValid:boolean): void {\n    if (!isValid) {\n      this.alertService.error(\"You must fill in all required fields\");\n      return;\n    }\n\n    let errors = this.validate();\n    if (errors.length) {\n      this.alertService.error(errors.join(\".\"), 3000);\n      return;\n    }\n    this.isSaving = true;\n    this._client.customField1 = this._client.id;\n    this._clientService.createClient(this._client).then((client) => {\n      this.handleClientCreateSuccess();\n    })\n    .catch((error) => {\n      this.isSaving = false;\n      console.error(error);\n      if (error._code && error._code == \"DUP_ENTRY\") {\n        this.alertService.error(\"That Unique Token already exists.  Please choose another one.\", 3000);\n      }\n      else {\n        this.alertService.error(\"An error occurred in saving this client.  Try again or contact customer support\", 3000);\n      }\n    });\n\n  }\n\n  private handleClientCreateSuccess() {\n    this.alertService.success(\"Client was created\");\n    setTimeout(() => {\n      this.isSaving = false;\n      this.router.navigate(['admin','client',this._client.id], {replaceUrl:true});\n    }, 1000);\n  }\n}\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h2 class=\"h2-responsive text-center\">New Client</h2>\n    </div>\n</div>\n<div class=\"row\">\n    <dac-tabs class=\"col-12\">\n        <dac-tab heading=\"General\">\n            <form #clientForm=\"ngForm\" class=\"form-horizontal\">\n                <div class=\"form-group\">\n                    <label class=\"col-12\" for=\"firstName\">\n                        <h6><i class=\"fa fa-user pt-2 pr-2 h4-responsive\"></i>First Name*:</h6>\n\n                    </label>\n                    <div class=\"col-12\">\n                        <input class=\"form-control\" name=\"firstName\" type=\"text\" [(ngModel)]=\"Client.firstName\"\n                        required #firstName=\"ngModel\" />\n                    </div>\n                    <div *ngIf=\"firstName.invalid && (firstName.dirty || firstName.touched || clientForm.submitted)\"\n                        class=\"alert alert-danger\">\n                        <div *ngIf=\"firstName.errors.required\">\n                            First Name is required.\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-12\" for=\"lastName\">\n                        <h6><i class=\"fa fa-user pt-2 pr-2 h4-responsive\"></i>Last Name*:</h6>\n\n                    </label>\n                    <div class=\"col-12\">\n                        <input class=\"form-control\" name=\"lastName\" type=\"text\" [(ngModel)]=\"Client.lastName\" required #lastName=\"ngModel\" />\n                    </div>\n                    <div *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched || clientForm.submitted)\"\n                        class=\"alert alert-danger\">\n                        <div *ngIf=\"lastName.errors.required\">\n                            Last Name is required.\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-12\" for=\"uniqueToken\">\n                        <h6><i class=\"fa fa-key pt-2 pr-2 h4-responsive\"></i>Client Login Identifier**: </h6>\n                    </label>\n                    <div class=\"col-12\">\n                        <h6>\n                            <span *ngIf=\"isGeneratingClientId\" class=\"h4\">Generating...</span>\n                            <span *ngIf=\"!isGeneratingClientId\" class=\"h4\">{{Client.id}}</span>\n                            <input type=\"button\" class=\"btn btn-primary\" value=\"Generate New Id\" (click)=\"generateClientId()\" [disabled]=\"isGeneratingClientId\" />\n                            <app-spin-icon *ngIf=\"isGeneratingClientId\"></app-spin-icon>\n                        </h6>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-12\" for=\"emailAddress\">\n                        <h6><i class=\"fa fa-envelope pt-2 pr-2 h4-responsive\"></i>Email*:</h6>\n                    </label>\n                    <div class=\"col-12\">\n                        <input class=\"form-control\" name=\"emailAddress\" type=\"text\" email [(ngModel)]=\"Client.email\" #emailAddress=\"ngModel\" />\n                    </div>\n                    <div *ngIf=\"emailAddress.invalid && (emailAddress.dirty || emailAddress.touched || clientForm.submitted)\"\n                        class=\"alert alert-danger\">\n                        <div *ngIf=\"emailAddress.errors.required\">\n                            Email is required.\n                        </div>\n                        <div *ngIf=\"emailAddress.errors.email\">\n                                Email must be a valid email address with the local address being shorter than 64 characters and the whole email\n                                address less than 254 characters.\n                            </div>\n                    </div>\n                </div>\n\n                <div class=\"form-group\" *hasPermission=\"'Admin'\">\n                    <label class=\"col-12\" for=\"assignedUser\"><h6><i class=\"fa fa-user pt-2 pr-2 h4-responsive red-text\"></i>Assigned User</h6></label>\n                    <div class=\"col-12\">\n                        <user-selector [user]=\"Client.user\" [allowEmpty]=\"true\" (selected)=\"setUser($event)\"></user-selector>\n                    </div>\n                </div>\n\n                <div *ngIf=\"showPasswordFields\" class=\"form-group\">\n                    <label class=\"col-12\" for=\"password\">Client Password:</label>\n                    <div class=\"col-12 \">\n                        <input class=\"form-control\" id=\"password\" type=\"password\" [(ngModel)]=\"password\" />\n                    </div>\n                </div>\n\n                <div *ngIf=\"showPasswordFields\" class=\"form-group\">\n                    <label class=\"col-12\" for=\"confirmPassword\">Client Confirm Password:</label>\n                    <div class=\"col-12\">\n                        <input id=\"confirmPassword\" type=\"password\" class=\"form-control\" [(ngModel)]=\"confirmPassword\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <div class=\"col\">\n                        <input [disabled]=\"isSaving\" class=\"btn btn-primary\" type=\"button\" value=\"Save\" (click)=\"clientForm.submitted=true;save(clientForm.valid)\" />\n                    </div>\n                </div>\n                <div class=\"col-12 alert alert-info\">\n                    <p> * This field is required</p>\n                    <p>** Your client will use this unique identifier to login.</p>\n                </div>\n            </form>\n        </dac-tab>\n\n    </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-admin-shop',\n  templateUrl: './admin-shop.component.html',\n  styleUrls: ['./admin-shop.component.css']\n})\nexport class AdminShopComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<shop-items class=\"col-md-7\"></shop-items>\n<checkout class=\"col-md-offset-1 col-md-4\"></checkout>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\nimport { NavBarService } from 'app/theme/services/nav-bar.service';\n\nimport { DacConfig } from \"../../shared/services/dac-config.service\";\nimport { SubscriptionService } from '../services/subscription.service';\nimport { SubscriptionLike as ISubscription } from 'rxjs';\nimport { ModalService } from 'app/shared/services/modal.service';\nimport { SubscriptionDialogComponent } from '../subscription-dialog/subscription-dialog.component';\n\n@Component({\n  selector: 'app-admin',\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.css']\n})\nexport class AdminComponent implements OnInit, OnDestroy {\n\n  private _subscriptionServiceSubscription:ISubscription;\n\n  constructor(\n    private dacConfig:DacConfig\n    ,private navService:NavBarService\n    ,private subscriptionService:SubscriptionService\n    ,private modalService:ModalService\n  ) {\n  }\n\n  ngOnInit() {\n    // turn it on\n    this.navService.toggleSidebar();\n    this._subscriptionServiceSubscription = this.subscriptionService.subscriptionRequiredEvent().subscribe(() => {\n      this.openSubscriptionDialog();\n    });\n  }\n\n  private openSubscriptionDialog() {\n    this.modalService.openDialog(SubscriptionDialogComponent);\n  }\n\n  ngOnDestroy() {\n    // turn it off\n    this.navService.toggleSidebar();\n    if (this._subscriptionServiceSubscription) {\n      this._subscriptionServiceSubscription.unsubscribe();\n      this._subscriptionServiceSubscription = null;\n    }\n  }\n\n  get canManageAssessments() {\n    return this.dacConfig.isFeatureEnabled(\"admin.assessments.navigation\");\n  }\n\n  get shouldShowAddoHome() {\n    return this.dacConfig.isFeatureEnabled(\"addo.dashboard.admin\");\n  }\n\n  get canShop() {\n    return this.dacConfig.isFeatureEnabled(\"admin.shop\");\n  }\n\n  goToAddoHome(event:Event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // go to the base url\n    window.location.href = \"/\";\n    return false;\n  }\n}\n","<div class=\"row no-gutters\">\n  <dac-announcement-bar class=\"col\"></dac-announcement-bar>\n</div>\n<div class=\"row no-gutters\">\n  <div class=\"col\">\n    <div class=\"mt-3 mb-3\">\n      <router-outlet></router-outlet>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit, ElementRef, ViewChild } from '@angular/core';\nimport { Router,ActivatedRoute } from \"@angular/router\";\n\nimport { Assessment } from \"../../shared/models/assessment\";\nimport { SaveMessages } from \"../../shared/models/save-messages\";\nimport { AssessmentService } from \"../../shared/services/assessment.service\";\nimport { Scale } from \"../../shared/models/scale\";\nimport { QuestionSet } from \"../../shared/models/question-set\";\nimport { AssessmentHydrator } from '../../shared/services/assessment-hydrator.service';\nimport { AssessmentCompressorService } from 'app/shared/services/assessment-compressor.service';\n\n@Component({\n  selector: 'app-assessment-edit',\n  templateUrl: './assessment-edit.component.html',\n  styleUrls: ['./assessment-edit.component.css']\n})\nexport class AssessmentEditComponent implements OnInit {\n\n\tprivate _assessment:Assessment;\n\tpublic hasLoadedAssessment:boolean;\n\tprivate _messages:SaveMessages;\n\t@ViewChild('reportContents') reportContents:ElementRef;\n\n  constructor(\n    private _assessmentService:AssessmentService\n\t\t,private assessmentCompressor:AssessmentCompressorService\n\t\t,private router: Router\n\t\t,private alertService:AlertService\n\t\t,private hydrator:AssessmentHydrator\n    ,private route: ActivatedRoute\n  ) {\n\t\tthis.hasLoadedAssessment = false;\n    this._messages = new SaveMessages();\n    this._assessment = new Assessment();\n  }\n\n  ngOnInit() {\n\tlet uid = this.route.snapshot.params['uid'];\n\tlet version = this.route.snapshot.queryParams['version'];\n\n\n\tthis._assessmentService.uid = uid;\n\tlet assessmentPromise;\n    if (version) {\n      assessmentPromise = this._assessmentService.getAssessmentVersion(uid, version);\n    } else {\n      assessmentPromise = this._assessmentService.getAssessment(uid);\n    }\n    assessmentPromise.then((assessment) => {\n\t\t\t\tif (assessment) {\n\t\t\t\t\t// if we have nothing back in the admin then we are going to create our own\n\t\t\t\t\tthis.assessment = assessment;\n\t\t\t\t\tthis.hasLoadedAssessment = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// TODO: stephen handle 404 errors\n\t\t\t\t\t//this._$state.go(\"404\");\n          this.router.navigate([\"page-not-found\"]);\n\t\t\t\t}\n\t\t\t}, (error) => {\n\t\t\t\tthis.hasLoadedAssessment = true;\n\t\t\t\t// TODO: stephen can't all of this just go in the catch block below?\n\t\t\t\tconsole.error(error);\n\t\t\t\tthis.alertService.error(\"Failed to retrieve assessment data from server\");\n\t\t\t\tthis.assessment = new Assessment();\n\t\t\t\tthis.assessment.uid = this._assessmentService.uid;\n\t\t\t})\n\t\t\t.catch(function(error) {\n\t\t\t\tthis.hasLoadedAssessment = true;\n\t\t\t\tthis.alertService.error(\"Failed to retrieve assessment data from server\");\n\t\t\t\tconsole.error(error);\n\t\t\t})\n  }\n\n  get assessment() {\n    return this._assessment;\n  }\n  set assessment(v:Assessment) {\n    this._assessment = v;\n  }\n\n  get messages() {\n    return this._messages;\n  }\n\n  getRawAssessment() {\n    let data = this.assessmentCompressor.compress(this.assessment);\n    if (data && data['token']) {\n      delete data['token']; // this should never be included but we don't want to copy it over anyways.\n    }\n\t  return JSON.stringify(data, null, \" \");\n  }\n\n  save() {\n\t\tconsole.log(this._assessment);\n\t\tthis._assessmentService.saveAssessment(this._assessment)\n\t\t.then(() => {\n\t\t\tthis.alertService.success(\"Assessment Saved!\");\n\t\t}).catch(() => {\n\t\t\t\tthis.alertService.error(\"Error occurred in saving your assessment. Please try again.\");\n\t\t});\n\t}\n\n\tpublic updateAssessmentContents() {\n    let reportContents = this.reportContents.nativeElement as HTMLTextAreaElement;\n    let jsonData = reportContents.value;\n    let assessmentJSON;\n    try {\n\t\t\tassessmentJSON = JSON.parse(jsonData);\n\t\t\tthis.assessment = this.hydrator.hydrate(assessmentJSON);\n      this.alertService.info(\"Assessment contents updated.  Make sure to save the assessment before proceeding\");\n    }\n    catch (error) {\n      this.alertService.error(\"The assessment contains invalid JSON and could not be parsed\");\n      console.error(error);\n    }\n\n  }\n\n\tmoveUpScale(scale:Scale) {\n\t\tthis.assessment.shiftScaleUp(scale);\n\t}\n\tmoveDownScale(scale:Scale) {\n\t\tthis.assessment.shiftScaleDown(scale);\n\t}\n\n  moveUpSet(questionSet:QuestionSet) {\n\t\tthis.assessment.shiftQuestionSetUp(questionSet);\n\t\tthis.save();\n\t}\n\n\tmoveDownSet(questionSet:QuestionSet) {\n\t\tthis.assessment.shiftQuestionSetDown(questionSet);\n\t\tthis.save();\n\t}\n\n\tdeleteQuestionSet(questionSet:QuestionSet) {\n\t\tif (!confirm(\"Are you sure you want to delete this question set?\")) {\n\t\t\treturn;\n\t\t}\n\t\tthis.assessment.removeQuestionSet(questionSet);\n\t\tthis._assessmentService.saveAssessment(this.assessment).then(() => {\n\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error(error);\n\t\t\tthis.alertService.error(\"An error occurred in removing the question set.\");\n\t\t})\n\t}\n\tdeleteScale(scale:Scale) {\n\t\tif (!confirm(\"Are you sure you want to delete this scale?\")) {\n\t\t\treturn;\n\t\t}\n\t\tscale.isDeleted = true;\n\t\tthis.assessment.removeScale(scale);\n\t\tthis._assessmentService.saveAssessment(this.assessment).then(() => {\n\t\t\tthis.alertService.success(\"Scale deleted...\");\n\t\t\t// we don't do anything here...\n\t\t}, () => {\n\t\t\t// TODO: stephen handle the error\n\t\t\tthis.alertService.error(\"Error occurred.  Could not delete this scale\");\n\t\t\tscale.isDeleted = false;\n\t\t\tthis.assessment.addScale(scale);\n\t\t})\n\t}\n\n}\n","<div class=\"row\" *ngIf=\"!hasLoadedAssessment\">\n  <div class=\"col-xs-12\">\n    <p class=\"alert alert-warning\"><app-spin-icon></app-spin-icon> Loading Assessment data...</p>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoadedAssessment\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">{{assessment.name}}</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"General\">\n    <form>\n        <div role=\"alert\">\n          <div *ngIf=\"messages.saveSuccess\">Assessment Saved!</div>\n          <div *ngIf=\"messages.saveFailed\">Error occurred in saving your assessment. Please try again.</div>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"name\">Unique Identifier:</label>\n          <input class=\"form-control\" type=\"text\" id=\"uid\" name=\"uid\" [(ngModel)]=\"assessment.uid\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"name\">Name:</label>\n          <input class=\"form-control\" type=\"text\" id=\"name\" name=\"name\" [(ngModel)]=\"assessment.name\" />\n        </div>\n        <div class=\"form-group\">\n            <label for=\"instructions\">Instructions:</label>\n            <textarea class=\"form-control\" id=\"instructions\" name=\"instructions\" [(ngModel)]=\"assessment.instructions\"></textarea>\n        </div>\n        <div class=\"form-group\">\n            <label for=\"description\">Description:</label>\n            <textarea class=\"form-control\" id=\"description\" name=\"description\" [(ngModel)]=\"assessment.description\"></textarea>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"therapistDescription\">Therapist Description:</label>\n          <textarea class=\"form-control\" id=\"therapistDescription\" name=\"therapistDescription\" [(ngModel)]=\"assessment.therapistDescription\"></textarea>\n      </div>\n\n        <div class=\"form-group\">\n            <label for=\"creator\">Creator:</label>\n            <input class=\"form-control\" type=\"text\" id=\"creator\" name=\"creator\" [(ngModel)]=\"assessment.creator\" />\n        </div>\n        <div class=\"form-group\">\n            <label for=\"creator\">Creator Url:</label>\n            <input class=\"form-control\" type=\"text\" id=\"creatorUrl\" name=\"creatorUrl\" [(ngModel)]=\"assessment.creatorUrl\" />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"resourcesURL\">Resources URL:</label>\n          <input class=\"form-control\" type=\"text\" id=\"resourcesURL\" name=\"resourcesURL\" [(ngModel)]=\"assessment.resourcesURL\" />\n        </div>\n        <input class=\"btn btn-primary\" type=\"submit\" (click)=\"save()\" value=\"Save\" />\n      </form>\n    </dac-tab>\n    <dac-tab heading=\"Scales\">\n        <a [routerLink]=\"['scale','new']\"  type=\"button\" class=\"btn btn-primary\">New Scale</a>\n        <!--TODO: stephen move this to <scales-list></scales-list>-->\n        <p class=\"alert alert-info\" *ngIf=\"assessment.scales.length <= 0\">No scales exist</p>\n        <table class=\"table\" *ngIf=\"assessment.scales.length\">\n          <thead class=\"primary-color text-white\">\n            <tr>\n              <th>Title</th>\n              <th>Score Multiplier</th>\n              <th>Ranges</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tr *ngFor=\"let scale of assessment.scales; let first = first; let last = last;\">\n\n            <td class=\"w-25\">\n                {{scale.name}}\n            </td>\n            <td>\n              {{scale.multiplier}}\n            </td>\n            <td class=\"w-50\">\n              <span *ngFor=\"let range of scale.ranges;\">{{range.displayName}}&nbsp;</span>\n            </td>\n            <td class=\"w-25\">\n                <button (click)=\"moveUpScale(scale)\" [disabled]=\"first\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Up\">\n                    <span class=\"fa fa-arrow-up\" aria-hidden=\"true\"></span>\n                  </button>\n                  <button (click)=\"moveDownScale(scale)\" [disabled]=\"last\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Down\">\n                    <span class=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>\n                  </button>\n              <button [routerLink]=\"['scale',scale.id,'edit']\"\n                type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Edit\">\n                <span class=\"fa fa-edit\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"deleteScale(scale)\" type=\"button\" class=\"btn btn-secondary btn-sm\" aria-label=\"Delete\">\n                <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n              </button>\n            </td>\n          </tr>\n        </table>\n    </dac-tab>\n    <dac-tab heading=\"Question Sets\">\n      <a [routerLink]=\"['question-set', 'new']\"  type=\"button\" class=\"btn btn-primary\">New Question Set</a>\n      <p class=\"alert alert-info\" *ngIf=\"assessment.question_sets.length <= 0\">No Question Sets exist</p>\n      <!--<question-set-list></question-set-list>-->\n      <table class=\"table\" *ngIf=\"assessment.question_sets.length\">\n        <thead class=\"primary-color text-white\">\n          <tr>\n            <th>Title</th>\n            <th># of Questions</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tr *ngFor=\"let questionSet of assessment.question_sets; let first = first; let last = last;\">\n          <td>\n              {{questionSet.title}}\n          </td>\n          <td>\n            {{questionSet.questions.length}}\n          </td>\n          <td>\n            <button (click)=\"moveUpSet(questionSet)\" [disabled]=\"first\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Up\">\n              <span class=\"fa fa-arrow-up\" aria-hidden=\"true\"></span>\n            </button>\n            <button (click)=\"moveDownSet(questionSet)\" [disabled]=\"last\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Down\">\n              <span class=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>\n            </button>\n            <button [routerLink]=\"['question-set',questionSet.id,'edit']\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Edit\">\n              <span class=\"fa fa-edit\" aria-hidden=\"true\"></span>\n            </button>\n              <button (click)=\"deleteQuestionSet(questionSet)\" type=\"button\" class=\"btn btn-primary btn-sm\" aria-label=\"Delete\">\n              <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n            </button>\n          </td>\n        </tr>\n      </table>\n    </dac-tab>\n    <dac-tab heading=\"Raw Edit\">\n        <textarea class=\"text-editor-window\" #reportContents [value]=\"getRawAssessment()\"></textarea>\n        <input type=\"button\" class=\"btn btn-primary\" (click)=\"updateAssessmentContents()\" value=\"Update\" />\n    </dac-tab>\n  </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit } from '@angular/core';\nimport { AssessmentService } from 'app/shared/services/assessment.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Assessment } from 'app/shared/models/assessment';\nimport { Question } from 'app/shared/models/question';\nimport { QuestionType } from 'app/shared/models/question-type';\n\n@Component({\n  selector: 'app-assessment-view',\n  templateUrl: './assessment-view.component.html',\n  styleUrls: ['./assessment-view.component.css']\n})\nexport class AssessmentViewComponent implements OnInit {\n  public assessment:Assessment;\n  public hasLoadedAssessment:boolean;\n\n  constructor(\n    private route:ActivatedRoute\n    ,private router:Router\n    ,private assessmentService:AssessmentService\n    ,private alertService:AlertService\n  ) {\n    this.assessment = new Assessment();\n  }\n\n  ngOnInit() {\n    let uid = this.route.snapshot.params['uid'];\n    let version = this.route.snapshot.queryParams['version'];\n    this.assessmentService.uid = uid;\n    let assessmentPromise;\n    if (version) {\n      assessmentPromise = this.assessmentService.getAssessmentVersion(uid, version);\n    } else {\n      assessmentPromise = this.assessmentService.getAssessment(uid);\n    }\n    assessmentPromise.then((assessment) => {\n\t\t\t\tif (assessment) {\n\t\t\t\t\tthis.assessment = assessment;\n\t\t\t\t\tthis.hasLoadedAssessment = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// TODO: stephen handle 404 errors\n\t\t\t\t\t//this._$state.go(\"404\");\n          this.router.navigate([\"page-not-found\"]);\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.hasLoadedAssessment = true;\n\t\t\t\t// TODO: stephen can't all of this just go in the catch block below?\n\t\t\t\tconsole.error(error);\n\t\t\t\tthis.alertService.error(\"Failed to retrieve assessment data from server\");\n\t\t\t\tthis.assessment = new Assessment();\n\t\t\t\tthis.assessment.uid = this.assessmentService.uid;\n\t\t\t});\n  }\n\n}\n","<div class=\"row\" *ngIf=\"!hasLoadedAssessment\">\n  <div class=\"col-xs-12\">\n    <p class=\"alert alert-warning\"><app-spin-icon></app-spin-icon> Loading Assessment data...</p>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoadedAssessment\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">{{assessment.name}}</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"Details\">\n      <dac-assessment-details-view [assessment]=\"assessment\"></dac-assessment-details-view>\n    </dac-tab>\n    <dac-tab heading=\"Scales\">\n      <dac-scales-list-view [assessment]=\"assessment\"></dac-scales-list-view>\n    </dac-tab>\n    <dac-tab heading=\"Question Sets\">\n      <dac-question-set-list-view [assessment]=\"assessment\"></dac-question-set-list-view>\n    </dac-tab>\n  </dac-tabs>\n<div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { FormsModule } from '@angular/forms';\n\nimport { AdminRoutingModule } from \"./admin-routing.module\";\nimport { SharedModule } from \"../shared/shared.module\";\nimport { AssessmentChartsModule } from \"../assessment-charts/assessment-charts.module\";\nimport { ThemeModule } from \"../theme/theme.module\";\n\nimport { AdminComponent } from './admin/admin.component';\nimport { ClientListComponent } from './client-list/client-list.component';\nimport { ClientNewComponent } from './client-new/client-new.component';\nimport { ClientEditComponent } from './client-edit/client-edit.component';\nimport { AssessmentListComponent } from './assessment-list/assessment-list.component';\nimport { AssessmentNewComponent } from './assessment-new/assessment-new.component';\nimport { AssessmentEditComponent } from './assessment-edit/assessment-edit.component';\nimport { AssessmentAdminComponent } from './assessment-admin/assessment-admin.component';\nimport { QuestionSetEditComponent } from './question-set-edit/question-set-edit.component';\nimport { QuestionSetCoreFormComponent } from './question-set-core-form/question-set-core-form.component';\nimport { QuestionSetNewComponent } from './question-set-new/question-set-new.component';\nimport { ScaleNewComponent } from './scale-new/scale-new.component';\nimport { ScaleEditComponent } from './scale-edit/scale-edit.component';\n\nimport { QuestionNewComponent } from './question-new/question-new.component';\nimport { QuestionEditComponent } from './question-edit/question-edit.component';\n\nimport { AssessmentGroupEditComponent } from './assessment-group-edit/assessment-group-edit.component';\nimport { LabelNewComponent } from './label-new/label-new.component';\nimport { LabelEditComponent } from './label-edit/label-edit.component';\nimport { ScaleRangeNewComponent } from './scale-range-new/scale-range-new.component';\nimport { ScaleRangeEditComponent } from './scale-range-edit/scale-range-edit.component';\nimport { AdminShopComponent } from './admin-shop/admin-shop.component';\nimport { CheckoutComponent } from './checkout/checkout.component';\nimport { ShopItemsComponent } from './shop-items/shop-items.component';\nimport { CheckoutThankyouComponent } from './checkout-thankyou/checkout-thankyou.component';\nimport { ViewOrderComponent } from './view-order/view-order.component';\nimport { CartWidgetComponent } from './cart-widget/cart-widget.component';\nimport { MyAccountComponent } from './my-account/my-account.component';\nimport { OrderHistoryComponent } from './order-history/order-history.component';\nimport { ViewOrderPageComponent } from './view-order-page/view-order-page.component';\nimport { CheckoutStatusMonitorComponent } from './checkout-status-monitor/checkout-status-monitor.component';\nimport {ReportsModule} from \"../reports/reports.module\";\nimport { LoginModule } from 'app/login/login.module';\nimport { AssessmentViewComponent } from './assessment-view/assessment-view.component';\nimport { ScalesListViewComponent } from './scales-list-view/scales-list-view.component';\nimport { QuestionSetListViewComponent } from './question-set-list-view/question-set-list-view.component';\nimport { AssessmentDetailsViewComponent } from './assessment-details-view/assessment-details-view.component';\nimport { AssessmentTokensListComponent } from './assessment-tokens-list/assessment-tokens-list.component';\nimport { QuestionLabelsEditComponent } from './question-labels-edit/question-labels-edit.component';\nimport {ClientSearchService} from \"./services/client-search.service\";\nimport { AssessmentAssignerService } from './services/assessment-assigner.service';\nimport { ClientSendInvitationComponent } from '../client-send-invitation/client-send-invitation.component';\nimport { AnnouncementBarComponent } from './announcement-bar/announcement-bar.component';\nimport { AnnouncementService } from './services/announcement.service';\nimport { ClientManageAssignmentsComponent } from './client-manage-assignments/client-manage-assignments.component';\nimport { UserUpgradeSubscriptionNoticeComponent } from './user-upgrade-subscription-notice/user-upgrade-subscription-notice.component';\nimport { SubscriptionDialogComponent } from './subscription-dialog/subscription-dialog.component';\nimport { SubscriptionService } from './services/subscription.service';\nimport { BillingPlansComponent } from './billing-plans/billing-plans.component';\nimport { LibraryAssetsModule } from 'app/library-assets/library-assets.module';\nimport { MessageTemplateService } from './services/message-template.service';\nimport { ClientEmbeddedViewComponent } from './client-embedded-view/client-embedded-view.component';\nimport { ClientAppointmentAssignmentEdit } from './client-appointment-assignment-edit/client-appointment-assignment-edit.component';\n\n@NgModule({\n  imports: [\n    RouterModule\n    ,SharedModule\n    ,LibraryAssetsModule\n    ,AssessmentChartsModule\n    ,ReportsModule\n    ,ThemeModule\n    ,LoginModule\n    ,FormsModule\n    ,AdminRoutingModule\n  ],\n  declarations: [\n    AdminComponent,\n    ClientListComponent,\n    ClientNewComponent,\n    ClientEditComponent,\n    AssessmentListComponent,\n    AssessmentNewComponent,\n    AssessmentEditComponent,\n    AssessmentAdminComponent,\n    QuestionSetEditComponent,\n    QuestionSetCoreFormComponent,\n    QuestionSetNewComponent,\n    QuestionNewComponent,\n    QuestionEditComponent,\n    ScaleNewComponent,\n    ScaleEditComponent,\n    AssessmentGroupEditComponent,\n    LabelNewComponent,\n    LabelEditComponent,\n    ScaleRangeNewComponent,\n    ScaleRangeEditComponent,\n    AdminShopComponent,\n    CheckoutComponent,\n    ShopItemsComponent,\n    CheckoutThankyouComponent,\n    ViewOrderComponent,\n    CartWidgetComponent,\n    MyAccountComponent,\n    OrderHistoryComponent,\n    ViewOrderPageComponent,\n    CheckoutStatusMonitorComponent,\n    AssessmentViewComponent,\n    ScalesListViewComponent,\n    QuestionSetListViewComponent,\n    AssessmentDetailsViewComponent,\n    AssessmentTokensListComponent,\n    QuestionLabelsEditComponent,\n    ClientSendInvitationComponent,\n    AnnouncementBarComponent,\n    ClientManageAssignmentsComponent,\n    UserUpgradeSubscriptionNoticeComponent,\n    SubscriptionDialogComponent,\n    BillingPlansComponent,\n    ClientEmbeddedViewComponent,\n    ClientAppointmentAssignmentEdit\n  ],\n  entryComponents: [SubscriptionDialogComponent]\n  ,providers: [ClientSearchService, AssessmentAssignerService, AnnouncementService, SubscriptionService, MessageTemplateService]\n})\nexport class AdminModule { }\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Routes } from '@angular/router';\nimport { CompaniesListComponent } from 'app/companies-admin/companies-list/companies-list.component';\nimport { CompanyNewComponent } from 'app/companies-admin/company-new/company-new.component';\nimport { CompanyEditComponent } from 'app/companies-admin/company-edit/company-edit.component';\n\nconst companyRoutes: Routes = [\n  {path: '',component: CompaniesListComponent}\n  ,{path: 'new', component: CompanyNewComponent }\n  ,{path: ':companyId/edit', component: CompanyEditComponent}\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(companyRoutes)\n  ],\n  exports: [\n    RouterModule\n  ]\n})\nexport class CompaniesAdminRoutingModule { }\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Injectable } from \"@angular/core\";\nimport { Observable ,  Subject } from \"rxjs\";\nimport { AuthService } from \"app/login/services/auth.service\";\nimport { Subscription } from \"app/shared/models/subscription\";\nimport { BillingService } from \"app/shared/services/billing.service\";\nimport { BillingDetails } from \"app/shared/models/billing-details\";\nimport { SubscriptionStatus } from \"app/shared/models/subscription-status\";\nimport { HTTPService } from \"app/shared/services/http.service\";\nimport { SystemError } from \"app/shared/models/SystemError\";\nimport { ErrorCode } from \"app/shared/models/ErrorCodes\";\nimport { SubscriptionHydratorService } from \"app/shared/services/subscription-hydrator.service\";\n\n@Injectable({\n  // we have to have this in root for the subscription dialog component to make sure it can find the service.\n  // TODO: stephen is there a better way to deal with this dependency?\n  providedIn: 'root'\n})\nexport class SubscriptionService {\n\n    private _subscriptionRequiredSubject:Subject<boolean>;\n    constructor(private authService:AuthService,\n        private billingService:BillingService\n        ,private httpService:HTTPService\n        , private subHydrator:SubscriptionHydratorService) {\n        this._subscriptionRequiredSubject = new Subject<boolean>();\n    }\n\n\n  cancelSubscription(subscription:Subscription, billingDetails:BillingDetails, reason:string) {\n    let subIndex = billingDetails.subscriptions.findIndex(s => s.id == subscription.id);\n    let sub = billingDetails.subscriptions[subIndex];\n    let subscriptionToSave:any = Object.assign({}, sub);\n    subscriptionToSave.status = SubscriptionStatus.CANCEL_PROCESSING;\n    subscriptionToSave.cancelReason = reason;\n\n    return this.authService.getCurrentUser().then(user => {\n      return this.httpService.post(\"/admin/billing/\" + user.companyID + \"/subscription/\" + subscriptionToSave.id, subscriptionToSave)\n      .then((json) => {\n        let updatedSubscription = this.subHydrator.fromJSONObject(json);\n        billingDetails.subscriptions[subIndex] = updatedSubscription;\n        this.authService.updateUserWithSubscription(updatedSubscription);\n        return billingDetails;\n      })\n      .catch(error => {\n        console.error(error);\n        if (error.status < 500) {\n          let errorResponse = error.body as any;\n          throw new SystemError(errorResponse._code, errorResponse._message);\n        } else {\n          throw new SystemError(ErrorCode.SYSTEM_ERROR, \"There was a system error in communicating with the server\");\n        }\n      })\n    });\n  }\n\n    public upgradeSubscription(subscription:Subscription, billingDetails:BillingDetails) {\n        // subscription.status = SubscriptionStatus.ACTIVE; // just fake it for now.\n\n        let subIndex = billingDetails.subscriptions.findIndex(s => s.id == subscription.id);\n        let sub = billingDetails.subscriptions[subIndex];\n        let subscriptionToSave = Object.assign(new Subscription(), sub);\n        subscriptionToSave.status = SubscriptionStatus.ACTIVE;\n        return this.authService.getCurrentUser().then(user => {\n          return this.httpService.post(\"/admin/billing/\" + user.companyID + \"/subscription/\" + subscriptionToSave.id, subscriptionToSave)\n          .then((json) => {\n            let updatedSubscription = this.subHydrator.fromJSONObject(json);\n            this.authService.updateUserWithSubscription(updatedSubscription);\n            billingDetails.subscriptions[subIndex] = updatedSubscription;\n            return billingDetails;\n          })\n          .catch(error => {\n            // TODO: stephen should we put this in the HTTP service?  It would be nice to start having the same objects on the server\n            // as we do on the client.\n            console.error(error);\n            if (error.status < 500) {\n              let errorResponse = error.body as any;\n              throw new SystemError(errorResponse._code, errorResponse._message);\n            } else {\n              throw new SystemError(ErrorCode.SYSTEM_ERROR, \"There was a system error in communicating with the server\");\n            }\n          });\n        });\n    }\n\n    public updatePastDueSubscription(subscription:Subscription, billingDetails:BillingDetails) {\n        // poll the server and check if the subscription has been processed...\n      return new Promise<BillingDetails>((resolve, reject) => {\n        let count = 0;\n        let interval = setInterval(() => {\n          if (count++ > 10) {\n            // we got nowhere...\n            clearInterval(interval);\n            resolve(billingDetails);\n            return;\n          }\n           // too tired, but something like this would work...\n           this.billingService.getBillingDetails().then(details => {\n            let updatedSub = details.subscriptions.find(s => s.id == subscription.id);\n            if (updatedSub && updatedSub.isActiveSubscription()) {\n                this.authService.updateUserWithSubscription(updatedSub);\n                clearInterval(interval);\n                resolve(details);\n            }\n          })\n          .catch(error => {\n              reject(error);\n          });\n        }, 2000)\n      });\n    }\n\n    public subscriptionRequiredEvent() : Observable<boolean> {\n        return this._subscriptionRequiredSubject;\n    }\n\n    public getSubscriptionPageRoute() : string[] {\n        return ['/admin/my-account/plans'];\n    }\n\n    public notifySubscriptionRequired() {\n        this._subscriptionRequiredSubject.next(true);\n    }\n\n    public getCurrentUserSubscription() {\n        return this.authService.getCurrentUser().then(user => {\n            return user.subscription;\n        });\n    }\n\n    public getPlanDetailsForSubscription(subscription:Subscription) {\n        let items = [];\n        if (subscription.plan && subscription.plan.unitType == 'Assessments') {\n            items.push(\"5000 Assessments per month\");\n            items.push(\"$1 per additional thousand tests\");\n            items.push(\"External hosting of assessments\");\n            items.push(\"Custom hosted assessment reports\");\n          } else {\n            items.push(\"Unlimited use of our library of research backed, valid, and reliable assessments\");\n            items.push(\"Comprehensive and personalized battery and assessment reports\")\n            items.push(\"Unlimited number of clients\");\n            items.push(\"Unlimited number of assessment batteries\");\n            items.push(\"Unlimited number of assessments\");\n            items.push(\"Assignment completion notifications\");\n          }\n        return items;\n    }\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {CompanyService} from '../../shared/services/company.service';\nimport {ActivatedRoute} from '@angular/router';\nimport {Company} from '../../shared/models/company';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-company-edit',\n  templateUrl: './company-edit.component.html',\n  styleUrls: ['./company-edit.component.css']\n})\nexport class CompanyEditComponent implements OnInit {\n  private _company:Company;\n  private _users:any;\n  private _orderStatistics:any;\n\n  constructor(private route:ActivatedRoute, private companyService:CompanyService, ) {\n    this.company = new Company();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      let companyID = params['companyId'];\n      this.companyService.getCompany(companyID).then((company) => {\n        this.company = company;\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n\n      this.companyService.getUserStatistics(companyID).then((userStats) => {\n        this._users = userStats;\n      });\n\n      this.companyService.getOrderStatistics(companyID).then((orderStats) => {\n        this._orderStatistics = orderStats;\n      });\n    });\n  }\n\n  public get users() {\n    return this._users;\n  }\n\n  public get orderStatistics() {\n    return this._orderStatistics;\n  }\n\n\tpublic get company(): Company {\n\t\treturn this._company;\n\t}\n\n\tpublic set company(value: Company) {\n\t\tthis._company = value;\n\t}\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h1 class=\"h1-responsive text-center\">{{company.name}}</h1>\n  </div>\n</div>\n<div class=\"row\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"General\">\n      <ul>\n        <li>Name: {{company.name}}</li>\n        <li>Email: {{company.email}}</li>\n        <li>Owner: {{company.user?.username}}</li>\n        <li *ngIf=\"company.sharedTokens\">Token Share Setting: Shared</li>\n        <li *ngIf=\"!company.sharedTokens\">Token Share Setting: Private</li>\n        <li>Host Site: {{company.hostSiteName}}</li>\n        <li>Send Assessments Complete Notifications: {{company.sendAssessmentsCompleteNotifications}}</li>\n        <li>Send Notifications to Primary Contact: {{company.sendNotificationsToPrimaryContact}}</li>\n      </ul>\n    </dac-tab>\n    <dac-tab heading=\"Details\">\n      <h1>System Users</h1>\n      <table class=\"table table-striped\">\n        <thead>\n          <tr>\n            <th>Username</th>\n            <th>Role</th>\n            <th># Assigned Clients</th>\n          </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let user of users\">\n          <td>{{user.username}}</td>\n          <td>{{user.role_name}}</td>\n          <td>{{user.client_count}}</td>\n        </tr>\n      </tbody>\n      </table>\n    </dac-tab>\n    <dac-tab heading=\"Order History\">\n      <table class=\"table table-striped\">\n        <tbody>\n          <tr>\n            <td>Successful Orders</td>\n            <td>{{orderStatistics.orders}}</td>\n          </tr>\n          <tr>\n            <td>Pending Orders</td>\n            <td>{{orderStatistics.pendingOrders}}</td>\n          </tr>\n          <tr>\n            <td>Failed Orders</td>\n            <td>{{orderStatistics.failedOrders}}</td>\n          </tr>\n          <tr>\n            <td>Average Revenue / Order</td>\n            <td>{{orderStatistics.revenueAverage | currency}}</td>\n          </tr>\n          <tr>\n            <td>Total Revenue</td>\n            <td>{{orderStatistics.revenue | currency}}</td>\n          </tr>\n        </tbody>\n      </table>\n    </dac-tab>\n  </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { AnnouncementService } from '../services/announcement.service';\n\n@Component({\n  selector: 'dac-announcement-bar',\n  templateUrl: './announcement-bar.component.html',\n  styleUrls: ['./announcement-bar.component.scss']\n})\nexport class AnnouncementBarComponent implements OnInit {\n  private _announcements:any[];\n\n  constructor(private announcementService:AnnouncementService) { }\n\n  ngOnInit() {\n    // for now we are just going to grab a new announcement every time we come to the client list page.\n    this.announcementService.getAnnouncements()\n    .then((announcements) => {\n      this._announcements = announcements.map(a => {\n        a.alertClass = 'alert-' + a.type;\n        return a;\n      });\n    })\n    .catch(error => {\n      console.error(error);\n    });\n  }\n\n  public get Announcements() {\n    return this._announcements;\n  }\n\n  public dismissAnnouncement(announcement:any) {\n    this._announcements = this._announcements.filter(a => a !== announcement);\n    this.announcementService.markAnnouncementRead(announcement); // even if it fails it will show up the next time and we take care of it on the server.\n\n  }\n\n}\n","<div class=\"row\" *ngFor=\"let announcement of Announcements\">\n  <div class=\"col\">\n    <div class=\"alert\" [ngClass]=\"announcement.alertClass\">\n      <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"dismissAnnouncement(announcement)\">\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      {{announcement.content}}\n      <a *ngIf=\"announcement.linkType=='external'\" [href]=\"announcement.link\" target=\"_blank\" class=\"btn btn-link btn-secondary btn-sm\">{{announcement.linkTitle}}</a>\n      <a *ngIf=\"announcement.linkType=='internal'\" [routerLink]=\"announcement.link\" class=\"btn btn-link btn-secondary btn-sm\">{{announcement.linkTitle}}</a>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2023 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\n\nimport { Component, OnDestroy, OnInit } from \"@angular/core\";\nimport { DacConfig } from \"app/shared/services/dac-config.service\";\n\n@Component({\n  selector: 'dc-client-embedded-view',\n  templateUrl: './client-embedded-view.component.html'\n})\nexport class ClientEmbeddedViewComponent implements OnInit,OnDestroy {\n\n  constructor(private dacConfig:DacConfig) {\n  }\n  ngOnInit(): void {\n    // this.dacConfig.setupSeamlessModeForSession();\n  }\n  ngOnDestroy(): void {\n      // this.dacConfig.clearSeamlessModeForSession();\n  }\n\n}\n","<div>\n  <input type=\"button\" class=\"btn btn-primary\" value=\"Chart to Encounters\" />\n  <router-outlet></router-outlet>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport { AssessmentService } from \"../../shared/services/assessment.service\";\nimport { QuestionSet } from \"../../shared/models/question-set\";\nimport { QuestionSetLabel } from \"../../shared/models/question-set-label\";\nimport { Question } from \"../../shared/models/question\";\nimport { SaveMessages } from \"../../shared/models/save-messages\";\nimport { Assessment } from \"../../shared/models/assessment\";\nimport { DisplayCondition } from \"../../shared/models/display-condition\";\nimport { QuestionSetType } from \"../../shared/models/question-set-type\";\n@Component({\n  selector: 'app-question-set-edit',\n  templateUrl: './question-set-edit.component.html',\n  styleUrls: ['./question-set-edit.component.css']\n})\nexport class QuestionSetEditComponent implements OnInit {\n\n\tprivate _questionSet:QuestionSet;\n\tprivate assessment:Assessment;\n\n  constructor(\n    private _assessmentService:AssessmentService\n    ,private route:ActivatedRoute\n    ,private router:Router\n\t\t,private location:Location\n\t\t,private alertService:AlertService\n  ) {\n    this.questionSet = new QuestionSet();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      let setId = params['setId'];\n      this._assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this.assessment = assessment;\n          this.questionSet = assessment.question_sets.find((s) => s.id == setId);\n\t\t\t\t\tconsole.log(this.questionSet);\n          if (!this.questionSet) {\n            // TODO: stephen should we navigate back?? or do some kind of 404?\n            this.router.navigate([\"not-found\"]);\n          }\n        });\n    });\n  }\n\n\tget Assessment() {\n\t\treturn this.assessment;\n\t}\n\n\tpublic hasConditions(questionSet:QuestionSet) {\n\t\treturn questionSet.display_conditions && questionSet.display_conditions.length > 0;\n\t}\n\n\tpublic toggleCondition(questionSet:QuestionSet) {\n\t\tif (this.hasConditions(questionSet)) {\n\t\t\tquestionSet.display_conditions = [];\n\t\t}\n\t\telse {\n\t\t\t// set it with a new display condition\n\t\t\tquestionSet.display_conditions.push(new DisplayCondition());\n\t\t}\n\t}\n\n\tget Condition() : DisplayCondition {\n\t\treturn this._questionSet.display_conditions[0];\n\t}\n\n  get questionSet() : QuestionSet {\n    return this._questionSet;\n  }\n\n  set questionSet(v:QuestionSet) {\n    this._questionSet = v;\n  }\n\n  goBack() {\n    this.location.back();\n  }\n\n\tmoveDownLabel(label:QuestionSetLabel) {\n\t\tthis.questionSet.shiftLabelDown(label);\n\t\tthis.save();\n\t}\n\n\tmoveUpLabel(label:QuestionSetLabel) {\n\t\tthis.questionSet.shiftLabelUp(label);\n\t\tthis.save();\n\t}\n\n\tmoveUpQuestion(question:Question) {\n\t\tthis.questionSet.shiftQuestionUp(question);\n\t\tthis.save();\n\t}\n\n\tmoveDownQuestion(question:Question) {\n\t\tthis.questionSet.shiftQuestionDown(question);\n\t\tthis.save();\n\t}\n\n\tsave() {\n\t\tthis._assessmentService.saveAssessment(this.assessment).then((assessment) => {\n\t\t\t\tthis.alertService.success(\"Question Set saved\");\n    }).catch((error) => {\n\t\t\tthis.alertService.error(\"Question Set failed to save.  Please try again or contact customer support.\");\n      console.error(error);\n    });\n\t}\n\n\tdeleteQuestion(question) {\n\t\tif (!confirm(\"Are you sure you want to delete this question?\")) {\n\t\t\treturn;\n\t\t}\n\t\tthis.questionSet.removeQuestion(question);\n\t\t// TODO: stephen need messaging for removing a question, at least if it fails\n    this.saveDeleteItem(this.assessment);\n\t}\n\n\tdeleteLabel(label) {\n\t\tif (!confirm(\"Are you sure you want to delete this label?\")) {\n\t\t\treturn;\n\t\t}\n\t\tthis.questionSet.removeLabel(label);\n\t\tthis.saveDeleteItem(this.assessment);\n\t}\n\n\tshowQuestionLabelsForType(type) {\n\t\tif (type != QuestionSetType[type]) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n  private saveDeleteItem(assessment) {\n    this._assessmentService.saveAssessment(this.assessment).then((assessment) => {\n\t\t\tthis.alertService.error(\"Item deleted.\");\n    }).catch((error) => {\n\t\t\tthis.alertService.error(\"Failed to delete item.  Please try again or contact customer support.\");\n      console.error(error);\n\t\t});\n  }\n\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">{{questionSet.title}}</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <dac-tabs class=\"col-12\">\n    <dac-tab heading=\"General\">\n      <app-question-set-core-form [questionSet]=\"questionSet\"></app-question-set-core-form>\n      <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n    </dac-tab>\n    <dac-tab heading=\"Labels\" *ngIf=\"showQuestionLabelsForType(questionSet.display_type)\"\n      class=\"labelsContainer\">\n      <a [routerLink]=\"['label','new']\" type=\"button\" class=\"btn btn-primary\">New Label</a>\n      <p class=\"alert alert-info\" *ngIf=\"!questionSet.labels.length\">There are no labels.</p>\n      <table class=\"table table-striped\" *ngIf=\"questionSet.labels.length\">\n        <thead class=\"primary-color text-white\">\n          <tr>\n            <th *ngFor=\"let name of ['Label', 'Answer Value', 'Actions']\">{{name}}</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let label of questionSet.labels;let index = index;let first = first;let last=last;\">\n            <td class=\"50\">{{label.label}}</td>\n            <td>{{questionSet.answer_start_value + index}}</td>\n            <td class=\"25\">\n              <button (click)=\"moveUpLabel(label)\" [disabled]=\"first\" type=\"button\" class=\"btn btn-primary btn-sm\"\n                aria-label=\"Up\">\n                <span class=\"fa fa-arrow-up\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"moveDownLabel(label)\" [disabled]=\"last\" type=\"button\" class=\"btn btn-primary btn-sm\"\n                aria-label=\"Down\">\n                <span class=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>\n              </button>\n              <button [routerLink]=\"['label', label.id, 'edit']\" type=\"button\" class=\"btn btn-primary btn-sm\"\n                aria-label=\"Edit\">\n                <span class=\"fa fa-edit\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"deleteLabel(label)\" type=\"button\" class=\"btn btn-secondary btn-sm\" aria-label=\"Delete\">\n                <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </dac-tab>\n    <dac-tab heading=\"Questions\" class=\"questionsContainer\">\n      <a [routerLink]=\"['question','new']\" type=\"button\" class=\"btn btn-primary\">New Question</a>\n      <p class=\"alert alert-info\" *ngIf=\"!questionSet.questions.length\">There are no questions.</p>\n      <table class=\"table table-striped\" *ngIf=\"questionSet.questions.length\">\n        <thead class=\"primary-color text-white\">\n          <tr>\n            <th *ngFor=\"let name of ['', 'Question', 'Reversed', 'Flagged', 'Scale', 'Actions']\">{{name}}</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let question of questionSet.questions; let index = index;let first=first; let last=last;\">\n            <td class=\"col-xs-1\">{{index+1}}.\n              <!--<td>{{question.id}}</td>-->\n            <td class=\"col-xs-5\">{{question.prompt}}</td>\n            <td>\n              <span *ngIf=\"question.is_reversed\">Yes</span>\n              <span *ngIf=\"!question.is_reversed\">No</span>\n            </td>\n            <td>\n              <span *ngIf=\"question.hasFlagCondition\">Yes</span>\n              <span *ngIf=\"!question.hasFlagCondition\">No</span>\n            </td>\n            <td class=\"col-xs-2\">{{question?.assessment_scale?.name}}</td>\n            <td class=\"col-xs-4\">\n              <button (click)=\"moveUpQuestion(question)\" [disabled]=\"first\" type=\"button\" class=\"btn btn-primary btn-sm\"\n                aria-label=\"Up\">\n                <span class=\"fa fa-arrow-up\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"moveDownQuestion(question)\" [disabled]=\"last\" type=\"button\"\n                class=\"btn btn-primary btn-sm\" aria-label=\"Down\">\n                <span class=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>\n              </button>\n              <button [routerLink]=\"['question',question.id,'edit']\" type=\"button\" class=\"btn btn-primary btn-sm\"\n                aria-label=\"Edit\">\n                <span class=\"fa fa-edit\" aria-hidden=\"true\"></span>\n              </button>\n              <button (click)=\"deleteQuestion(question)\" type=\"button\" class=\"btn btn-secondary btn-sm\"\n                aria-label=\"Delete\">\n                <span class=\"fa fa-trash\" aria-hidden=\"true\"></span>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </dac-tab>\n    <dac-tab heading=\"Advanced\">\n      <div class=\"row\">\n        <div class=\"form-group col\">\n          <input id=\"condition-display\" type=\"checkbox\" [checked]=\"hasConditions(questionSet)\"\n            (click)=\"toggleCondition(questionSet)\" />\n          <label for=\"condition-display\">Conditionally Display?</label>\n        </div>\n      </div>\n      <div class=\"row\">\n        <condition-edit *ngIf=\"hasConditions(questionSet)\" class=\"col p-2\" [condition]=\"Condition\"\n          [assessment]=\"Assessment\"></condition-edit>\n      </div>\n      <div class=\"row\">\n        <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n      </div>\n    </dac-tab>\n  </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { User } from \"../../shared/models/user\";\nimport { UserService } from \"../../shared/services/user.service\";\nimport { Role } from \"../../shared/models/role\";\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { AuthService } from 'app/login/services/auth.service';\n\n@Component({\n  selector: 'app-user-edit',\n  templateUrl: './user-edit.component.html',\n  styleUrls: ['./user-edit.component.css']\n})\nexport class UserEditComponent implements OnInit {\n  private _user:User;\n  public passwordChange:string;\n  public confirmPassword:string;\n  public isSaving:boolean;\n\n  public canArchive:boolean;\n\n  public get User() {\n    return this._user;\n  }\n  public set User(v:User) {\n    this._user = v;\n  }\n\n  constructor(private userService:UserService, private route:ActivatedRoute\n    , private alertService:AlertService, private authService:AuthService) {\n      this.passwordChange = \"\";\n      this.confirmPassword = \"\";\n    this._user = new User();\n    this.isSaving = false;\n    this.canArchive = true;\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      let userId = params['userId'];\n      let editUser = this.userService.getUser(userId);\n      let currentUser = this.authService.getCurrentUser();\n      Promise.all([editUser, currentUser]).then((results) => {\n        let [user, currentUser] = results;\n        this._user = user;\n        if (user.id == currentUser.id) {\n          this.canArchive = false;\n        } else if (user.role <= Role.Owner) {\n          this.canArchive = false;\n        }\n      });\n\n      // TODO: stephen handle not found user...\n    });\n  }\n\n  private validateForm() {\n    let errors = [];\n    // nothing to do here as the passwords don't matter.\n    if (!(this.passwordChange && this.confirmPassword)) {\n      return errors;\n    }\n    if (this.passwordChange != this.confirmPassword) {\n      errors.push(\"Your passwords don't match\");\n    }\n    let passwordPolicyMsg = \"Password must be 8 characters or more, contain at least one number(0-9), one uppercase letter(a-z), and one lowercase letter(A-Z)\";\n    let password = this.passwordChange;\n    if (!password || password.length < 8) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[0-9]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[A-Z]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    else if (!password.match(/[a-z]+/)) {\n      errors.push(passwordPolicyMsg);\n    }\n    return errors;\n  }\n\n  public save() {\n    let errors = this.validateForm();\n    if (errors.length) {\n      this.alertService.error(errors.join(\"\\n\"), 3000);\n      return;\n    }\n    if (this.passwordChange.trim() != \"\") {\n      this._user.password = this.passwordChange;\n    }\n    this.userService.saveUser(this._user).then(response => {\n      this.alertService.success(\"User saved!\");\n    })\n    .catch(error => {\n      if (error._code == 'DUP_ENTRY') {\n        this.alertService.error(error.message);\n      } else {\n        this.alertService.error(\"User failed to save.  Please try again or contact support!\");\n      }\n    });\n  }\n\n  public archiveUser() {\n    if (confirm(\"Are you sure you wish to archive this user?\")) {\n      this.userService.archiveUser(this._user);\n    }\n  }\n\n  public restoreUser() {\n    this.userService.restoreUser(this._user);\n  }\n\n  public setUserRole(role:Role) {\n    console.log(\"setting user's role to \", role);\n    this._user.role = role;\n  }\n\n}\n\n","<div class=\"row\">\n    <div class=\"col-1\">\n        <app-back-button></app-back-button>\n    </div>\n    <div class=\"col\">\n        <h1 class=\"h1-responsive text-center\">{{User.username}}</h1>\n    </div>\n</div>\n<div class=\"row\">\n    <dac-tabs class=\"col-12\">\n        <dac-tab heading=\"General\">\n            <div class=\"form-horizontal\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"username\">Email:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <b>{{User.username}}</b>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"username\">First Name:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <input class=\"form-control\" id=\"firstName\" type=\"text\" [(ngModel)]=\"User.firstName\" [disabled]=\"!User.enabled\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"lastName\">Last Name:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10\">\n                        <input class=\"form-control\" id=\"lastName\" type=\"text\" [(ngModel)]=\"User.lastName\" [disabled]=\"!User.enabled\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"password\">Password:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                        <input class=\"form-control\" id=\"password\" type=\"password\" [(ngModel)]=\"passwordChange\" [disabled]=\"!User.enabled\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"confirmPassword\">Confirm Password:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                        <input id=\"confirmPassword\" type=\"password\" class=\"form-control\" [(ngModel)]=\"confirmPassword\" [disabled]=\"!User.enabled\" />\n                    </div>\n                </div>\n\n                <div class=\"form-group\">\n                    <label class=\"col-sm-12 col-md-6 col-lg-2\" for=\"roleSelector\">Role:</label>\n                    <div class=\"col-sm-12 col-md-6 col-lg-10 \">\n                        <app-role-selector id=\"roleSelector\" [role]=\"User.role\" (selected)=\"setUserRole($event)\" [disabled]=\"!User.enabled\"></app-role-selector>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col-sm-8\">\n                        <input [disabled]=\"isSaving || !User.enabled\" class=\"btn btn-primary\" type=\"button\" value=\"Save\" (click)=\"save()\" />\n                    </div>\n                    <div class=\"col-sm-4\" *ngIf=\"User.enabled\">\n                        <button aria-label=\"Archive User\" title=\"Archive User\" class=\"btn btn-primary\" type=\"button\" tabindex=\"0\" (click)=\"archiveUser()\" [disabled]=\"!canArchive\">\n                            <span aria-hidden=\"true\" class=\"fa fa-archive\"></span>\n                        </button>\n                        <small><b>Archive User</b> - This will disable the user from logging in</small>\n                    </div>\n                    <div class=\"col-sm-4\" *ngIf=\"!User.enabled\">\n                        <button aria-label=\"Restore User\" class=\"btn btn-primary\" title=\"Restore User From Archive\" type=\"button\" tabindex=\"0\" (click)=\"restoreUser()\">\n                            <span aria-hidden=\"true\" class=\"fa fa-undo\"></span>\n                        </button>\n                        <small><b>Restore User</b> - This will enable the user to login again.</small>\n                    </div>\n                </div>\n            </div>\n        </dac-tab>\n    </dac-tabs>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { CompaniesListComponent } from './companies-list/companies-list.component';\nimport { CompanyNewComponent } from './company-new/company-new.component';\nimport { CompanyEditComponent } from './company-edit/company-edit.component';\nimport { CompaniesAdminRoutingModule } from 'app/companies-admin/companies-admin-routing.module';\nimport { SharedModule } from 'app/shared/shared.module';\n\n@NgModule({\n  imports: [\n    CompaniesAdminRoutingModule\n    ,SharedModule\n  ],\n  declarations: [CompaniesListComponent, CompanyNewComponent, CompanyEditComponent]\n})\nexport class CompaniesAdminModule { }\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { BillingDetails } from 'app/shared/models/billing-details';\nimport { BillingService } from 'app/shared/services/billing.service';\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { DacConfig } from 'app/shared/services/dac-config.service';\nimport { Subscription } from 'app/shared/models/subscription';\nimport { SubscriptionService } from '../services/subscription.service';\nimport { MetricsService } from 'app/shared/services/metrics.service';\nimport { SystemError } from 'app/shared/models/SystemError';\nimport { ErrorCode } from 'app/shared/models/ErrorCodes';\n\n@Component({\n  selector: 'dac-billing-plans',\n  templateUrl: './billing-plans.component.html',\n  styleUrls: ['./billing-plans.component.scss']\n})\nexport class BillingPlansComponent implements OnInit {\n  private billingDetails:BillingDetails;\n  public loading:boolean;\n  public upgrading:boolean;\n  public subscriptionAlertMessage:string;\n\n  public canceling:boolean;\n  public cancelConfirm:boolean;\n  public cancelFinalized:boolean;\n  public cancelReason:string;\n\n  @ViewChild(\"cancelOtherReason\") cancelOtherReason:ElementRef;\n\n  private readonly METRICS_CATEGORY = 'SubscriptionUpgrade';\n  public cancellationReasons:{id:string,label:string}[] = [\n    {id:'tooExpensive', 'label': 'Your product is too expensive'}\n    ,{id:'understandHowToUse', 'label': 'I dont understand how to use your product'}\n    ,{id:'betterProduct', 'label': 'I found something else I like better'}\n    ,{id:'missingKeyFeature', 'label': 'Youre missing a key feature I need'}\n    ,{id:'notUsingIt', 'label': 'I dont use it like I thought I would'}\n    ,{id:'notMyDecision', 'label': 'Its not my decision (someone else is having me cancel)'}\n    ,{id:'tooBuggy', 'label': 'Your product has too many glitches or technical problems'}\n    ,{id:'subscribeLater', 'label': \"I'm not using this now but I plan on subscribing at a later point in time\"}\n    ,{id:'cantAfford', 'label': \"I can't afford this right now\"}\n  ];\n\n  constructor(private billingService:BillingService\n  ,private alertService:AlertService\n  ,private dacConfig:DacConfig\n  ,private subService:SubscriptionService\n  ,private metrics:MetricsService) {\n    this.billingDetails = new BillingDetails();\n  }\n\n  get hasSubscription() {\n    return this.billingDetails.subscriptions.length > 0;\n  }\n\n  get stripeChargeName() {\n    return this.dacConfig.stripe_charge_name;\n  }\n\n  ngOnInit() {\n    this.loading = true;\n    this.billingService.getBillingDetails()\n    .then(details => {\n      this.billingDetails = details\n      this.loading = false;\n    })\n    .catch((error) => {\n      this.loading = false;\n      console.error(error);\n      this.metrics.trackEvent(this.METRICS_CATEGORY, 'ngOnInit', 'failed to get billing details');\n      this.alertService.error(\"Failed to retrieve billing details from server.  Check your network connection and refresh the page.\");\n    });\n  }\n\n  upgradeTrialSubscription(subscription:Subscription) {\n    this.subscriptionAlertMessage = null;\n    this.upgrading = true;\n\n    // collect the payment credentials and update the card\n    this.billingService.updateDefaultBillingCard(this.billingDetails)\n    .then((updatedBillingDetails) => {\n      this.billingDetails = updatedBillingDetails;\n      //\n      this.alertService.info(\"Billing card saved. Upgrading Subscription...\");\n      this.subService.upgradeSubscription(subscription, this.billingDetails)\n      .then(billingDetails => {\n        this.metrics.trackEvent(this.METRICS_CATEGORY, 'upgradeTrialSubscription', 'subscription upgrade success');\n        this.billingDetails = billingDetails;\n        this.alertService.success(\"Subscription upgraded!\");\n        this.upgrading = false;\n      })\n      .catch((error:SystemError) => {\n        this.upgrading = false;\n        this.subscriptionAlertMessage = error.message;\n        this.metrics.trackEvent(this.METRICS_CATEGORY, 'upgradeTrialSubscription', 'subscription upgrade failed ' + error.message);\n      })\n      // need to send subscription to server\n      // end the free subscription\n    })\n    .catch((error) => {\n      this.upgrading = false;\n      if (error.code && error.code == 'canceled') {\n        this.metrics.trackEvent(this.METRICS_CATEGORY, 'upgradeTrialSubscription', 'billing card update canceled by customer');\n        this.subscriptionAlertMessage = \"Billing card update was canceled.  A valid billing card must be provided before subscription can be upgraded\";\n      } else {\n        console.error(error);\n        this.metrics.trackEvent(this.METRICS_CATEGORY, 'upgradeTrialSubscription', 'billing card update failed');\n        this.subscriptionAlertMessage = \"There was an unexpected error in saving your billing card. Please try again or contact customer support\";\n      }\n\n      this.alertService.error(\"There was an error in saving your billing card. Please try again or contact customer support\");\n    });\n  }\n\n  updatePastDueBillingDetails(subscription:Subscription) {\n    this.upgrading = true;\n    this.subscriptionAlertMessage = null;\n    this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails');\n    this.billingService.updateDefaultBillingCard(this.billingDetails)\n    .then((updatedBillingDetails) => {\n      this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Card update success');\n      this.billingDetails = updatedBillingDetails;\n\n      this.alertService.info(\"Billing card saved. Upgrading subscription payment...\");\n      this.subService.updatePastDueSubscription(subscription, updatedBillingDetails)\n      .then((billingDetails) => {\n        this.upgrading = false;\n        this.billingDetails = billingDetails;\n        let updatedSub = billingDetails.subscriptions.find(s => s.id == subscription.id);\n        if (updatedSub && updatedSub.isUnpaidSubscription()) {\n          this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Subscription past-due');\n          this.subscriptionAlertMessage = \"Our card processor could not immediately charge this card.  We will continue to attempt to charge this card over the next few hours, or you can try a different card.  Most cards should process within 24 hours.  Contact your card provider or our support for more assistance.\";\n\n        } else if (updatedSub && updatedSub.isActiveSubscription()) {\n          this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Subscription active');\n          this.alertService.success(\"Subscription activated!\");\n        } else {\n          this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Subscription state other');\n          this.alertService.error(\"There was an error in processing your subscription upgrade.  Contact support for assistance\");\n        }\n      })\n      .catch((error) => {\n        this.upgrading = false;\n        this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Subscription update failed');\n        this.alertService.error(\"There was an error in processing your subscription upgrade.  Contact support for assistance\");\n        console.error(error);\n      });\n      // end the free subscription\n    })\n    .catch((error) => {\n      this.upgrading = false;\n      this.metrics.trackEvent(this.METRICS_CATEGORY, 'updatePastDueBillingDetails', 'Card update failed');\n      console.error(error);\n      this.alertService.error(\"There was an error in saving your billing card. Please try again or contact customer support\");\n    });\n  }\n\n  activateSubscription(subscription:Subscription) {\n    // activate the subscription\n    // TODO: stephen do we want to support this?\n  }\n\n  startCancellation(subscription:Subscription) {\n    this.cancelConfirm = true;\n    this.canceling = true;\n    this.cancelReason = null;\n  }\n\n  cancelSubscription(subscription:Subscription) {\n    if (!this.cancelReason) {\n      this.alertService.error(\"Please provide a reason for why you are cancelling.\");\n      console.error(\"No reason was selected but cancelSubscription called\");\n      return;\n    }\n    let cancelReason = this.cancelReason;\n    if (cancelReason == 'Other') {\n      cancelReason = this.cancelOtherReason.nativeElement.value;\n      if (cancelReason.trim() == \"\") {\n        this.alertService.error(\"Please provide a reason for why you are cancelling.\");\n        return;\n      } else {\n        cancelReason = \"Other: \" + cancelReason;\n      }\n    }\n    else {\n      let chosenReason = this.cancellationReasons.find(cr => cr.id == cancelReason);\n      if (!chosenReason) {\n        this.alertService.error(\"Please provide a reason for why you are cancelling.\");\n        console.error(\"A reason provided, but was not in the cancellation array\");\n        return;\n      }\n      cancelReason = chosenReason.label;\n    }\n\n\n    console.log(\"Cancel reason is: \", cancelReason);\n    this.subService.cancelSubscription(subscription, this.billingDetails, cancelReason)\n    .then((billingDetails) => {\n      this.billingDetails = billingDetails;\n      this.cancelConfirm = false;\n      this.canceling = false;\n    })\n    .catch((error:SystemError) => {\n      console.error(error);\n      this.alertService.error(error.message);\n    });\n  }\n\n  keepSubscription(subscription:Subscription) {\n    this.cancelConfirm = false;\n    this.canceling = false;\n  }\n\n  isCancelChecked(reason:string) {\n    return this.cancelReason == reason;\n  }\n\n  setCancelReason(reason:string) {\n    this.cancelReason = reason;\n  }\n\n  hasCancelReason() {\n    return this.cancelReason !== null;\n  }\n\n  getPlanItems(subscription:Subscription) {\n    return this.subService.getPlanDetailsForSubscription(subscription);\n  }\n\n  get Billing() {\n    return this.billingDetails;\n  }\n\n  get supportEmail() {\n    return this.dacConfig.supportEmail;\n  }\n\n}\n","<div class=\"row\" *ngIf=\"loading\">\n  <div class=\"col\">\n    <div class=\"alert alert-warning\">Loading... <app-spin-icon></app-spin-icon>\n    </div>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"!loading\">\n  <div class=\"col\">\n    <div class=\"row\">\n      <div class=\"card card-cascade wider col-md-10 col-lg-8 col-12 mb-3 ml-auto mr-auto\" *ngFor=\"let subscription of Billing.subscriptions\">\n        <div class=\"view gradient-card-header secondary-gradient\">\n          <h4>{{subscription.plan?.name}}</h4>\n        </div>\n\n        <div class=\"card-body text-center light-text\" *ngIf=\"canceling\">\n          <div *ngIf=\"cancelConfirm\">\n            <h4>\n              We're sorry to see you go!\n            </h4>\n            <div>\n              <h5>I am cancelling because...</h5>\n              <ul class=\"text-left list-group\">\n                <li class=\"list-group-item\" *ngFor=\"let reason of cancellationReasons\">\n                  <input type=\"radio\" value=\"reason.id\" class=\"form-control\" (click)=\"setCancelReason(reason.id)\" [checked]=\"isCancelChecked(reason.id)\">\n                  <label for=\"reason.id\" class=\"form-check-label\" (click)=\"setCancelReason(reason.id)\">{{reason.label}}</label>\n                </li>\n                <li class=\"list-group-item\">\n                  <input type=\"radio\" id=\"cancel-other\" class=\"form-control\" [checked]=\"isCancelChecked('Other')\" (click)=\"setCancelReason('Other')\">\n                  <label for=\"cancel-other\" (click)=\"setCancelReason('Other')\"><input #cancelOtherReason type=\"text\" placeholder=\"Other....\" class=\"form-control\" /></label>\n                </li>\n              </ul>\n              <p class=\"alert alert-warning\">\n                We want to make you aware that by cancelling your membership subscription, your clients and all other user accounts connected with this subscription will have their access terminated at\n                the end of your billing period.  You will continue to have services and access to your account data until <b>{{subscription.currentPeriodEnd|date:'mediumDate'}}</b>.\n                For more information regarding membership subscription cancellation refer to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>.\n              </p>\n              <input type=\"button\" value=\"Keep Subscription\" class=\"btn btn-success\" (click)=\"keepSubscription(subscription)\" />\n              <input type=\"button\" value=\"Cancel Subscription\" class=\"btn btn-danger\" (click)=\"cancelSubscription(subscription)\" [disabled]=\"!hasCancelReason()\" />\n            </div>\n          </div>\n        </div>\n\n        <div class=\"card-body text-center light-text\" *ngIf=\"!canceling\">\n\n          <h4>{{subscription.getChargeDescription()}}</h4>\n\n          <div class=\"text-left\" *ngIf=\"subscription.status == 'cancel-processing'\">\n            <div class=\"text-center\">\n              <div class=\"pt-2\"><p class=\"alert alert-warning\">You will continue to have access to the service and all of your account data under this membership subscription until <b>{{subscription.currentPeriodEnd|date:'mediumDate'}}</b>.</p></div>\n            </div>\n            <p>Your cancellation request has been submitted and will be processed by our team within the next available business day.\n              Any outstanding account balance will be submitted to the contact information we have on file for you.</p>\n            <p>If this is your only active membership subscription with us your account will be terminated in accordance with our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a></p>\n            <p>For questions about your account cancellation or billing please contact us at {{supportEmail}}.</p>\n            <p>For more information regarding account cancellation refer to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>.</p>\n          </div>\n\n          <div *ngIf=\"subscription.status == 'active'\">\n            <h6>Your credit card will be charged {{subscription.total|currency}} on\n              {{subscription.renewalDate|date:'mediumDate'}}</h6>\n            <div class=\"text-center\">\n              <div class=\"pt-2\"><p class=\"alert alert-warning\">If you cancel your membership subscription you will have services\n                  until\n                  {{subscription.currentPeriodEnd|date:'mediumDate'}}</p></div>\n            </div>\n            <h5><b>Included in this plan</b></h5>\n            <ul class=\"text-left list-group mb-2\">\n              <li class=\"list-group-item\" *ngFor=\"let planItem of getPlanItems(subscription)\"><i class=\"fa fa-check text-success pr-3\"></i>{{planItem}}</li>\n            </ul>\n            <div class=\"text-center\">\n              <p>If you no longer wish to continue your subscription you may cancel by pressing the button below.</p>\n              <input type=\"button\" class=\"btn btn-danger\" value=\"Cancel Subscription\" (click)=\"startCancellation(subscription)\" />\n            </div>\n            <p>\n              If you have questions about or need help changing your membership subscription please contact us at {{supportEmail}}.\n            </p>\n          </div>\n\n          <!-- trial subscription-->\n          <div class=\"text-center\" *ngIf=\"subscription.status == 'trialing'\">\n            <input type='button' *ngIf=\"!upgrading\" value=\"Upgrade Membership\" class=\"btn btn-success btn-lg\" (click)=\"upgradeTrialSubscription(subscription)\" />\n            <button class=\"btn btn-info btn-lg\" disabled *ngIf=\"upgrading\">Upgrading...</button><app-spin-icon *ngIf=\"upgrading\"></app-spin-icon>\n            <p class=\"alert alert-danger\" *ngIf=\"subscriptionAlertMessage\">\n              We ran into problems upgrading your membership subscription.  This can occur due to a problem with your billing card or in attempting to\n              communicating with our servers. You can resolve this by choosing a valid billing card, contacting\n              your card provider, or trying to upgrade later.  If you continue to have issues contact our support team.  The specific error returned was:<br />\n              <b>{{subscriptionAlertMessage}}</b>\n            </p>\n            <h3>Only <b class=\"text-success\">{{subscription.plan.amountPerUnit|currency}}</b> per\n              {{subscription.plan.getSingularUnitType()|lowercase}} per {{subscription.billingInterval}}</h3>\n            <p class='alert alert-warning'>Your membership trial period\n              will end on <b class=\"text-red\">{{subscription.currentPeriodEnd|date:'mediumDate'}}</b>.</p>\n            <p class=\"text-left\">By upgrading your membership subscription plan you will be asked to provide a valid billing\n              credit card for your account.\n              Upon adding your card, your billing card will be immediately charged by {{stripeChargeName}} for a total of\n              <b>{{subscription.total|currency}}</b> for {{subscription.quantity}} {{subscription.plan.getUnitTypeNameForQuantity(subscription.quantity)}}.\n\n              Your membership subscription will be renewed on each subsequent {{subscription.billingInterval}} until you cancel.\n              You will be able to cancel your subscription at any point in time on this page or by contacting\n              us at our support email.\n\n              For more information refer to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a></p>\n              <h5><b>Included in this plan</b></h5>\n              <ul class=\"text-left list-group mb-2\">\n                <li class=\"list-group-item\" *ngFor=\"let planItem of getPlanItems(subscription)\"><i class=\"fa fa-check text-success pr-3\"></i>{{planItem}}</li>\n              </ul>\n              <div class=\"text-center\">\n                <p>If you no longer wish to continue your free trial you may cancel by pressing the button below.</p>\n                <input type=\"button\" class=\"btn btn-danger\" value=\"Cancel Subscription\" (click)=\"startCancellation(subscription)\" />\n              </div>\n              <p>\n                If you have questions about or need help changing your membership subscription please contact us at {{supportEmail}}.\n              </p>\n          </div>\n\n          <!-- trial-ended subscription-->\n          <div class=\"text-center\" *ngIf=\"subscription.status == 'trial-ended'\">\n            <input type='button' *ngIf=\"!upgrading\" value=\"Upgrade Membership\" class=\"btn btn-success btn-lg\" (click)=\"updatePastDueBillingDetails(subscription)\" />\n            <button class=\"btn btn-info btn-lg\" disabled *ngIf=\"upgrading\">Upgrading...</button><app-spin-icon *ngIf=\"upgrading\"></app-spin-icon>\n            <p class=\"alert alert-danger\" *ngIf=\"subscriptionAlertMessage\">\n              We ran into problems upgrading your membership subscription.  This can occur due to a problem with your billing card or in attempting to\n              communicating with our servers. You can resolve this by choosing a valid billing card, contacting\n              your card provider, or trying to upgrade later.  If you continue to have issues contact our support team.  The specific error returned was:<br />\n              <b>{{subscriptionAlertMessage}}</b>\n            </p>\n            <h3>Only <b class=\"text-success\">{{subscription.plan.amountPerUnit|currency}}</b> per\n              {{subscription.plan.getSingularUnitType()|lowercase}} per {{subscription.billingInterval}}</h3>\n            <p class='alert alert-danger'>\n              Your membership subscription trial period ended on <b class=\"text-red\">{{subscription.currentPeriodEnd|date:'mediumDate'}}</b>.\n              To continue full use of your membership upgrade today.\n            </p>\n            <p class=\"text-left\">By upgrading your membership subscription plan you will be asked to provide a valid billing\n              credit card for your account.\n              Upon adding your card, your billing card will be immediately charged by {{stripeChargeName}} for a total of\n              <b>{{subscription.total|currency}}</b> for {{subscription.quantity}} {{subscription.plan.getUnitTypeNameForQuantity(subscription.quantity)}}.\n\n              Your membership subscription will be renewed on each subsequent {{subscription.billingInterval}} until you cancel.\n              You will be able to cancel your subscription at any point in time on this page or by contacting\n              us at our support email.\n\n              For more information refer to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a></p>\n              <h5><b>Included in this plan</b></h5>\n              <ul class=\"text-left list-group mb-2\">\n                <li class=\"list-group-item\" *ngFor=\"let planItem of getPlanItems(subscription)\"><i class=\"fa fa-check text-success pr-3\"></i>{{planItem}}</li>\n              </ul>\n              <p>\n                If you have questions about or need help changing your membership subscription please contact us at {{supportEmail}}.\n              </p>\n          </div>\n\n          <!-- past-due subscription-->\n          <div class=\"text-center\" *ngIf=\"subscription.isUnpaidSubscription()\">\n            <h6>Past due balance of {{subscription.total|currency}} due on\n              {{subscription.renewalDate|date:'mediumDate'}}</h6>\n            <div class=\"alert alert-danger\">\n              <p>We've made several attempts to charge your billing card on file.  Please update your card to avoid having\n              your membership subscription canceled.  Failure to update your billing card will result in the termination of your account\n              in accordance with our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>.</p>\n              <div *ngIf=\"subscriptionAlertMessage\">\n                <p *ngIf=\"subscriptionAlertMessage\"><b>Payment Failed</b></p>\n                <hr />\n                <p *ngIf=\"subscriptionAlertMessage\">{{subscriptionAlertMessage}}</p>\n              </div>\n            </div>\n            <input type='button' *ngIf=\"!upgrading\" value=\"Update Billing Card\" class=\"btn btn-success btn-lg\" (click)=\"updatePastDueBillingDetails(subscription)\" />\n            <button class=\"btn btn-info btn-lg\" disabled *ngIf=\"upgrading\">Processing...</button><app-spin-icon *ngIf=\"upgrading\"></app-spin-icon>\n            <p>Updating your billing card will charge your account for the past due balance of <b>{{subscription.total|currency}}</b>\n              for {{subscription.quantity}} {{subscription.plan.getUnitTypeNameForQuantity(subscription.quantity)}}.</p>\n\n              <!-- TODO: stephen If after 15-20 seconds we couldn't get a status update that the subscription had become active\n                   We need to display a message that the system is processing the card and to check back in 1-2 hours\n                   to verify their payment credentials were valid.\n              -->\n            <h5><b>Included in this plan</b></h5>\n            <ul class=\"text-left list-group mb-2\">\n              <li class=\"list-group-item\" *ngFor=\"let planItem of getPlanItems(subscription)\"><i class=\"fa fa-check text-success pr-3\"></i>{{planItem}}</li>\n            </ul>\n            <p>\n              If you have questions about or need help changing your membership subscription plan please contact us at {{supportEmail}}.\n            </p>\n          </div>\n          <!-- Terminated-->\n          <div class=\"text-center\" *ngIf=\"subscription.isEndedSubscription()\">\n            <p class=\"alert alert-warning\">Your membership subscription was terminated on {{subscription.endedAt|date:'mediumDate'}}.\n              Contact {{supportEmail}} to discuss options for renewing your membership subscription. Your account access and client data will no longer be available after\n              <b>{{subscription.currentPeriodEnd|date:'mediumDate'}}</b>.\n              For more information refer to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>\n            </p>\n            <h5><b>What was included in this plan</b></h5>\n            <ul class=\"text-left list-group mb-2\">\n              <li class=\"list-group-item\" *ngFor=\"let planItem of getPlanItems(subscription)\"><i class=\"fa fa-check text-success pr-3\"></i>{{planItem}}</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- Old customers with no subscription option-->\n    <div class=\"row pl-4 pt-4\" *ngIf=\"!Billing.hasSubscriptions()\">\n      <div class=\"col\">\n        <p>If you are interested in a monthly unlimited membership subscription plan.  Contact {{supportEmail}} to have your account migrated to a\n          subscription plan!\n        </p>\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nexport class SaveMessages {\n\tprivate _saveSuccess : boolean;\n\tprivate _saveFailed: boolean;\n\tprivate _deleteSuccess: boolean;\n\tprivate _deleteFailed: boolean;\n\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\n\tpublic reset() : void {\n\t\tthis.saveFailed = false;\n\t\tthis.saveSuccess = false;\n\t\tthis._deleteSuccess = false;\n\t\tthis._deleteFailed = false;\n\t}\n\n\tpublic get deleteSuccess() : boolean {\n\t\treturn this._deleteSuccess;\n\t}\n\n\tpublic set deleteSuccess(v : boolean) {\n\t\tthis._deleteSuccess = v;\n\t}\n\n\tpublic get deleteFailed() : boolean {\n\t\treturn this._deleteFailed;\n\t}\n\n\tpublic set deleteFailed(v : boolean) {\n\t\tthis._deleteFailed = v;\n\t}\n\n\n\tpublic get saveSuccess() : boolean {\n\t\treturn this._saveSuccess;\n\t}\n\n\tpublic set saveSuccess(v : boolean) {\n\t\tthis._saveSuccess = v;\n\t}\n\n\tpublic get saveFailed() : boolean {\n\t\treturn this._saveFailed;\n\t}\n\n\tpublic set saveFailed(v : boolean) {\n\t\tthis._saveFailed = v;\n\t}\n\n\n}\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport {Assessment} from \"../../shared/models/assessment\";\nimport {Scale} from \"../../shared/models/scale\";\nimport {AssessmentService} from \"../../shared/services/assessment.service\";\n\n@Component({\n  selector: 'app-scale-new',\n  templateUrl: './scale-new.component.html',\n  styleUrls: ['./scale-new.component.css']\n})\nexport class ScaleNewComponent implements OnInit {\n\n  private _scale:Scale;\n  private _assessment:Assessment;\n\n  constructor(private _assessmentService:AssessmentService\n    ,private alertService:AlertService\n   ,private route:ActivatedRoute\n    ,private router:Router) {\n    this._scale = new Scale();\n    this._scale.name = \"Untitled\";\n    this._scale.id = this._assessmentService.newId();\n  }\n\n  ngOnInit() {\n    this.route.params.subscribe((params) => {\n      let assessmentUid = params['uid'];\n      this._assessmentService.getAssessment(assessmentUid)\n        .then((assessment:Assessment) => {\n          this._assessment = assessment;\n        })\n        .catch((error) => {\n          console.error(error);\n        })\n    });\n  }\n\n  get scale() {\n    return this._scale;\n  }\n\n  set scale(v:Scale) {\n    this._scale = v;\n  }\n\n  save() {\n    this._assessment.addScale(this.scale);\n\n\t\tthis._assessmentService.saveAssessment(this._assessment).then(() => {\n      this.alertService.success(\"Scale Saved!\");\n      setTimeout(() => {\n        this.router.navigate([\"../\", this.scale.id, \"edit\"], {relativeTo: this.route, replaceUrl: true});\n      }, 1500);\n    }).catch((error) => {\n      this.alertService.error(\"Error occurred in saving. Please try again.\");\n      console.error(error);\n\t\t});\n\t}\n\n\tsaveAndCreateNew() {\n    this._assessment.addScale(this.scale);\n\n\t\tthis._assessmentService.saveAssessment(this._assessment).then((assessment) => {\n        this.alertService.success(\"Scale Saved!\");\n\t\t\t\tthis.scale =  new Scale();\n\t\t\t\tthis.scale.id = this._assessmentService.newId();\n    })\n    .catch((error) => {\n      console.log(error);\n      this.alertService.error(\"Error occurred in saving. Please try again.\");\n\t\t});\n\t}\n\n}\n","<div class=\"row\">\n  <div class=\"col-1\">\n    <app-back-button></app-back-button>\n  </div>\n  <div class=\"col\">\n    <h2 class=\"h2-responsive text-center\">New Scale</h2>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col\">\n    <div class=\"card card-cascade narrower\">\n        <div class=\"view gradient-card-header primary-gradient text-light\">\n            <h3 class='h3-responsive text-center'>{{scale.name}}</h3>\n        </div>\n        <div class=\"card-body\">\n        <form>\n          <div class=\"form-group\">\n            <label for=\"name\">Name:</label>\n            <input class=\"form-control\" type=\"text\" id=\"name\" name=\"name\" [(ngModel)]=\"scale.name\" />\n          </div>\n          <div class=\"form-group\">\n              <label for=\"name\">Client Description:</label>\n              <input class=\"form-control\" type=\"text\" id=\"descriptionClient\" name=\"descriptionClient\" [(ngModel)]=\"scale.descriptionClient\" />\n          </div>\n          <div class=\"form-group\">\n              <label for=\"name\">Therapist Description:</label>\n              <input class=\"form-control\" type=\"text\" id=\"descriptionTherapist\" name=\"descriptionTherapist\" [(ngModel)]=\"scale.descriptionTherapist\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"multiplier\">Multiplier:</label>\n            <input class=\"form-control\" type=\"number\" id=\"multiplier\" name=\"multiplier\" [(ngModel)]=\"scale.multiplier\" />\n          </div>\n          <div class=\"form-group\">\n            <input class=\"form-control\" type=\"checkbox\" id=\"negToPositive\" name=\"negToPositive\" [(ngModel)]=\"scale.negativeToPositiveRanges\" />\n            <label for=\"negToPositive\">Negative to Positive Ranges:</label>\n          </div>\n          <!--<div class=\"form-group\">\n            <label for=\"displayOrder\">Display Order:</label>\n            <input class=\"form-control\" type=\"number\" id=\"displayOrder\" [(ngModel)]=\"scale.display_order\" />\n          </div>-->\n        </form>\n        <input type=\"button\" (click)=\"save()\" class=\"btn btn-primary\" value=\"Save\" />\n        <input type=\"button\" (click)=\"saveAndCreateNew()\" class=\"btn btn-primary\" value=\"Save and Create New\" />\n      </div>\n    </div>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-assessment-admin',\n  templateUrl: './assessment-admin.component.html',\n  styleUrls: ['./assessment-admin.component.css']\n})\nexport class AssessmentAdminComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<router-outlet></router-outlet>","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, Input, OnChanges } from '@angular/core';\nimport { ManagedClient } from '../../shared/models/managed-client';\nimport { Assignment } from '../../shared/models/Assignment';\nimport { AssessmentGroup } from 'app/shared/models/assessment-group';\nimport { ClientService } from '../../shared/services/client.service';\nimport { Assessment } from \"../../shared/models/assessment\";\nimport { Location } from \"@angular/common\";\nimport { DacConfig } from \"../../shared/services/dac-config.service\";\nimport { AssessmentTokenService } from \"../../shared/services/assessment-token.service\";\nimport { ReportService } from \"../../reports/services/report.service\";\nimport { AlertService } from 'app/shared/services/alert.service';\nimport { ShoppingService } from 'app/shared/services/shopping.service';\nimport { AssessmentAssignerService } from '../services/assessment-assigner.service';\nimport { AssignmentService } from 'app/shared/services/assignment.service';\nimport { LibraryAsset } from 'app/library-assets/models/library-asset';\nimport { AssignmentSingle } from 'app/shared/models/AssignmentSingle';\nimport { AssignedLibraryAsset } from 'app/shared/models/AssignedLibraryAsset';\nimport { QuestionnaireService } from 'app/shared/services/questionnaire.service';\nimport { AssignedQuestionnaire } from 'app/shared/models/AssignedQuestionnaire';\n\n@Component({\n  selector: 'dac-client-manage-assignments',\n  templateUrl: './client-manage-assignments.component.html',\n  styleUrls: ['./client-manage-assignments.component.scss']\n})\nexport class ClientManageAssignmentsComponent implements OnInit, OnChanges {\n\n  @Input() client:ManagedClient;\n\n  @Input() appointment:string;\n\n  public isSaving:boolean;\n\n  private clientAssignments:Assignment[];\n\n  constructor(private _clientService: ClientService,\n    private alertService: AlertService,\n    private assessmentTokenService:AssessmentTokenService,\n    private shoppingService:ShoppingService,\n    private assessmentAssignerService:AssessmentAssignerService,\n    private assignmentService:AssignmentService\n    ) {\n      this.isSaving = false;\n    }\n\n  ngOnInit() {\n    this.updateClientAssignments();\n  }\n  ngOnChanges() {\n    this.updateClientAssignments();\n  }\n\n  private updateClientAssignments() {\n    if (this.client && this.appointment) {\n      this.clientAssignments = this.client.assignments.filter(a => a.AppointmentId == this.appointment);\n    } else if (this.client) {\n      this.clientAssignments = this.client.assignments;\n    }\n  }\n\n  public get assignments(): Assignment[] {\n    return this.clientAssignments;\n  }\n\n  public async addAssessmentsFromBattery(group:AssessmentGroup) {\n    try {\n      // should we show the name of the client in the alerts?\n      this.isSaving = true;\n      this.alertService.info(\"Adding \" + group.Name + \" to \" + this.client.getDisplayString(), 120000);\n      let assignment = await this.assessmentAssignerService.addAssessmentsFromBattery(this.client, group, this.appointment);\n      this.updateClientAssignments();\n      this.alertService.success(\"Added \" + assignment.Name + \" to \" + this.client.getDisplayString());\n    }\n    catch (error)\n    {\n      this.alertService.error(\"Failed to add assignment. Detailed error: \" + (error.message || \" no detailed error\"), 20000);\n      console.error(error);\n    }\n    finally {\n      this.isSaving = false;\n    }\n  }\n\n  public async addQuestionnaire(questionaire: any) {\n    try {\n      this.isSaving = true;\n      let assignment = new AssignmentSingle();\n      assignment.Name = questionaire.title;\n      assignment.Type = \"Questionnaire\";\n      assignment.DateAssigned = new Date();\n      assignment.AppointmentId = this.appointment;\n      let assignmentItem = new AssignedQuestionnaire();\n      assignmentItem.Name = questionaire.title;\n      assignmentItem.QuestionnaireId = questionaire.id;\n      assignment.Items.push(assignmentItem);\n\n    let alertId = this.alertService.info(\"Adding \" + assignment.Name + \" to \" +this.client.getDisplayString(), 120000);\n    this.assignmentService.saveClientAssignment(this.client, assignment)\n      .then((assignment:Assignment) => {\n        this.isSaving = false;\n        this.client.assignments.push(assignment);\n        this.updateClientAssignments();\n        this._clientService.syncLocalClient(this.client);\n        this.alertService.clearAlert(alertId);\n        this.alertService.success(\"Added \" + assignment.Name + \" to \" + this.client.getDisplayString());\n      })\n      .catch((error) => {\n        this.isSaving = false;\n        this.alertService.clearAlert(alertId);\n        this.alertService.error(\"There was an error in adding this item to the client.  Please try again or contact customer support\");\n        console.error(error);\n      });\n      this.alertService.success(\"Added \" + questionaire.title + \" to \" + this.client.getDisplayString());\n  }\n  catch (error)\n  {\n    this.alertService.error(\"Failed to add assignment. Detailed error: \" + (error.message || \" no detailed error\"), 20000);\n    console.error(error);\n  }\n  finally {\n    this.isSaving = false;\n  }\n  }\n\n  public async addAssessment(assessment: Assessment) {\n    try {\n        this.isSaving = true;\n        this.assessmentAssignerService.addAssessment(this.client, assessment, this.appointment)\n        .then(() => {\n          this.updateClientAssignments();\n        });\n    }\n    catch (error)\n    {\n      this.alertService.error(\"Failed to add assignment. Detailed error: \" + (error.message || \" no detailed error\"), 20000);\n      console.error(error);\n    }\n    finally {\n      this.isSaving = false;\n    }\n  }\n\n  public clearAssignment(assignment: Assignment) {\n    this.isSaving = true;\n    try {\n      this.alertService.info(\"Removing assignment...\");\n      this.assignmentService.removeClientAssignment(this.client, assignment).then(() => {\n        this.client.removeAssignment(assignment);\n        this._clientService.syncLocalClient(this.client);\n        this.updateClientAssignments();\n        this.alertService.success(\"Assignment removed\");\n      })\n      .catch((error) => {\n        console.error(error);\n        this.alertService.error(\"Failed to remove assignment\", 1500);\n      });\n    }\n    catch (error) {\n      console.error(error);\n          this.alertService.error(\"Failed to remove assignment\", 1500);\n    }\n    finally {\n      this.isSaving = false;\n    }\n  }\n\n  public addAssetAssignment(asset:LibraryAsset) {\n\n    if (!asset) {\n      console.error(\"asset was null.  Cannot add\");\n      return;\n    }\n    this.isSaving = true;\n\n    let assignment = new AssignmentSingle();\n    assignment.Type = \"LibraryAsset\";\n    assignment.DateAssigned = new Date();\n    assignment.AppointmentId = this.appointment;\n    let assignmentItem = new AssignedLibraryAsset();\n    assignmentItem.Name = asset.title;\n    assignmentItem.Type = \"LibraryAsset\";\n    assignmentItem.AssetId = asset.id;\n    assignment.Items.push(assignmentItem);\n\n    let alertId = this.alertService.info(\"Adding \" + assignment.Name + \" to \" +this.client.getDisplayString(), 120000);\n    this.assignmentService.saveClientAssignment(this.client, assignment)\n      .then((assignment:Assignment) => {\n        this.isSaving = false;\n        this.client.assignments.push(assignment);\n        this.updateClientAssignments();\n        this._clientService.syncLocalClient(this.client);\n        this.alertService.clearAlert(alertId);\n        this.alertService.success(\"Added \" + assignment.Name + \" to \" + this.client.getDisplayString());\n      })\n      .catch((error) => {\n        this.isSaving = false;\n        this.alertService.clearAlert(alertId);\n        this.alertService.error(\"There was an error in adding this item to the client.  Please try again or contact customer support\");\n        console.error(error);\n      });\n\n  }\n\n  handleBatteryCheckout(group:AssessmentGroup) {\n    let checkoutSubscription = null;\n    let tokenService = this.assessmentTokenService;\n\n    checkoutSubscription = this.shoppingService.getCheckoutStatus().subscribe((status) => {\n      if (checkoutSubscription && (status == \"ORDER_COMPLETE\" || status == \"ORDER_CANCELLED\")) {\n        checkoutSubscription.unsubscribe();\n      }\n\n      if (status == \"ORDER_COMPLETE\") {\n        // we will refresh this when we the user's get back to the screen, but we need to add it at the time of purchase\n        tokenService.addTokensForGroup(group, 1);\n        this.addAssessmentsFromBattery(group);\n      }\n    });\n  }\n\n  handleAssessmentCheckout(assessment:Assessment  ) {\n    let checkoutSubscription = null;\n    let assignerService = this.assessmentAssignerService;\n    let tokenService = this.assessmentTokenService;\n    let client = this.client;\n\n    checkoutSubscription = this.shoppingService.getCheckoutStatus().subscribe((status) => {\n      if (checkoutSubscription && (status == \"ORDER_COMPLETE\" || status == \"ORDER_CANCELLED\")) {\n        checkoutSubscription.unsubscribe();\n      }\n\n      if (status == \"ORDER_COMPLETE\") {\n        // we will refresh this when we the user's get back to the screen, but we need to add it at the time of purchase\n        tokenService.addTokens(assessment, 1);\n        this.addAssessment(assessment);\n      }\n    });\n  }\n\n}\n","<div class=\"row\">\n  <div class=\"col\">\n    <h2 class=\"h2-responsive\">Assignments</h2>\n    <hr class=\"mb-3\" />\n    <div *ngIf=\"assignments.length == 0\">\n      <div class=\"alert alert-warning\">No assignments have been made.</div>\n      <div class=\"alert alert-info\">\n        <p>Assign an assessment, battery of assessments, or a homework assignment by clicking on the item under one of the menu options of Available Batteries, Available Assessments, or Homework. </p>\n      </div>\n    </div>\n    <ul class=\"list-group\">\n      <li class=\"list-group-item flex-column align-items-start\" *ngFor=\"let assignment of assignments\">\n        <div class=\"d-flex w-100 justify-content-between\">\n          <div class=\"col-12 ml-2\">\n            <button class=\"btn btn-primary btn-sm float-right\" *ngIf=\"!assignment.hasStarted\"\n              (click)=\"clearAssignment(assignment)\">\n              <i class='fa fa-trash'></i>\n            </button>\n            <h5 class=\"mb-3 d-inline\">\n              <i class=\"fa fa-file-text\" *ngIf=\"assignment.type == 'LibraryAsset'\"></i>\n              <i class=\"fa fa-clipboard\" *ngIf=\"assignment.type == 'Assessment'\"></i>\n              <i class=\"fa fa-clipboard\" *ngIf=\"assignment.type == 'Questionnaire'\"></i>\n              <i class=\"fa fa-clipboard\" *ngIf=\"assignment.type == 'ExternalQuestionnaire'\"></i>\n              <i class=\"fa fa-folder\" *ngIf=\"assignment.isGroup\"></i>\n          </h5>\n      {{assignment.Name}}\n      <div *ngIf=\"assignment.isGroup\" class=\"mt-2\">\n              <ul class=\"list-unstyled ml-4\">\n                  <li *ngFor=\"let item of assignment.items\">\n                      <h5 class=\"mb-3 d-inline\"><i class=\"fa fa-clipboard\"></i></h5>\n                          {{item.Name}}\n                  </li>\n                  <li><hr /></li>\n              </ul>\n      </div>\n      <ul class=\"list-unstyled ml-4\">\n          <li><b>Assigned:</b> {{assignment.DateAssigned|date: 'medium'}}</li>\n          <li *ngIf=\"assignment.IsComplete\"><b>Completed:</b> {{assignment.DateCompleted|date: 'medium'}}</li>\n      </ul>\n          </div>\n        </div>\n\n      </li>\n    </ul>\n  </div>\n  <div class=\"col\">\n    <dac-tabs headerColor=\"secondary\" class=\"col-12\">\n      <dac-tab heading=\"Available Groups\">\n        <dac-assessment-group-list (buy)=\"handleBatteryCheckout($event)\" (selected)=\"addAssessmentsFromBattery($event)\">\n        </dac-assessment-group-list>\n      </dac-tab>\n      <dac-tab heading=\"Available Assessments\">\n        <dac-assessment-picker (buy)=\"handleAssessmentCheckout($event)\" (selected)=\"addAssessment($event)\"\n        (questionnaireSelected)=\"addQuestionnaire($event)\"\n        >\n        </dac-assessment-picker>\n      </dac-tab>\n      <dac-tab heading=\"Homework\">\n        <dac-asset-picker (selected)=\"addAssetAssignment($event)\"></dac-asset-picker>\n    </dac-tab>\n    </dac-tabs>\n  </div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport { SubscriptionService } from '../services/subscription.service';\nimport { SubscriptionStatus } from '../../shared/models/subscription-status';\n\n@Component({\n  selector: 'dac-user-upgrade-subscription-notice',\n  templateUrl: './user-upgrade-subscription-notice.component.html',\n  styleUrls: ['./user-upgrade-subscription-notice.component.scss']\n})\nexport class UserUpgradeSubscriptionNoticeComponent implements OnInit {\n\n  public subscriptionSignupRoute:string[];\n  public hasActiveSubscription:boolean;\n  public terminationDate:Date;\n  public trialPeriodEnded:boolean;\n\n  constructor(private subscriptionService:SubscriptionService) { }\n\n  ngOnInit() {\n    this.subscriptionSignupRoute = this.subscriptionService.getSubscriptionPageRoute();\n    // TODO: stephen need to get the subscription plan amount, and the termination date\n    // account balance,\n    this.subscriptionService.getCurrentUserSubscription().then(subscription => {\n      this.hasActiveSubscription = subscription.isActiveSubscription();\n      this.terminationDate = subscription.endedAt;\n      this.trialPeriodEnded = subscription.status == SubscriptionStatus.TRIAL_PERIOD_ENDED;\n    });\n  }\n}\n","<div class=\"row\">\n  <div class=\"col text-center\">\n    <div class=\"card\" *ngIf=\"trialPeriodEnded\">\n      <div class=\"view gradient-card-header success-gradient text-light\">\n        <h3 class='h3-responsive text-center text-truncate'>Account Limited - Active Your Subscription Today!</h3>\n      </div>\n      <div class=\"card-body\">\n        <p>Your free subscription trial has now ended and some site functionality has been restricted on your account.\n          Add your credit card and upgrade your account to continue services.</p>\n        <a [routerLink]=\"subscriptionSignupRoute\" class=\"btn btn-link btn-primary\">Signup for a Subscription Today!</a>\n\n        <p>The billing card on file for your company is no longer valid and we've been unable to collect payment for your subscription.</p>\n        <p>Update your billing card and re-activate your account today!</p>\n        <div class=\"alert alert-info\">\n          <h6>Notice</h6>\n          <hr />\n          If you do not activate your account by {{terminationDate| date : 'longDate'}} your account\n          and patient information will be removed from our system according to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>.\n        </div>\n      </div>\n    </div>\n\n    <div class=\"card\" *ngIf=\"!trialPeriodEnded\">\n      <div class=\"view gradient-card-header success-gradient text-light\">\n        <h3 class='h3-responsive text-center text-truncate'>Account Limited - Active Your Subscription Today!</h3>\n      </div>\n      <div class=\"card-body\">\n        <p>This functionality is disabled due to restrictions placed upon your account.  To remove these restrictions you must\n          update your billing information with a valid billing\n          card or reactivate your monthly subscription.</p>\n        <a [routerLink]=\"['/admin/my-account/billing']\" class=\"btn btn-link btn-primary\">Manage Billing Information</a>\n        <div class=\"alert alert-info\">\n          <h6>Notice</h6>\n          <hr />\n          If you do not activate your account by {{terminationDate| date : 'longDate'}} your account\n          and patient information will be removed from our system according to our <a [routerLink]=\"['/terms-and-conditions']\">Terms and Conditions</a>.\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit, EventEmitter, Output } from '@angular/core';\nimport { AssessmentGroup } from '../../shared/models/assessment-group';\nimport { Assessment } from '../../shared/models/assessment';\nimport { AssessmentGroupService } from '../../shared/services/assessment-group.service';\nimport { AssessmentTokenService } from '../../shared/services/assessment-token.service';\nimport { AlertService } from '../../shared/services/alert.service';\n\nclass AssessmentGroupDisplay extends AssessmentGroup {\n  Show:boolean;\n  ShowAdd:boolean;\n  constructor() {\n    super();\n    this.ShowAdd = false;\n    this.Show = false;\n  }\n}\n@Component({\n  selector: 'app-assessment-group-edit',\n  templateUrl: './assessment-group-edit.component.html',\n  styleUrls: ['./assessment-group-edit.component.css']\n})\nexport class AssessmentGroupEditComponent implements OnInit {\n\n  public NewGroupName:string;\n  public showGroups:boolean;\n\n  private groups:AssessmentGroupDisplay[];\n\n  private assessments:Assessment[];\n  private showAdd:boolean = false;\n  public hasLoaded:boolean;\n\n  constructor(\n    private assessmentGroupService:AssessmentGroupService\n    ,private assessmentTokenService:AssessmentTokenService\n    ,private alertService:AlertService\n  ) {\n    this.groups = [];\n    this.showGroups = false;\n  }\n\n  ngOnInit() {\n    this.loadGroups();\n  }\n\n  loadGroups() {\n    this.hasLoaded = false;\n    let showAllGroups = this.showGroups;\n    Promise.all([this.assessmentTokenService.loadAssessmentTokens(), this.assessmentGroupService.getAssessmentGroups(showAllGroups)])\n    .then((results) => {\n      this.hasLoaded = true;\n      let groups:AssessmentGroup[] = results[1];\n      // add a display property so we can expand/contract it.\n      this.groups = groups.map((g) => {\n        let displayGroup = new AssessmentGroupDisplay();\n        Object.assign(displayGroup, g);\n        displayGroup.Show = false;\n        return displayGroup;\n      })\n    })\n    .catch((error) => {\n      console.error(error);\n      this.alertService.error(\"Check your internet connection.  Failed to load data\");\n    });\n  }\n\n  reloadGroups(event:Event) {\n    this.showGroups = !this.showGroups;\n    event.preventDefault();\n    event.stopImmediatePropagation();\n    this.loadGroups();\n  }\n\n  getTokensRemaining(group:AssessmentGroupDisplay) {\n    if (!group) {\n      return 0;\n    }\n\n    return this.assessmentTokenService.getGroupRemainingTokens(group);\n  }\n\n  toggleGroup(group:AssessmentGroupDisplay) {\n    group.Show = !group.Show;\n    console.log(group, group.Show);\n  }\n\n  updateAssessmentVersions(group:AssessmentGroupDisplay , event:Event) {\n    event.stopImmediatePropagation();\n    let info = this.alertService.info(\"Updating assessment versions\", 30000);\n    this.assessmentGroupService.updateAssessmentsForGroup(group)\n    .then(updatedGroup => {\n      this.alertService.clearAlert(info);\n      let index = this.groups.findIndex(g => g == group);\n      let displayGroup = new AssessmentGroupDisplay();\n      Object.assign(displayGroup, updatedGroup);\n      displayGroup.Show = group.Show;\n      this.groups[index] = displayGroup;\n      this.alertService.success(\"Assessment versions updated\");\n    })\n    .catch((error) => {\n      console.error(error);\n      this.alertService.clearAlert(info);\n      this.alertService.error(\"There was an error in updating the assessments for this group.  Check the server logs\");\n    });\n  }\n\n  addAssessmentToGroup(group:AssessmentGroup, assessment:Assessment) {\n    let dup = group.Assessments.find((a) => {return a.uid == assessment.uid });\n    if (dup) {\n      alert(\"This assessment already has been added.\");\n      return;\n    }\n\n    group.Assessments.push(assessment);\n    this.assessmentGroupService.addAssessmentToGroup(group, assessment).then((assessment:Assessment) => {\n      assessment.version = assessment.version;\n      assessment.id = assessment.id;\n    })\n    .catch((error) => {\n      console.error(error);\n      // TODO: stephen need to display an error here...\n      // remove it\n      let index = group.Assessments.indexOf(assessment);\n      if (index >= 0) {\n        group.Assessments.splice(index, 1);\n      }\n    });\n  }\n\n  addGroupFromKeypress(event) {\n    // enter key is 13\n    if (!event || event.charCode !== 13) {\n      return;\n    }\n    this.addGroup();\n  }\n\n  addGroup() {\n    this.assessmentGroupService.createNewGroup(this.NewGroupName).then((group:AssessmentGroup) => {\n      let display = new AssessmentGroupDisplay();\n      Object.assign(display, group);\n\n      // hide all the others, and show the one we just added.\n      this.groups.forEach((g) => g.Show = false);\n      display.Show = true;\n      display.ShowAdd = true;\n      this.NewGroupName = \"\";\n\n      this.groups.push(display);\n    });\n  }\n\n  public get Groups() {\n    return this.groups;\n  }\n\n  public toggleShowAdd(group:AssessmentGroupDisplay, event:Event) {\n    event.stopImmediatePropagation();\n    group.ShowAdd = !group.ShowAdd;\n  }\n}\n","<div class=\"col-12 group-edit\" *ngIf=\"!hasLoaded\">\n  <h1 class=\"h1-responsive\">Assessment Batteries</h1>\n</div>\n<div class=\"col-12 group-edit\" *ngIf=\"hasLoaded\">\n    <h1 class=\"h1-responsive\">Assessment Batteries</h1>\n    <div class=\"row\" *hasPermission=\"'SuperUser'\">\n      <div class=\"col\">\n        <input class=\"form-control\" id=\"showGroups\" type=\"checkbox\"\n        (click)=\"reloadGroups($event)\" [checked]=\"showGroups\" name=\"showGroups\" />\n        <label for=\"showGroups\"  (click)=\"reloadGroups($event)\">\n          Show all Batteries</label>\n      </div>\n    </div>\n    <div>\n        <div class=\"input-group\">\n            <input type=\"text\" class=\"form-control\" [(ngModel)]=\"NewGroupName\" *hasPermission=\"'SuperUser'\"\n                (keypress)=\"addGroupFromKeypress($event)\"\n                placeholder=\"Enter a name for the battery...\">\n            <span class=\"input-group-btn\">\n                <button class=\"btn btn-default btn-primary\" type=\"button\" (click)=\"addGroup()\" *hasPermission=\"'SuperUser'\">Add</button>\n            </span>\n        </div><!-- /input-group -->\n    </div>\n<p *ngIf=\"Groups.length < 1\">There are no batteries created.  Add a assessment battery here...</p>\n<ul class=\"list-group\">\n  <li class=\"list-group-item d-flex justify-content-between align-items-center list-group-item-action\" *ngFor=\"let group of Groups\"\n  (click)=\"toggleGroup(group)\"\n  >\n    <div>\n      {{group.name}}\n      <span *ngIf=\"!group.Show\" class=\"fa fa-chevron-down\"\n        aria-hidden=\"true\"></span>\n      <span *ngIf=\"group.Show\" class=\"fa fa-chevron-up\"\n        aria-hidden=\"true\"></span>\n      <div *ngIf=\"group.Show\">\n        <ul>\n          <li *ngFor=\"let assessment of group.Assessments\">{{assessment.name}}</li>\n        </ul>\n        <div *hasPermission=\"'SuperUser'\">\n          <input *ngIf=\"!group.ShowAdd\" class=\"btn btn-primary\" type=\"button\" type=\"button\" (click)=\"toggleShowAdd(group, $event)\" value=\"Add Assessment\">\n              <input *ngIf=\"group.ShowAdd\" class=\"btn btn-primary\" type=\"button\" type=\"button\" (click)=\"toggleShowAdd(group, $event)\" value=\"Close Add Screen\">\n          <dac-assessment-picker *ngIf=\"group.ShowAdd\" (selected)=\"addAssessmentToGroup(group, $event)\"></dac-assessment-picker>\n        </div>\n        <div *hasPermission=\"'SuperUser'\">\n          <input class=\"btn btn-primary\" type=\"button\" (click)=\"updateAssessmentVersions(group, $event)\" value=\"Update Assessment Versions\" />\n        </div>\n      </div>\n    </div>\n    <span class=\"badge badge-primary badge-pill\">{{getTokensRemaining(group)}}</span>\n  </li>\n</ul>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport {AssessmentTokenService} from '../../shared/services/assessment-token.service';\nimport {Role} from '../../shared/models/role';\nimport {AlertService} from '../../shared/services/alert.service';\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Assessment } from '../../shared/models/assessment';\nimport { AssessmentService } from '../../shared/services/assessment.service';\nimport {DacConfig} from \"../../shared/services/dac-config.service\";\nimport { AuthService } from 'app/login/services/auth.service';\nimport { SubscriptionLike as ISubscription } from 'rxjs';\n\n@Component({\n  selector: 'app-assessment-list',\n  templateUrl: './assessment-list.component.html',\n  styleUrls: ['./assessment-list.component.css']\n})\nexport class AssessmentListComponent implements OnInit,OnDestroy {\n\n  private _assessments:Assessment[]\n  private _userRole:Role;\n  private _userSubscription:ISubscription;\n  public hasLoadedAssessments:boolean;\n\n  constructor(\n    private _assessmentService:AssessmentService\n    ,private alertService:AlertService\n    ,private dacConfig:DacConfig\n    ,private authService:AuthService\n    ,private assessmentTokenService:AssessmentTokenService\n  ) {\n    this._assessments = [];\n    this.hasLoadedAssessments = false;\n    this._userRole = Role.UnAuthenticated;\n    this._userSubscription = this.authService.getLoginState().subscribe(loginState => {\n      if (loginState.user) {\n        this._userRole = loginState.user.role;\n      }\n      else {\n        this._userRole = Role.UnAuthenticated;\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this._userSubscription.unsubscribe();\n  }\n\n  get Assessments() {\n    return this._assessments;\n  }\n\n  get canManageAssessments() {\n    return this.dacConfig.isFeatureEnabled(\"assessments.manage\");\n  }\n\n  public canEdit(assessment:Assessment) {\n\n    if (this._userRole == Role.SuperUser) {\n      return true;\n    }\n    else if (this._userRole == Role.Admin) {\n      return !assessment.isPublic;\n    }\n\n    return false;\n  }\n\n  public getTokens(assessment:Assessment) {\n    return this.assessmentTokenService.getRemainingTokens(assessment);\n  }\n\n  public get tokensEnabled() {\n    return this.assessmentTokenService.isTokensEnabled();\n  }\n\n  ngOnInit() {\n\n    Promise.all(\n      [\n        this._assessmentService.getAssessmentList()\n        ,this.assessmentTokenService.loadAssessmentTokens()\n      ]\n    )\n    .then((results) => {\n      let [assessmentList,] = results;\n      this._assessments = assessmentList;\n      this.hasLoadedAssessments = true;\n    })\n    .catch((error) => {\n      this.alertService.error(\"Failed to load assessments from server\");\n      console.error(error);\n      this.hasLoadedAssessments = true;\n    });\n  }\n\n}\n","<div class=\"row\" *ngIf=\"!hasLoadedAssessments\">\n  <div class=\"col-12\">\n    <p class=\"alert alert-warning\"><app-spin-icon></app-spin-icon> Loading Assessments...</p>\n  </div>\n</div>\n<div class=\"row\" *ngIf=\"hasLoadedAssessments\">\n\t<div *ngIf=\"canManageAssessments\" class=\"col\">\n\t<h1 class=\"h1-responsive\">\n\t\tAssessments <a class=\"btn btn-primary\" *hasPermission=\"'SuperUser'\" [routerLink]=\"['new']\">Add New Assessment</a>\n\t</h1>\n\t<p *ngIf=\"Assessments.length == 0\">Assessment list is empty</p>\n\t<table class='table table-striped'>\n\t\t<thead class=\"primary-color text-white\">\n\t\t\t<tr>\n\t\t\t\t<th>Assessment</th>\n\t\t\t\t<th>Description</th>\n\t\t\t\t<th *ngIf=\"tokensEnabled\">Tokens</th>\n\t\t\t\t<th>Actions</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr *ngFor=\"let assessment of Assessments\">\n\t\t\t\t<td class=''>{{assessment.name}}</td>\n\t\t\t\t<td class='w-50' [innerHTML]='assessment.description'></td>\n\t\t\t\t<td class='' *ngIf=\"tokensEnabled\">{{getTokens(assessment)}}</td>\n\t\t\t\t<td class='w-25'>\n\t\t\t\t\t<button *ngIf=\"canEdit(assessment)\" aria-label=\"Edit\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" [routerLink]=\"[assessment.uid,'edit']\">\n\t\t\t\t\t\t<span aria-hidden=\"true\" class=\"fa fa-edit\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button aria-label=\"View\" class=\"btn btn-primary btn-sm\" type=\"button\" tabindex=\"0\" [routerLink]=\"[assessment.uid,'view']\">\n\t\t\t\t\t\t<span aria-hidden=\"true\" class=\"fa fa-eye\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<!-- We can add this back in when we want to have one item purchasing setup here.\n\t\t\t\t\t\t<button aria-label=\"Shop\" class=\"btn btn-default\" type=\"button\" tabindex=\"0\" [routerLink]=\"['/admin/shop/checkout']\" [queryParams]=\"{uid: assessment.uid}\">\n\t\t\t\t\t\t\t<span aria-hidden=\"true\" class=\"glyphicon glyphicon-shopping-cart\"></span>\n\t\t\t\t\t</button> -->\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n\t</div>\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { Component, OnInit } from '@angular/core';\nimport {ShoppingService} from \"../../shared/services/shopping.service\";\n\n@Component({\n  selector: 'cart-widget',\n  templateUrl: './cart-widget.component.html',\n  styleUrls: ['./cart-widget.component.css']\n})\nexport class CartWidgetComponent implements OnInit {\n\n  constructor(\n    private shopping:ShoppingService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  get total() {\n    if (this.shopping.hasItems) {\n      return this.shopping.cartTotal;\n    }\n    return 0;\n  }\n}\n","<div class='cart-widget'>\n  <span class=\"fa fa-shopping-cart\" aria-hidden=\"true\"></span> ${{total|number:'1.2-2'}}\n  <input type=\"button\" class=\"btn btn-primary\" value=\"View Cart\" [routerLink]=\"['/admin', 'shop', 'checkout']\" />\n</div>\n","/*\n *   Copyright (c) 2022 Discover and Change @author Stephen Nielson <snielson@discoverandchange.com>\n *   All rights reserved.\n *   For License information see LICENSE.md in the root folder of this project.\n */\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { UserListComponent } from './user-list/user-list.component';\nimport { UserEditComponent } from './user-edit/user-edit.component';\nimport { UsersRoutingModule} from \"./users-routing.module\";\n\nimport { SharedModule } from \"../shared/shared.module\";\nimport { UserDeleteComponent } from './user-delete/user-delete.component';\nimport { UserNewComponent } from './user-new/user-new.component';\n\n@NgModule({\n  imports: [\n    FormsModule\n    ,SharedModule\n    ,UsersRoutingModule\n  ],\n  declarations: [UserListComponent, UserEditComponent, UserDeleteComponent\n    ,UserNewComponent]\n  ,providers: []\n  ,exports: []\n})\nexport class UsersModule { }\n"]}